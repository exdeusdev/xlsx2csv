var xlsx2csv=(()=>{var cr=Object.create;var Qt=Object.defineProperty;var fr=Object.getOwnPropertyDescriptor;var dr=Object.getOwnPropertyNames;var pr=Object.getPrototypeOf,mr=Object.prototype.hasOwnProperty;var Vt=(e=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(e,{get:(i,s)=>(typeof require!="undefined"?require:i)[s]}):e)(function(e){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')});var Pt=(e,i)=>()=>(i||e((i={exports:{}}).exports,i),i.exports),_r=(e,i)=>{for(var s in i)Qt(e,s,{get:i[s],enumerable:!0})},Se=(e,i,s,r)=>{if(i&&typeof i=="object"||typeof i=="function")for(let h of dr(i))!mr.call(e,h)&&h!==s&&Qt(e,h,{get:()=>i[h],enumerable:!(r=fr(i,h))||r.enumerable});return e};var se=(e,i,s)=>(s=e!=null?cr(pr(e)):{},Se(i||!e||!e.__esModule?Qt(s,"default",{value:e,enumerable:!0}):s,e)),gr=e=>Se(Qt({},"__esModule",{value:!0}),e);var Te=Pt((De,ae)=>{(function(e){typeof De=="object"&&typeof ae<"u"?ae.exports=e():typeof define=="function"&&define.amd?define([],e):(typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this).JSZip=e()})(function(){return function e(i,s,r){function h(x,D){if(!s[x]){if(!i[x]){var C=typeof Vt=="function"&&Vt;if(!D&&C)return C(x,!0);if(o)return o(x,!0);var E=new Error("Cannot find module '"+x+"'");throw E.code="MODULE_NOT_FOUND",E}var u=s[x]={exports:{}};i[x][0].call(u.exports,function(_){var l=i[x][1][_];return h(l||_)},u,u.exports,e,i,s,r)}return s[x].exports}for(var o=typeof Vt=="function"&&Vt,f=0;f<r.length;f++)h(r[f]);return h}({1:[function(e,i,s){"use strict";var r=e("./utils"),h=e("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";s.encode=function(f){for(var x,D,C,E,u,_,l,m=[],c=0,g=f.length,b=g,T=r.getTypeOf(f)!=="string";c<f.length;)b=g-c,C=T?(x=f[c++],D=c<g?f[c++]:0,c<g?f[c++]:0):(x=f.charCodeAt(c++),D=c<g?f.charCodeAt(c++):0,c<g?f.charCodeAt(c++):0),E=x>>2,u=(3&x)<<4|D>>4,_=1<b?(15&D)<<2|C>>6:64,l=2<b?63&C:64,m.push(o.charAt(E)+o.charAt(u)+o.charAt(_)+o.charAt(l));return m.join("")},s.decode=function(f){var x,D,C,E,u,_,l=0,m=0,c="data:";if(f.substr(0,c.length)===c)throw new Error("Invalid base64 input, it looks like a data url.");var g,b=3*(f=f.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;if(f.charAt(f.length-1)===o.charAt(64)&&b--,f.charAt(f.length-2)===o.charAt(64)&&b--,b%1!=0)throw new Error("Invalid base64 input, bad content length.");for(g=h.uint8array?new Uint8Array(0|b):new Array(0|b);l<f.length;)x=o.indexOf(f.charAt(l++))<<2|(E=o.indexOf(f.charAt(l++)))>>4,D=(15&E)<<4|(u=o.indexOf(f.charAt(l++)))>>2,C=(3&u)<<6|(_=o.indexOf(f.charAt(l++))),g[m++]=x,u!==64&&(g[m++]=D),_!==64&&(g[m++]=C);return g}},{"./support":30,"./utils":32}],2:[function(e,i,s){"use strict";var r=e("./external"),h=e("./stream/DataWorker"),o=e("./stream/Crc32Probe"),f=e("./stream/DataLengthProbe");function x(D,C,E,u,_){this.compressedSize=D,this.uncompressedSize=C,this.crc32=E,this.compression=u,this.compressedContent=_}x.prototype={getContentWorker:function(){var D=new h(r.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new f("data_length")),C=this;return D.on("end",function(){if(this.streamInfo.data_length!==C.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),D},getCompressedWorker:function(){return new h(r.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},x.createWorkerFrom=function(D,C,E){return D.pipe(new o).pipe(new f("uncompressedSize")).pipe(C.compressWorker(E)).pipe(new f("compressedSize")).withStreamInfo("compression",C)},i.exports=x},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,i,s){"use strict";var r=e("./stream/GenericWorker");s.STORE={magic:"\0\0",compressWorker:function(h){return new r("STORE compression")},uncompressWorker:function(){return new r("STORE decompression")}},s.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,i,s){"use strict";var r=e("./utils"),h=function(){for(var o,f=[],x=0;x<256;x++){o=x;for(var D=0;D<8;D++)o=1&o?3988292384^o>>>1:o>>>1;f[x]=o}return f}();i.exports=function(o,f){return o!==void 0&&o.length?r.getTypeOf(o)!=="string"?function(x,D,C,E){var u=h,_=E+C;x^=-1;for(var l=E;l<_;l++)x=x>>>8^u[255&(x^D[l])];return-1^x}(0|f,o,o.length,0):function(x,D,C,E){var u=h,_=E+C;x^=-1;for(var l=E;l<_;l++)x=x>>>8^u[255&(x^D.charCodeAt(l))];return-1^x}(0|f,o,o.length,0):0}},{"./utils":32}],5:[function(e,i,s){"use strict";s.base64=!1,s.binary=!1,s.dir=!1,s.createFolders=!0,s.date=null,s.compression=null,s.compressionOptions=null,s.comment=null,s.unixPermissions=null,s.dosPermissions=null},{}],6:[function(e,i,s){"use strict";var r=null;r=typeof Promise<"u"?Promise:e("lie"),i.exports={Promise:r}},{lie:37}],7:[function(e,i,s){"use strict";var r=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",h=e("pako"),o=e("./utils"),f=e("./stream/GenericWorker"),x=r?"uint8array":"array";function D(C,E){f.call(this,"FlateWorker/"+C),this._pako=null,this._pakoAction=C,this._pakoOptions=E,this.meta={}}s.magic="\b\0",o.inherits(D,f),D.prototype.processChunk=function(C){this.meta=C.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(x,C.data),!1)},D.prototype.flush=function(){f.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},D.prototype.cleanUp=function(){f.prototype.cleanUp.call(this),this._pako=null},D.prototype._createPako=function(){this._pako=new h[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var C=this;this._pako.onData=function(E){C.push({data:E,meta:C.meta})}},s.compressWorker=function(C){return new D("Deflate",C)},s.uncompressWorker=function(){return new D("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,i,s){"use strict";function r(u,_){var l,m="";for(l=0;l<_;l++)m+=String.fromCharCode(255&u),u>>>=8;return m}function h(u,_,l,m,c,g){var b,T,R=u.file,U=u.compression,L=g!==x.utf8encode,Z=o.transformTo("string",g(R.name)),P=o.transformTo("string",x.utf8encode(R.name)),V=R.comment,nt=o.transformTo("string",g(V)),w=o.transformTo("string",x.utf8encode(V)),$=P.length!==R.name.length,n=w.length!==V.length,H="",ht="",X="",lt=R.dir,Y=R.date,ut={crc32:0,compressedSize:0,uncompressedSize:0};_&&!l||(ut.crc32=u.crc32,ut.compressedSize=u.compressedSize,ut.uncompressedSize=u.uncompressedSize);var B=0;_&&(B|=8),L||!$&&!n||(B|=2048);var z=0,ot=0;lt&&(z|=16),c==="UNIX"?(ot=798,z|=function(J,wt){var kt=J;return J||(kt=wt?16893:33204),(65535&kt)<<16}(R.unixPermissions,lt)):(ot=20,z|=function(J){return 63&(J||0)}(R.dosPermissions)),b=Y.getUTCHours(),b<<=6,b|=Y.getUTCMinutes(),b<<=5,b|=Y.getUTCSeconds()/2,T=Y.getUTCFullYear()-1980,T<<=4,T|=Y.getUTCMonth()+1,T<<=5,T|=Y.getUTCDate(),$&&(ht=r(1,1)+r(D(Z),4)+P,H+="up"+r(ht.length,2)+ht),n&&(X=r(1,1)+r(D(nt),4)+w,H+="uc"+r(X.length,2)+X);var it="";return it+=`
\0`,it+=r(B,2),it+=U.magic,it+=r(b,2),it+=r(T,2),it+=r(ut.crc32,4),it+=r(ut.compressedSize,4),it+=r(ut.uncompressedSize,4),it+=r(Z.length,2),it+=r(H.length,2),{fileRecord:C.LOCAL_FILE_HEADER+it+Z+H,dirRecord:C.CENTRAL_FILE_HEADER+r(ot,2)+it+r(nt.length,2)+"\0\0\0\0"+r(z,4)+r(m,4)+Z+H+nt}}var o=e("../utils"),f=e("../stream/GenericWorker"),x=e("../utf8"),D=e("../crc32"),C=e("../signature");function E(u,_,l,m){f.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=_,this.zipPlatform=l,this.encodeFileName=m,this.streamFiles=u,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(E,f),E.prototype.push=function(u){var _=u.meta.percent||0,l=this.entriesCount,m=this._sources.length;this.accumulate?this.contentBuffer.push(u):(this.bytesWritten+=u.data.length,f.prototype.push.call(this,{data:u.data,meta:{currentFile:this.currentFile,percent:l?(_+100*(l-m-1))/l:100}}))},E.prototype.openedSource=function(u){this.currentSourceOffset=this.bytesWritten,this.currentFile=u.file.name;var _=this.streamFiles&&!u.file.dir;if(_){var l=h(u,_,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:l.fileRecord,meta:{percent:0}})}else this.accumulate=!0},E.prototype.closedSource=function(u){this.accumulate=!1;var _=this.streamFiles&&!u.file.dir,l=h(u,_,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(l.dirRecord),_)this.push({data:function(m){return C.DATA_DESCRIPTOR+r(m.crc32,4)+r(m.compressedSize,4)+r(m.uncompressedSize,4)}(u),meta:{percent:100}});else for(this.push({data:l.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},E.prototype.flush=function(){for(var u=this.bytesWritten,_=0;_<this.dirRecords.length;_++)this.push({data:this.dirRecords[_],meta:{percent:100}});var l=this.bytesWritten-u,m=function(c,g,b,T,R){var U=o.transformTo("string",R(T));return C.CENTRAL_DIRECTORY_END+"\0\0\0\0"+r(c,2)+r(c,2)+r(g,4)+r(b,4)+r(U.length,2)+U}(this.dirRecords.length,l,u,this.zipComment,this.encodeFileName);this.push({data:m,meta:{percent:100}})},E.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},E.prototype.registerPrevious=function(u){this._sources.push(u);var _=this;return u.on("data",function(l){_.processChunk(l)}),u.on("end",function(){_.closedSource(_.previous.streamInfo),_._sources.length?_.prepareNextSource():_.end()}),u.on("error",function(l){_.error(l)}),this},E.prototype.resume=function(){return!!f.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},E.prototype.error=function(u){var _=this._sources;if(!f.prototype.error.call(this,u))return!1;for(var l=0;l<_.length;l++)try{_[l].error(u)}catch{}return!0},E.prototype.lock=function(){f.prototype.lock.call(this);for(var u=this._sources,_=0;_<u.length;_++)u[_].lock()},i.exports=E},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,i,s){"use strict";var r=e("../compressions"),h=e("./ZipFileWorker");s.generateWorker=function(o,f,x){var D=new h(f.streamFiles,x,f.platform,f.encodeFileName),C=0;try{o.forEach(function(E,u){C++;var _=function(g,b){var T=g||b,R=r[T];if(!R)throw new Error(T+" is not a valid compression method !");return R}(u.options.compression,f.compression),l=u.options.compressionOptions||f.compressionOptions||{},m=u.dir,c=u.date;u._compressWorker(_,l).withStreamInfo("file",{name:E,dir:m,date:c,comment:u.comment||"",unixPermissions:u.unixPermissions,dosPermissions:u.dosPermissions}).pipe(D)}),D.entriesCount=C}catch(E){D.error(E)}return D}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,i,s){"use strict";function r(){if(!(this instanceof r))return new r;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var h=new r;for(var o in this)typeof this[o]!="function"&&(h[o]=this[o]);return h}}(r.prototype=e("./object")).loadAsync=e("./load"),r.support=e("./support"),r.defaults=e("./defaults"),r.version="3.10.0",r.loadAsync=function(h,o){return new r().loadAsync(h,o)},r.external=e("./external"),i.exports=r},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,i,s){"use strict";var r=e("./utils"),h=e("./external"),o=e("./utf8"),f=e("./zipEntries"),x=e("./stream/Crc32Probe"),D=e("./nodejsUtils");function C(E){return new h.Promise(function(u,_){var l=E.decompressed.getContentWorker().pipe(new x);l.on("error",function(m){_(m)}).on("end",function(){l.streamInfo.crc32!==E.decompressed.crc32?_(new Error("Corrupted zip : CRC32 mismatch")):u()}).resume()})}i.exports=function(E,u){var _=this;return u=r.extend(u||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),D.isNode&&D.isStream(E)?h.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):r.prepareContent("the loaded zip file",E,!0,u.optimizedBinaryString,u.base64).then(function(l){var m=new f(u);return m.load(l),m}).then(function(l){var m=[h.Promise.resolve(l)],c=l.files;if(u.checkCRC32)for(var g=0;g<c.length;g++)m.push(C(c[g]));return h.Promise.all(m)}).then(function(l){for(var m=l.shift(),c=m.files,g=0;g<c.length;g++){var b=c[g],T=b.fileNameStr,R=r.resolve(b.fileNameStr);_.file(R,b.decompressed,{binary:!0,optimizedBinaryString:!0,date:b.date,dir:b.dir,comment:b.fileCommentStr.length?b.fileCommentStr:null,unixPermissions:b.unixPermissions,dosPermissions:b.dosPermissions,createFolders:u.createFolders}),b.dir||(_.file(R).unsafeOriginalName=T)}return m.zipComment.length&&(_.comment=m.zipComment),_})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,i,s){"use strict";var r=e("../utils"),h=e("../stream/GenericWorker");function o(f,x){h.call(this,"Nodejs stream input adapter for "+f),this._upstreamEnded=!1,this._bindStream(x)}r.inherits(o,h),o.prototype._bindStream=function(f){var x=this;(this._stream=f).pause(),f.on("data",function(D){x.push({data:D,meta:{percent:0}})}).on("error",function(D){x.isPaused?this.generatedError=D:x.error(D)}).on("end",function(){x.isPaused?x._upstreamEnded=!0:x.end()})},o.prototype.pause=function(){return!!h.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!h.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},i.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,i,s){"use strict";var r=e("readable-stream").Readable;function h(o,f,x){r.call(this,f),this._helper=o;var D=this;o.on("data",function(C,E){D.push(C)||D._helper.pause(),x&&x(E)}).on("error",function(C){D.emit("error",C)}).on("end",function(){D.push(null)})}e("../utils").inherits(h,r),h.prototype._read=function(){this._helper.resume()},i.exports=h},{"../utils":32,"readable-stream":16}],14:[function(e,i,s){"use strict";i.exports={isNode:typeof Buffer<"u",newBufferFrom:function(r,h){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(r,h);if(typeof r=="number")throw new Error('The "data" argument must not be a number');return new Buffer(r,h)},allocBuffer:function(r){if(Buffer.alloc)return Buffer.alloc(r);var h=new Buffer(r);return h.fill(0),h},isBuffer:function(r){return Buffer.isBuffer(r)},isStream:function(r){return r&&typeof r.on=="function"&&typeof r.pause=="function"&&typeof r.resume=="function"}}},{}],15:[function(e,i,s){"use strict";function r(R,U,L){var Z,P=o.getTypeOf(U),V=o.extend(L||{},D);V.date=V.date||new Date,V.compression!==null&&(V.compression=V.compression.toUpperCase()),typeof V.unixPermissions=="string"&&(V.unixPermissions=parseInt(V.unixPermissions,8)),V.unixPermissions&&16384&V.unixPermissions&&(V.dir=!0),V.dosPermissions&&16&V.dosPermissions&&(V.dir=!0),V.dir&&(R=c(R)),V.createFolders&&(Z=m(R))&&g.call(this,Z,!0);var nt=P==="string"&&V.binary===!1&&V.base64===!1;L&&L.binary!==void 0||(V.binary=!nt),(U instanceof C&&U.uncompressedSize===0||V.dir||!U||U.length===0)&&(V.base64=!1,V.binary=!0,U="",V.compression="STORE",P="string");var w=null;w=U instanceof C||U instanceof f?U:_.isNode&&_.isStream(U)?new l(R,U):o.prepareContent(R,U,V.binary,V.optimizedBinaryString,V.base64);var $=new E(R,w,V);this.files[R]=$}var h=e("./utf8"),o=e("./utils"),f=e("./stream/GenericWorker"),x=e("./stream/StreamHelper"),D=e("./defaults"),C=e("./compressedObject"),E=e("./zipObject"),u=e("./generate"),_=e("./nodejsUtils"),l=e("./nodejs/NodejsStreamInputAdapter"),m=function(R){R.slice(-1)==="/"&&(R=R.substring(0,R.length-1));var U=R.lastIndexOf("/");return 0<U?R.substring(0,U):""},c=function(R){return R.slice(-1)!=="/"&&(R+="/"),R},g=function(R,U){return U=U!==void 0?U:D.createFolders,R=c(R),this.files[R]||r.call(this,R,null,{dir:!0,createFolders:U}),this.files[R]};function b(R){return Object.prototype.toString.call(R)==="[object RegExp]"}var T={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(R){var U,L,Z;for(U in this.files)Z=this.files[U],(L=U.slice(this.root.length,U.length))&&U.slice(0,this.root.length)===this.root&&R(L,Z)},filter:function(R){var U=[];return this.forEach(function(L,Z){R(L,Z)&&U.push(Z)}),U},file:function(R,U,L){if(arguments.length!==1)return R=this.root+R,r.call(this,R,U,L),this;if(b(R)){var Z=R;return this.filter(function(V,nt){return!nt.dir&&Z.test(V)})}var P=this.files[this.root+R];return P&&!P.dir?P:null},folder:function(R){if(!R)return this;if(b(R))return this.filter(function(P,V){return V.dir&&R.test(P)});var U=this.root+R,L=g.call(this,U),Z=this.clone();return Z.root=L.name,Z},remove:function(R){R=this.root+R;var U=this.files[R];if(U||(R.slice(-1)!=="/"&&(R+="/"),U=this.files[R]),U&&!U.dir)delete this.files[R];else for(var L=this.filter(function(P,V){return V.name.slice(0,R.length)===R}),Z=0;Z<L.length;Z++)delete this.files[L[Z].name];return this},generate:function(R){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(R){var U,L={};try{if((L=o.extend(R||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:h.utf8encode})).type=L.type.toLowerCase(),L.compression=L.compression.toUpperCase(),L.type==="binarystring"&&(L.type="string"),!L.type)throw new Error("No output type specified.");o.checkSupport(L.type),L.platform!=="darwin"&&L.platform!=="freebsd"&&L.platform!=="linux"&&L.platform!=="sunos"||(L.platform="UNIX"),L.platform==="win32"&&(L.platform="DOS");var Z=L.comment||this.comment||"";U=u.generateWorker(this,L,Z)}catch(P){(U=new f("error")).error(P)}return new x(U,L.type||"string",L.mimeType)},generateAsync:function(R,U){return this.generateInternalStream(R).accumulate(U)},generateNodeStream:function(R,U){return(R=R||{}).type||(R.type="nodebuffer"),this.generateInternalStream(R).toNodejsStream(U)}};i.exports=T},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,i,s){i.exports=e("stream")},{stream:void 0}],17:[function(e,i,s){"use strict";var r=e("./DataReader");function h(o){r.call(this,o);for(var f=0;f<this.data.length;f++)o[f]=255&o[f]}e("../utils").inherits(h,r),h.prototype.byteAt=function(o){return this.data[this.zero+o]},h.prototype.lastIndexOfSignature=function(o){for(var f=o.charCodeAt(0),x=o.charCodeAt(1),D=o.charCodeAt(2),C=o.charCodeAt(3),E=this.length-4;0<=E;--E)if(this.data[E]===f&&this.data[E+1]===x&&this.data[E+2]===D&&this.data[E+3]===C)return E-this.zero;return-1},h.prototype.readAndCheckSignature=function(o){var f=o.charCodeAt(0),x=o.charCodeAt(1),D=o.charCodeAt(2),C=o.charCodeAt(3),E=this.readData(4);return f===E[0]&&x===E[1]&&D===E[2]&&C===E[3]},h.prototype.readData=function(o){if(this.checkOffset(o),o===0)return[];var f=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,f},i.exports=h},{"../utils":32,"./DataReader":18}],18:[function(e,i,s){"use strict";var r=e("../utils");function h(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}h.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(o){},readInt:function(o){var f,x=0;for(this.checkOffset(o),f=this.index+o-1;f>=this.index;f--)x=(x<<8)+this.byteAt(f);return this.index+=o,x},readString:function(o){return r.transformTo("string",this.readData(o))},readData:function(o){},lastIndexOfSignature:function(o){},readAndCheckSignature:function(o){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC(1980+(o>>25&127),(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(31&o)<<1))}},i.exports=h},{"../utils":32}],19:[function(e,i,s){"use strict";var r=e("./Uint8ArrayReader");function h(o){r.call(this,o)}e("../utils").inherits(h,r),h.prototype.readData=function(o){this.checkOffset(o);var f=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,f},i.exports=h},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,i,s){"use strict";var r=e("./DataReader");function h(o){r.call(this,o)}e("../utils").inherits(h,r),h.prototype.byteAt=function(o){return this.data.charCodeAt(this.zero+o)},h.prototype.lastIndexOfSignature=function(o){return this.data.lastIndexOf(o)-this.zero},h.prototype.readAndCheckSignature=function(o){return o===this.readData(4)},h.prototype.readData=function(o){this.checkOffset(o);var f=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,f},i.exports=h},{"../utils":32,"./DataReader":18}],21:[function(e,i,s){"use strict";var r=e("./ArrayReader");function h(o){r.call(this,o)}e("../utils").inherits(h,r),h.prototype.readData=function(o){if(this.checkOffset(o),o===0)return new Uint8Array(0);var f=this.data.subarray(this.zero+this.index,this.zero+this.index+o);return this.index+=o,f},i.exports=h},{"../utils":32,"./ArrayReader":17}],22:[function(e,i,s){"use strict";var r=e("../utils"),h=e("../support"),o=e("./ArrayReader"),f=e("./StringReader"),x=e("./NodeBufferReader"),D=e("./Uint8ArrayReader");i.exports=function(C){var E=r.getTypeOf(C);return r.checkSupport(E),E!=="string"||h.uint8array?E==="nodebuffer"?new x(C):h.uint8array?new D(r.transformTo("uint8array",C)):new o(r.transformTo("array",C)):new f(C)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,i,s){"use strict";s.LOCAL_FILE_HEADER="PK",s.CENTRAL_FILE_HEADER="PK",s.CENTRAL_DIRECTORY_END="PK",s.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",s.ZIP64_CENTRAL_DIRECTORY_END="PK",s.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,i,s){"use strict";var r=e("./GenericWorker"),h=e("../utils");function o(f){r.call(this,"ConvertWorker to "+f),this.destType=f}h.inherits(o,r),o.prototype.processChunk=function(f){this.push({data:h.transformTo(this.destType,f.data),meta:f.meta})},i.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(e,i,s){"use strict";var r=e("./GenericWorker"),h=e("../crc32");function o(){r.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(o,r),o.prototype.processChunk=function(f){this.streamInfo.crc32=h(f.data,this.streamInfo.crc32||0),this.push(f)},i.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,i,s){"use strict";var r=e("../utils"),h=e("./GenericWorker");function o(f){h.call(this,"DataLengthProbe for "+f),this.propName=f,this.withStreamInfo(f,0)}r.inherits(o,h),o.prototype.processChunk=function(f){if(f){var x=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=x+f.data.length}h.prototype.processChunk.call(this,f)},i.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(e,i,s){"use strict";var r=e("../utils"),h=e("./GenericWorker");function o(f){h.call(this,"DataWorker");var x=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,f.then(function(D){x.dataIsReady=!0,x.data=D,x.max=D&&D.length||0,x.type=r.getTypeOf(D),x.isPaused||x._tickAndRepeat()},function(D){x.error(D)})}r.inherits(o,h),o.prototype.cleanUp=function(){h.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!h.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,r.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(r.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var f=null,x=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":f=this.data.substring(this.index,x);break;case"uint8array":f=this.data.subarray(this.index,x);break;case"array":case"nodebuffer":f=this.data.slice(this.index,x)}return this.index=x,this.push({data:f,meta:{percent:this.max?this.index/this.max*100:0}})},i.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(e,i,s){"use strict";function r(h){this.name=h||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}r.prototype={push:function(h){this.emit("data",h)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(h){this.emit("error",h)}return!0},error:function(h){return!this.isFinished&&(this.isPaused?this.generatedError=h:(this.isFinished=!0,this.emit("error",h),this.previous&&this.previous.error(h),this.cleanUp()),!0)},on:function(h,o){return this._listeners[h].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(h,o){if(this._listeners[h])for(var f=0;f<this._listeners[h].length;f++)this._listeners[h][f].call(this,o)},pipe:function(h){return h.registerPrevious(this)},registerPrevious:function(h){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=h.streamInfo,this.mergeStreamInfo(),this.previous=h;var o=this;return h.on("data",function(f){o.processChunk(f)}),h.on("end",function(){o.end()}),h.on("error",function(f){o.error(f)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var h=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),h=!0),this.previous&&this.previous.resume(),!h},flush:function(){},processChunk:function(h){this.push(h)},withStreamInfo:function(h,o){return this.extraStreamInfo[h]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var h in this.extraStreamInfo)this.extraStreamInfo.hasOwnProperty(h)&&(this.streamInfo[h]=this.extraStreamInfo[h])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var h="Worker "+this.name;return this.previous?this.previous+" -> "+h:h}},i.exports=r},{}],29:[function(e,i,s){"use strict";var r=e("../utils"),h=e("./ConvertWorker"),o=e("./GenericWorker"),f=e("../base64"),x=e("../support"),D=e("../external"),C=null;if(x.nodestream)try{C=e("../nodejs/NodejsStreamOutputAdapter")}catch{}function E(_,l){return new D.Promise(function(m,c){var g=[],b=_._internalType,T=_._outputType,R=_._mimeType;_.on("data",function(U,L){g.push(U),l&&l(L)}).on("error",function(U){g=[],c(U)}).on("end",function(){try{var U=function(L,Z,P){switch(L){case"blob":return r.newBlob(r.transformTo("arraybuffer",Z),P);case"base64":return f.encode(Z);default:return r.transformTo(L,Z)}}(T,function(L,Z){var P,V=0,nt=null,w=0;for(P=0;P<Z.length;P++)w+=Z[P].length;switch(L){case"string":return Z.join("");case"array":return Array.prototype.concat.apply([],Z);case"uint8array":for(nt=new Uint8Array(w),P=0;P<Z.length;P++)nt.set(Z[P],V),V+=Z[P].length;return nt;case"nodebuffer":return Buffer.concat(Z);default:throw new Error("concat : unsupported type '"+L+"'")}}(b,g),R);m(U)}catch(L){c(L)}g=[]}).resume()})}function u(_,l,m){var c=l;switch(l){case"blob":case"arraybuffer":c="uint8array";break;case"base64":c="string"}try{this._internalType=c,this._outputType=l,this._mimeType=m,r.checkSupport(c),this._worker=_.pipe(new h(c)),_.lock()}catch(g){this._worker=new o("error"),this._worker.error(g)}}u.prototype={accumulate:function(_){return E(this,_)},on:function(_,l){var m=this;return _==="data"?this._worker.on(_,function(c){l.call(m,c.data,c.meta)}):this._worker.on(_,function(){r.delay(l,arguments,m)}),this},resume:function(){return r.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(_){if(r.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new C(this,{objectMode:this._outputType!=="nodebuffer"},_)}},i.exports=u},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,i,s){"use strict";if(s.base64=!0,s.array=!0,s.string=!0,s.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",s.nodebuffer=typeof Buffer<"u",s.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")s.blob=!1;else{var r=new ArrayBuffer(0);try{s.blob=new Blob([r],{type:"application/zip"}).size===0}catch{try{var h=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);h.append(r),s.blob=h.getBlob("application/zip").size===0}catch{s.blob=!1}}}try{s.nodestream=!!e("readable-stream").Readable}catch{s.nodestream=!1}},{"readable-stream":16}],31:[function(e,i,s){"use strict";for(var r=e("./utils"),h=e("./support"),o=e("./nodejsUtils"),f=e("./stream/GenericWorker"),x=new Array(256),D=0;D<256;D++)x[D]=252<=D?6:248<=D?5:240<=D?4:224<=D?3:192<=D?2:1;x[254]=x[254]=1;function C(){f.call(this,"utf-8 decode"),this.leftOver=null}function E(){f.call(this,"utf-8 encode")}s.utf8encode=function(u){return h.nodebuffer?o.newBufferFrom(u,"utf-8"):function(_){var l,m,c,g,b,T=_.length,R=0;for(g=0;g<T;g++)(64512&(m=_.charCodeAt(g)))==55296&&g+1<T&&(64512&(c=_.charCodeAt(g+1)))==56320&&(m=65536+(m-55296<<10)+(c-56320),g++),R+=m<128?1:m<2048?2:m<65536?3:4;for(l=h.uint8array?new Uint8Array(R):new Array(R),g=b=0;b<R;g++)(64512&(m=_.charCodeAt(g)))==55296&&g+1<T&&(64512&(c=_.charCodeAt(g+1)))==56320&&(m=65536+(m-55296<<10)+(c-56320),g++),m<128?l[b++]=m:(m<2048?l[b++]=192|m>>>6:(m<65536?l[b++]=224|m>>>12:(l[b++]=240|m>>>18,l[b++]=128|m>>>12&63),l[b++]=128|m>>>6&63),l[b++]=128|63&m);return l}(u)},s.utf8decode=function(u){return h.nodebuffer?r.transformTo("nodebuffer",u).toString("utf-8"):function(_){var l,m,c,g,b=_.length,T=new Array(2*b);for(l=m=0;l<b;)if((c=_[l++])<128)T[m++]=c;else if(4<(g=x[c]))T[m++]=65533,l+=g-1;else{for(c&=g===2?31:g===3?15:7;1<g&&l<b;)c=c<<6|63&_[l++],g--;1<g?T[m++]=65533:c<65536?T[m++]=c:(c-=65536,T[m++]=55296|c>>10&1023,T[m++]=56320|1023&c)}return T.length!==m&&(T.subarray?T=T.subarray(0,m):T.length=m),r.applyFromCharCode(T)}(u=r.transformTo(h.uint8array?"uint8array":"array",u))},r.inherits(C,f),C.prototype.processChunk=function(u){var _=r.transformTo(h.uint8array?"uint8array":"array",u.data);if(this.leftOver&&this.leftOver.length){if(h.uint8array){var l=_;(_=new Uint8Array(l.length+this.leftOver.length)).set(this.leftOver,0),_.set(l,this.leftOver.length)}else _=this.leftOver.concat(_);this.leftOver=null}var m=function(g,b){var T;for((b=b||g.length)>g.length&&(b=g.length),T=b-1;0<=T&&(192&g[T])==128;)T--;return T<0||T===0?b:T+x[g[T]]>b?T:b}(_),c=_;m!==_.length&&(h.uint8array?(c=_.subarray(0,m),this.leftOver=_.subarray(m,_.length)):(c=_.slice(0,m),this.leftOver=_.slice(m,_.length))),this.push({data:s.utf8decode(c),meta:u.meta})},C.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:s.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},s.Utf8DecodeWorker=C,r.inherits(E,f),E.prototype.processChunk=function(u){this.push({data:s.utf8encode(u.data),meta:u.meta})},s.Utf8EncodeWorker=E},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,i,s){"use strict";var r=e("./support"),h=e("./base64"),o=e("./nodejsUtils"),f=e("./external");function x(l){return l}function D(l,m){for(var c=0;c<l.length;++c)m[c]=255&l.charCodeAt(c);return m}e("setimmediate"),s.newBlob=function(l,m){s.checkSupport("blob");try{return new Blob([l],{type:m})}catch{try{var c=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return c.append(l),c.getBlob(m)}catch{throw new Error("Bug : can't construct the Blob.")}}};var C={stringifyByChunk:function(l,m,c){var g=[],b=0,T=l.length;if(T<=c)return String.fromCharCode.apply(null,l);for(;b<T;)m==="array"||m==="nodebuffer"?g.push(String.fromCharCode.apply(null,l.slice(b,Math.min(b+c,T)))):g.push(String.fromCharCode.apply(null,l.subarray(b,Math.min(b+c,T)))),b+=c;return g.join("")},stringifyByChar:function(l){for(var m="",c=0;c<l.length;c++)m+=String.fromCharCode(l[c]);return m},applyCanBeUsed:{uint8array:function(){try{return r.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return r.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch{return!1}}()}};function E(l){var m=65536,c=s.getTypeOf(l),g=!0;if(c==="uint8array"?g=C.applyCanBeUsed.uint8array:c==="nodebuffer"&&(g=C.applyCanBeUsed.nodebuffer),g)for(;1<m;)try{return C.stringifyByChunk(l,c,m)}catch{m=Math.floor(m/2)}return C.stringifyByChar(l)}function u(l,m){for(var c=0;c<l.length;c++)m[c]=l[c];return m}s.applyFromCharCode=E;var _={};_.string={string:x,array:function(l){return D(l,new Array(l.length))},arraybuffer:function(l){return _.string.uint8array(l).buffer},uint8array:function(l){return D(l,new Uint8Array(l.length))},nodebuffer:function(l){return D(l,o.allocBuffer(l.length))}},_.array={string:E,array:x,arraybuffer:function(l){return new Uint8Array(l).buffer},uint8array:function(l){return new Uint8Array(l)},nodebuffer:function(l){return o.newBufferFrom(l)}},_.arraybuffer={string:function(l){return E(new Uint8Array(l))},array:function(l){return u(new Uint8Array(l),new Array(l.byteLength))},arraybuffer:x,uint8array:function(l){return new Uint8Array(l)},nodebuffer:function(l){return o.newBufferFrom(new Uint8Array(l))}},_.uint8array={string:E,array:function(l){return u(l,new Array(l.length))},arraybuffer:function(l){return l.buffer},uint8array:x,nodebuffer:function(l){return o.newBufferFrom(l)}},_.nodebuffer={string:E,array:function(l){return u(l,new Array(l.length))},arraybuffer:function(l){return _.nodebuffer.uint8array(l).buffer},uint8array:function(l){return u(l,new Uint8Array(l.length))},nodebuffer:x},s.transformTo=function(l,m){if(m=m||"",!l)return m;s.checkSupport(l);var c=s.getTypeOf(m);return _[c][l](m)},s.resolve=function(l){for(var m=l.split("/"),c=[],g=0;g<m.length;g++){var b=m[g];b==="."||b===""&&g!==0&&g!==m.length-1||(b===".."?c.pop():c.push(b))}return c.join("/")},s.getTypeOf=function(l){return typeof l=="string"?"string":Object.prototype.toString.call(l)==="[object Array]"?"array":r.nodebuffer&&o.isBuffer(l)?"nodebuffer":r.uint8array&&l instanceof Uint8Array?"uint8array":r.arraybuffer&&l instanceof ArrayBuffer?"arraybuffer":void 0},s.checkSupport=function(l){if(!r[l.toLowerCase()])throw new Error(l+" is not supported by this platform")},s.MAX_VALUE_16BITS=65535,s.MAX_VALUE_32BITS=-1,s.pretty=function(l){var m,c,g="";for(c=0;c<(l||"").length;c++)g+="\\x"+((m=l.charCodeAt(c))<16?"0":"")+m.toString(16).toUpperCase();return g},s.delay=function(l,m,c){setImmediate(function(){l.apply(c||null,m||[])})},s.inherits=function(l,m){function c(){}c.prototype=m.prototype,l.prototype=new c},s.extend=function(){var l,m,c={};for(l=0;l<arguments.length;l++)for(m in arguments[l])arguments[l].hasOwnProperty(m)&&c[m]===void 0&&(c[m]=arguments[l][m]);return c},s.prepareContent=function(l,m,c,g,b){return f.Promise.resolve(m).then(function(T){return r.blob&&(T instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(T))!==-1)&&typeof FileReader<"u"?new f.Promise(function(R,U){var L=new FileReader;L.onload=function(Z){R(Z.target.result)},L.onerror=function(Z){U(Z.target.error)},L.readAsArrayBuffer(T)}):T}).then(function(T){var R=s.getTypeOf(T);return R?(R==="arraybuffer"?T=s.transformTo("uint8array",T):R==="string"&&(b?T=h.decode(T):c&&g!==!0&&(T=function(U){return D(U,r.uint8array?new Uint8Array(U.length):new Array(U.length))}(T))),T):f.Promise.reject(new Error("Can't read the data of '"+l+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,i,s){"use strict";var r=e("./reader/readerFor"),h=e("./utils"),o=e("./signature"),f=e("./zipEntry"),x=(e("./utf8"),e("./support"));function D(C){this.files=[],this.loadOptions=C}D.prototype={checkSignature:function(C){if(!this.reader.readAndCheckSignature(C)){this.reader.index-=4;var E=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+h.pretty(E)+", expected "+h.pretty(C)+")")}},isSignature:function(C,E){var u=this.reader.index;this.reader.setIndex(C);var _=this.reader.readString(4)===E;return this.reader.setIndex(u),_},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var C=this.reader.readData(this.zipCommentLength),E=x.uint8array?"uint8array":"array",u=h.transformTo(E,C);this.zipComment=this.loadOptions.decodeFileName(u)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var C,E,u,_=this.zip64EndOfCentralSize-44;0<_;)C=this.reader.readInt(2),E=this.reader.readInt(4),u=this.reader.readData(E),this.zip64ExtensibleData[C]={id:C,length:E,value:u}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var C,E;for(C=0;C<this.files.length;C++)E=this.files[C],this.reader.setIndex(E.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),E.readLocalPart(this.reader),E.handleUTF8(),E.processAttributes()},readCentralDir:function(){var C;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(C=new f({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(C);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var C=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(C<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(C);var E=C;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===h.MAX_VALUE_16BITS||this.diskWithCentralDirStart===h.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===h.MAX_VALUE_16BITS||this.centralDirRecords===h.MAX_VALUE_16BITS||this.centralDirSize===h.MAX_VALUE_32BITS||this.centralDirOffset===h.MAX_VALUE_32BITS){if(this.zip64=!0,(C=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(C),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var u=this.centralDirOffset+this.centralDirSize;this.zip64&&(u+=20,u+=12+this.zip64EndOfCentralSize);var _=E-u;if(0<_)this.isSignature(E,o.CENTRAL_FILE_HEADER)||(this.reader.zero=_);else if(_<0)throw new Error("Corrupted zip: missing "+Math.abs(_)+" bytes.")},prepareReader:function(C){this.reader=r(C)},load:function(C){this.prepareReader(C),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},i.exports=D},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utf8":31,"./utils":32,"./zipEntry":34}],34:[function(e,i,s){"use strict";var r=e("./reader/readerFor"),h=e("./utils"),o=e("./compressedObject"),f=e("./crc32"),x=e("./utf8"),D=e("./compressions"),C=e("./support");function E(u,_){this.options=u,this.loadOptions=_}E.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(u){var _,l;if(u.skip(22),this.fileNameLength=u.readInt(2),l=u.readInt(2),this.fileName=u.readData(this.fileNameLength),u.skip(l),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((_=function(m){for(var c in D)if(D.hasOwnProperty(c)&&D[c].magic===m)return D[c];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+h.pretty(this.compressionMethod)+" unknown (inner file : "+h.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,_,u.readData(this.compressedSize))},readCentralPart:function(u){this.versionMadeBy=u.readInt(2),u.skip(2),this.bitFlag=u.readInt(2),this.compressionMethod=u.readString(2),this.date=u.readDate(),this.crc32=u.readInt(4),this.compressedSize=u.readInt(4),this.uncompressedSize=u.readInt(4);var _=u.readInt(2);if(this.extraFieldsLength=u.readInt(2),this.fileCommentLength=u.readInt(2),this.diskNumberStart=u.readInt(2),this.internalFileAttributes=u.readInt(2),this.externalFileAttributes=u.readInt(4),this.localHeaderOffset=u.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");u.skip(_),this.readExtraFields(u),this.parseZIP64ExtraField(u),this.fileComment=u.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var u=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),u==0&&(this.dosPermissions=63&this.externalFileAttributes),u==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(u){if(this.extraFields[1]){var _=r(this.extraFields[1].value);this.uncompressedSize===h.MAX_VALUE_32BITS&&(this.uncompressedSize=_.readInt(8)),this.compressedSize===h.MAX_VALUE_32BITS&&(this.compressedSize=_.readInt(8)),this.localHeaderOffset===h.MAX_VALUE_32BITS&&(this.localHeaderOffset=_.readInt(8)),this.diskNumberStart===h.MAX_VALUE_32BITS&&(this.diskNumberStart=_.readInt(4))}},readExtraFields:function(u){var _,l,m,c=u.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});u.index+4<c;)_=u.readInt(2),l=u.readInt(2),m=u.readData(l),this.extraFields[_]={id:_,length:l,value:m};u.setIndex(c)},handleUTF8:function(){var u=C.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=x.utf8decode(this.fileName),this.fileCommentStr=x.utf8decode(this.fileComment);else{var _=this.findExtraFieldUnicodePath();if(_!==null)this.fileNameStr=_;else{var l=h.transformTo(u,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(l)}var m=this.findExtraFieldUnicodeComment();if(m!==null)this.fileCommentStr=m;else{var c=h.transformTo(u,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(c)}}},findExtraFieldUnicodePath:function(){var u=this.extraFields[28789];if(u){var _=r(u.value);return _.readInt(1)!==1||f(this.fileName)!==_.readInt(4)?null:x.utf8decode(_.readData(u.length-5))}return null},findExtraFieldUnicodeComment:function(){var u=this.extraFields[25461];if(u){var _=r(u.value);return _.readInt(1)!==1||f(this.fileComment)!==_.readInt(4)?null:x.utf8decode(_.readData(u.length-5))}return null}},i.exports=E},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,i,s){"use strict";function r(_,l,m){this.name=_,this.dir=m.dir,this.date=m.date,this.comment=m.comment,this.unixPermissions=m.unixPermissions,this.dosPermissions=m.dosPermissions,this._data=l,this._dataBinary=m.binary,this.options={compression:m.compression,compressionOptions:m.compressionOptions}}var h=e("./stream/StreamHelper"),o=e("./stream/DataWorker"),f=e("./utf8"),x=e("./compressedObject"),D=e("./stream/GenericWorker");r.prototype={internalStream:function(_){var l=null,m="string";try{if(!_)throw new Error("No output type specified.");var c=(m=_.toLowerCase())==="string"||m==="text";m!=="binarystring"&&m!=="text"||(m="string"),l=this._decompressWorker();var g=!this._dataBinary;g&&!c&&(l=l.pipe(new f.Utf8EncodeWorker)),!g&&c&&(l=l.pipe(new f.Utf8DecodeWorker))}catch(b){(l=new D("error")).error(b)}return new h(l,m,"")},async:function(_,l){return this.internalStream(_).accumulate(l)},nodeStream:function(_,l){return this.internalStream(_||"nodebuffer").toNodejsStream(l)},_compressWorker:function(_,l){if(this._data instanceof x&&this._data.compression.magic===_.magic)return this._data.getCompressedWorker();var m=this._decompressWorker();return this._dataBinary||(m=m.pipe(new f.Utf8EncodeWorker)),x.createWorkerFrom(m,_,l)},_decompressWorker:function(){return this._data instanceof x?this._data.getContentWorker():this._data instanceof D?this._data:new o(this._data)}};for(var C=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],E=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},u=0;u<C.length;u++)r.prototype[C[u]]=E;i.exports=r},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,i,s){(function(r){"use strict";var h,o,f=r.MutationObserver||r.WebKitMutationObserver;if(f){var x=0,D=new f(_),C=r.document.createTextNode("");D.observe(C,{characterData:!0}),h=function(){C.data=x=++x%2}}else if(r.setImmediate||r.MessageChannel===void 0)h="document"in r&&"onreadystatechange"in r.document.createElement("script")?function(){var l=r.document.createElement("script");l.onreadystatechange=function(){_(),l.onreadystatechange=null,l.parentNode.removeChild(l),l=null},r.document.documentElement.appendChild(l)}:function(){setTimeout(_,0)};else{var E=new r.MessageChannel;E.port1.onmessage=_,h=function(){E.port2.postMessage(0)}}var u=[];function _(){var l,m;o=!0;for(var c=u.length;c;){for(m=u,u=[],l=-1;++l<c;)m[l]();c=u.length}o=!1}i.exports=function(l){u.push(l)!==1||o||h()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(e,i,s){"use strict";var r=e("immediate");function h(){}var o={},f=["REJECTED"],x=["FULFILLED"],D=["PENDING"];function C(c){if(typeof c!="function")throw new TypeError("resolver must be a function");this.state=D,this.queue=[],this.outcome=void 0,c!==h&&l(this,c)}function E(c,g,b){this.promise=c,typeof g=="function"&&(this.onFulfilled=g,this.callFulfilled=this.otherCallFulfilled),typeof b=="function"&&(this.onRejected=b,this.callRejected=this.otherCallRejected)}function u(c,g,b){r(function(){var T;try{T=g(b)}catch(R){return o.reject(c,R)}T===c?o.reject(c,new TypeError("Cannot resolve promise with itself")):o.resolve(c,T)})}function _(c){var g=c&&c.then;if(c&&(typeof c=="object"||typeof c=="function")&&typeof g=="function")return function(){g.apply(c,arguments)}}function l(c,g){var b=!1;function T(L){b||(b=!0,o.reject(c,L))}function R(L){b||(b=!0,o.resolve(c,L))}var U=m(function(){g(R,T)});U.status==="error"&&T(U.value)}function m(c,g){var b={};try{b.value=c(g),b.status="success"}catch(T){b.status="error",b.value=T}return b}(i.exports=C).prototype.finally=function(c){if(typeof c!="function")return this;var g=this.constructor;return this.then(function(b){return g.resolve(c()).then(function(){return b})},function(b){return g.resolve(c()).then(function(){throw b})})},C.prototype.catch=function(c){return this.then(null,c)},C.prototype.then=function(c,g){if(typeof c!="function"&&this.state===x||typeof g!="function"&&this.state===f)return this;var b=new this.constructor(h);return this.state!==D?u(b,this.state===x?c:g,this.outcome):this.queue.push(new E(b,c,g)),b},E.prototype.callFulfilled=function(c){o.resolve(this.promise,c)},E.prototype.otherCallFulfilled=function(c){u(this.promise,this.onFulfilled,c)},E.prototype.callRejected=function(c){o.reject(this.promise,c)},E.prototype.otherCallRejected=function(c){u(this.promise,this.onRejected,c)},o.resolve=function(c,g){var b=m(_,g);if(b.status==="error")return o.reject(c,b.value);var T=b.value;if(T)l(c,T);else{c.state=x,c.outcome=g;for(var R=-1,U=c.queue.length;++R<U;)c.queue[R].callFulfilled(g)}return c},o.reject=function(c,g){c.state=f,c.outcome=g;for(var b=-1,T=c.queue.length;++b<T;)c.queue[b].callRejected(g);return c},C.resolve=function(c){return c instanceof this?c:o.resolve(new this(h),c)},C.reject=function(c){var g=new this(h);return o.reject(g,c)},C.all=function(c){var g=this;if(Object.prototype.toString.call(c)!=="[object Array]")return this.reject(new TypeError("must be an array"));var b=c.length,T=!1;if(!b)return this.resolve([]);for(var R=new Array(b),U=0,L=-1,Z=new this(h);++L<b;)P(c[L],L);return Z;function P(V,nt){g.resolve(V).then(function(w){R[nt]=w,++U!==b||T||(T=!0,o.resolve(Z,R))},function(w){T||(T=!0,o.reject(Z,w))})}},C.race=function(c){var g=this;if(Object.prototype.toString.call(c)!=="[object Array]")return this.reject(new TypeError("must be an array"));var b=c.length,T=!1;if(!b)return this.resolve([]);for(var R=-1,U=new this(h);++R<b;)L=c[R],g.resolve(L).then(function(Z){T||(T=!0,o.resolve(U,Z))},function(Z){T||(T=!0,o.reject(U,Z))});var L;return U}},{immediate:36}],38:[function(e,i,s){"use strict";var r={};(0,e("./lib/utils/common").assign)(r,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),i.exports=r},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,i,s){"use strict";var r=e("./zlib/deflate"),h=e("./utils/common"),o=e("./utils/strings"),f=e("./zlib/messages"),x=e("./zlib/zstream"),D=Object.prototype.toString,C=0,E=-1,u=0,_=8;function l(c){if(!(this instanceof l))return new l(c);this.options=h.assign({level:E,method:_,chunkSize:16384,windowBits:15,memLevel:8,strategy:u,to:""},c||{});var g=this.options;g.raw&&0<g.windowBits?g.windowBits=-g.windowBits:g.gzip&&0<g.windowBits&&g.windowBits<16&&(g.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new x,this.strm.avail_out=0;var b=r.deflateInit2(this.strm,g.level,g.method,g.windowBits,g.memLevel,g.strategy);if(b!==C)throw new Error(f[b]);if(g.header&&r.deflateSetHeader(this.strm,g.header),g.dictionary){var T;if(T=typeof g.dictionary=="string"?o.string2buf(g.dictionary):D.call(g.dictionary)==="[object ArrayBuffer]"?new Uint8Array(g.dictionary):g.dictionary,(b=r.deflateSetDictionary(this.strm,T))!==C)throw new Error(f[b]);this._dict_set=!0}}function m(c,g){var b=new l(g);if(b.push(c,!0),b.err)throw b.msg||f[b.err];return b.result}l.prototype.push=function(c,g){var b,T,R=this.strm,U=this.options.chunkSize;if(this.ended)return!1;T=g===~~g?g:g===!0?4:0,typeof c=="string"?R.input=o.string2buf(c):D.call(c)==="[object ArrayBuffer]"?R.input=new Uint8Array(c):R.input=c,R.next_in=0,R.avail_in=R.input.length;do{if(R.avail_out===0&&(R.output=new h.Buf8(U),R.next_out=0,R.avail_out=U),(b=r.deflate(R,T))!==1&&b!==C)return this.onEnd(b),!(this.ended=!0);R.avail_out!==0&&(R.avail_in!==0||T!==4&&T!==2)||(this.options.to==="string"?this.onData(o.buf2binstring(h.shrinkBuf(R.output,R.next_out))):this.onData(h.shrinkBuf(R.output,R.next_out)))}while((0<R.avail_in||R.avail_out===0)&&b!==1);return T===4?(b=r.deflateEnd(this.strm),this.onEnd(b),this.ended=!0,b===C):T!==2||(this.onEnd(C),!(R.avail_out=0))},l.prototype.onData=function(c){this.chunks.push(c)},l.prototype.onEnd=function(c){c===C&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=h.flattenChunks(this.chunks)),this.chunks=[],this.err=c,this.msg=this.strm.msg},s.Deflate=l,s.deflate=m,s.deflateRaw=function(c,g){return(g=g||{}).raw=!0,m(c,g)},s.gzip=function(c,g){return(g=g||{}).gzip=!0,m(c,g)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,i,s){"use strict";var r=e("./zlib/inflate"),h=e("./utils/common"),o=e("./utils/strings"),f=e("./zlib/constants"),x=e("./zlib/messages"),D=e("./zlib/zstream"),C=e("./zlib/gzheader"),E=Object.prototype.toString;function u(l){if(!(this instanceof u))return new u(l);this.options=h.assign({chunkSize:16384,windowBits:0,to:""},l||{});var m=this.options;m.raw&&0<=m.windowBits&&m.windowBits<16&&(m.windowBits=-m.windowBits,m.windowBits===0&&(m.windowBits=-15)),!(0<=m.windowBits&&m.windowBits<16)||l&&l.windowBits||(m.windowBits+=32),15<m.windowBits&&m.windowBits<48&&(15&m.windowBits)==0&&(m.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new D,this.strm.avail_out=0;var c=r.inflateInit2(this.strm,m.windowBits);if(c!==f.Z_OK)throw new Error(x[c]);this.header=new C,r.inflateGetHeader(this.strm,this.header)}function _(l,m){var c=new u(m);if(c.push(l,!0),c.err)throw c.msg||x[c.err];return c.result}u.prototype.push=function(l,m){var c,g,b,T,R,U,L=this.strm,Z=this.options.chunkSize,P=this.options.dictionary,V=!1;if(this.ended)return!1;g=m===~~m?m:m===!0?f.Z_FINISH:f.Z_NO_FLUSH,typeof l=="string"?L.input=o.binstring2buf(l):E.call(l)==="[object ArrayBuffer]"?L.input=new Uint8Array(l):L.input=l,L.next_in=0,L.avail_in=L.input.length;do{if(L.avail_out===0&&(L.output=new h.Buf8(Z),L.next_out=0,L.avail_out=Z),(c=r.inflate(L,f.Z_NO_FLUSH))===f.Z_NEED_DICT&&P&&(U=typeof P=="string"?o.string2buf(P):E.call(P)==="[object ArrayBuffer]"?new Uint8Array(P):P,c=r.inflateSetDictionary(this.strm,U)),c===f.Z_BUF_ERROR&&V===!0&&(c=f.Z_OK,V=!1),c!==f.Z_STREAM_END&&c!==f.Z_OK)return this.onEnd(c),!(this.ended=!0);L.next_out&&(L.avail_out!==0&&c!==f.Z_STREAM_END&&(L.avail_in!==0||g!==f.Z_FINISH&&g!==f.Z_SYNC_FLUSH)||(this.options.to==="string"?(b=o.utf8border(L.output,L.next_out),T=L.next_out-b,R=o.buf2string(L.output,b),L.next_out=T,L.avail_out=Z-T,T&&h.arraySet(L.output,L.output,b,T,0),this.onData(R)):this.onData(h.shrinkBuf(L.output,L.next_out)))),L.avail_in===0&&L.avail_out===0&&(V=!0)}while((0<L.avail_in||L.avail_out===0)&&c!==f.Z_STREAM_END);return c===f.Z_STREAM_END&&(g=f.Z_FINISH),g===f.Z_FINISH?(c=r.inflateEnd(this.strm),this.onEnd(c),this.ended=!0,c===f.Z_OK):g!==f.Z_SYNC_FLUSH||(this.onEnd(f.Z_OK),!(L.avail_out=0))},u.prototype.onData=function(l){this.chunks.push(l)},u.prototype.onEnd=function(l){l===f.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=h.flattenChunks(this.chunks)),this.chunks=[],this.err=l,this.msg=this.strm.msg},s.Inflate=u,s.inflate=_,s.inflateRaw=function(l,m){return(m=m||{}).raw=!0,_(l,m)},s.ungzip=_},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,i,s){"use strict";var r=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";s.assign=function(f){for(var x=Array.prototype.slice.call(arguments,1);x.length;){var D=x.shift();if(D){if(typeof D!="object")throw new TypeError(D+"must be non-object");for(var C in D)D.hasOwnProperty(C)&&(f[C]=D[C])}}return f},s.shrinkBuf=function(f,x){return f.length===x?f:f.subarray?f.subarray(0,x):(f.length=x,f)};var h={arraySet:function(f,x,D,C,E){if(x.subarray&&f.subarray)f.set(x.subarray(D,D+C),E);else for(var u=0;u<C;u++)f[E+u]=x[D+u]},flattenChunks:function(f){var x,D,C,E,u,_;for(x=C=0,D=f.length;x<D;x++)C+=f[x].length;for(_=new Uint8Array(C),x=E=0,D=f.length;x<D;x++)u=f[x],_.set(u,E),E+=u.length;return _}},o={arraySet:function(f,x,D,C,E){for(var u=0;u<C;u++)f[E+u]=x[D+u]},flattenChunks:function(f){return[].concat.apply([],f)}};s.setTyped=function(f){f?(s.Buf8=Uint8Array,s.Buf16=Uint16Array,s.Buf32=Int32Array,s.assign(s,h)):(s.Buf8=Array,s.Buf16=Array,s.Buf32=Array,s.assign(s,o))},s.setTyped(r)},{}],42:[function(e,i,s){"use strict";var r=e("./common"),h=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch{h=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{o=!1}for(var f=new r.Buf8(256),x=0;x<256;x++)f[x]=252<=x?6:248<=x?5:240<=x?4:224<=x?3:192<=x?2:1;function D(C,E){if(E<65537&&(C.subarray&&o||!C.subarray&&h))return String.fromCharCode.apply(null,r.shrinkBuf(C,E));for(var u="",_=0;_<E;_++)u+=String.fromCharCode(C[_]);return u}f[254]=f[254]=1,s.string2buf=function(C){var E,u,_,l,m,c=C.length,g=0;for(l=0;l<c;l++)(64512&(u=C.charCodeAt(l)))==55296&&l+1<c&&(64512&(_=C.charCodeAt(l+1)))==56320&&(u=65536+(u-55296<<10)+(_-56320),l++),g+=u<128?1:u<2048?2:u<65536?3:4;for(E=new r.Buf8(g),l=m=0;m<g;l++)(64512&(u=C.charCodeAt(l)))==55296&&l+1<c&&(64512&(_=C.charCodeAt(l+1)))==56320&&(u=65536+(u-55296<<10)+(_-56320),l++),u<128?E[m++]=u:(u<2048?E[m++]=192|u>>>6:(u<65536?E[m++]=224|u>>>12:(E[m++]=240|u>>>18,E[m++]=128|u>>>12&63),E[m++]=128|u>>>6&63),E[m++]=128|63&u);return E},s.buf2binstring=function(C){return D(C,C.length)},s.binstring2buf=function(C){for(var E=new r.Buf8(C.length),u=0,_=E.length;u<_;u++)E[u]=C.charCodeAt(u);return E},s.buf2string=function(C,E){var u,_,l,m,c=E||C.length,g=new Array(2*c);for(u=_=0;u<c;)if((l=C[u++])<128)g[_++]=l;else if(4<(m=f[l]))g[_++]=65533,u+=m-1;else{for(l&=m===2?31:m===3?15:7;1<m&&u<c;)l=l<<6|63&C[u++],m--;1<m?g[_++]=65533:l<65536?g[_++]=l:(l-=65536,g[_++]=55296|l>>10&1023,g[_++]=56320|1023&l)}return D(g,_)},s.utf8border=function(C,E){var u;for((E=E||C.length)>C.length&&(E=C.length),u=E-1;0<=u&&(192&C[u])==128;)u--;return u<0||u===0?E:u+f[C[u]]>E?u:E}},{"./common":41}],43:[function(e,i,s){"use strict";i.exports=function(r,h,o,f){for(var x=65535&r|0,D=r>>>16&65535|0,C=0;o!==0;){for(o-=C=2e3<o?2e3:o;D=D+(x=x+h[f++]|0)|0,--C;);x%=65521,D%=65521}return x|D<<16|0}},{}],44:[function(e,i,s){"use strict";i.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,i,s){"use strict";var r=function(){for(var h,o=[],f=0;f<256;f++){h=f;for(var x=0;x<8;x++)h=1&h?3988292384^h>>>1:h>>>1;o[f]=h}return o}();i.exports=function(h,o,f,x){var D=r,C=x+f;h^=-1;for(var E=x;E<C;E++)h=h>>>8^D[255&(h^o[E])];return-1^h}},{}],46:[function(e,i,s){"use strict";var r,h=e("../utils/common"),o=e("./trees"),f=e("./adler32"),x=e("./crc32"),D=e("./messages"),C=0,E=4,u=0,_=-2,l=-1,m=4,c=2,g=8,b=9,T=286,R=30,U=19,L=2*T+1,Z=15,P=3,V=258,nt=V+P+1,w=42,$=113,n=1,H=2,ht=3,X=4;function lt(t,p){return t.msg=D[p],p}function Y(t){return(t<<1)-(4<t?9:0)}function ut(t){for(var p=t.length;0<=--p;)t[p]=0}function B(t){var p=t.state,k=p.pending;k>t.avail_out&&(k=t.avail_out),k!==0&&(h.arraySet(t.output,p.pending_buf,p.pending_out,k,t.next_out),t.next_out+=k,p.pending_out+=k,t.total_out+=k,t.avail_out-=k,p.pending-=k,p.pending===0&&(p.pending_out=0))}function z(t,p){o._tr_flush_block(t,0<=t.block_start?t.block_start:-1,t.strstart-t.block_start,p),t.block_start=t.strstart,B(t.strm)}function ot(t,p){t.pending_buf[t.pending++]=p}function it(t,p){t.pending_buf[t.pending++]=p>>>8&255,t.pending_buf[t.pending++]=255&p}function J(t,p){var k,d,a=t.max_chain_length,v=t.strstart,M=t.prev_length,W=t.nice_match,O=t.strstart>t.w_size-nt?t.strstart-(t.w_size-nt):0,Q=t.window,tt=t.w_mask,j=t.prev,st=t.strstart+V,mt=Q[v+M-1],ft=Q[v+M];t.prev_length>=t.good_match&&(a>>=2),W>t.lookahead&&(W=t.lookahead);do if(Q[(k=p)+M]===ft&&Q[k+M-1]===mt&&Q[k]===Q[v]&&Q[++k]===Q[v+1]){v+=2,k++;do;while(Q[++v]===Q[++k]&&Q[++v]===Q[++k]&&Q[++v]===Q[++k]&&Q[++v]===Q[++k]&&Q[++v]===Q[++k]&&Q[++v]===Q[++k]&&Q[++v]===Q[++k]&&Q[++v]===Q[++k]&&v<st);if(d=V-(st-v),v=st-V,M<d){if(t.match_start=p,W<=(M=d))break;mt=Q[v+M-1],ft=Q[v+M]}}while((p=j[p&tt])>O&&--a!=0);return M<=t.lookahead?M:t.lookahead}function wt(t){var p,k,d,a,v,M,W,O,Q,tt,j=t.w_size;do{if(a=t.window_size-t.lookahead-t.strstart,t.strstart>=j+(j-nt)){for(h.arraySet(t.window,t.window,j,j,0),t.match_start-=j,t.strstart-=j,t.block_start-=j,p=k=t.hash_size;d=t.head[--p],t.head[p]=j<=d?d-j:0,--k;);for(p=k=j;d=t.prev[--p],t.prev[p]=j<=d?d-j:0,--k;);a+=j}if(t.strm.avail_in===0)break;if(M=t.strm,W=t.window,O=t.strstart+t.lookahead,Q=a,tt=void 0,tt=M.avail_in,Q<tt&&(tt=Q),k=tt===0?0:(M.avail_in-=tt,h.arraySet(W,M.input,M.next_in,tt,O),M.state.wrap===1?M.adler=f(M.adler,W,tt,O):M.state.wrap===2&&(M.adler=x(M.adler,W,tt,O)),M.next_in+=tt,M.total_in+=tt,tt),t.lookahead+=k,t.lookahead+t.insert>=P)for(v=t.strstart-t.insert,t.ins_h=t.window[v],t.ins_h=(t.ins_h<<t.hash_shift^t.window[v+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[v+P-1])&t.hash_mask,t.prev[v&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=v,v++,t.insert--,!(t.lookahead+t.insert<P)););}while(t.lookahead<nt&&t.strm.avail_in!==0)}function kt(t,p){for(var k,d;;){if(t.lookahead<nt){if(wt(t),t.lookahead<nt&&p===C)return n;if(t.lookahead===0)break}if(k=0,t.lookahead>=P&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+P-1])&t.hash_mask,k=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),k!==0&&t.strstart-k<=t.w_size-nt&&(t.match_length=J(t,k)),t.match_length>=P)if(d=o._tr_tally(t,t.strstart-t.match_start,t.match_length-P),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=P){for(t.match_length--;t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+P-1])&t.hash_mask,k=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart,--t.match_length!=0;);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else d=o._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(d&&(z(t,!1),t.strm.avail_out===0))return n}return t.insert=t.strstart<P-1?t.strstart:P-1,p===E?(z(t,!0),t.strm.avail_out===0?ht:X):t.last_lit&&(z(t,!1),t.strm.avail_out===0)?n:H}function dt(t,p){for(var k,d,a;;){if(t.lookahead<nt){if(wt(t),t.lookahead<nt&&p===C)return n;if(t.lookahead===0)break}if(k=0,t.lookahead>=P&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+P-1])&t.hash_mask,k=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=P-1,k!==0&&t.prev_length<t.max_lazy_match&&t.strstart-k<=t.w_size-nt&&(t.match_length=J(t,k),t.match_length<=5&&(t.strategy===1||t.match_length===P&&4096<t.strstart-t.match_start)&&(t.match_length=P-1)),t.prev_length>=P&&t.match_length<=t.prev_length){for(a=t.strstart+t.lookahead-P,d=o._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-P),t.lookahead-=t.prev_length-1,t.prev_length-=2;++t.strstart<=a&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+P-1])&t.hash_mask,k=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),--t.prev_length!=0;);if(t.match_available=0,t.match_length=P-1,t.strstart++,d&&(z(t,!1),t.strm.avail_out===0))return n}else if(t.match_available){if((d=o._tr_tally(t,0,t.window[t.strstart-1]))&&z(t,!1),t.strstart++,t.lookahead--,t.strm.avail_out===0)return n}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(d=o._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<P-1?t.strstart:P-1,p===E?(z(t,!0),t.strm.avail_out===0?ht:X):t.last_lit&&(z(t,!1),t.strm.avail_out===0)?n:H}function y(t,p,k,d,a){this.good_length=t,this.max_lazy=p,this.nice_length=k,this.max_chain=d,this.func=a}function A(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=g,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new h.Buf16(2*L),this.dyn_dtree=new h.Buf16(2*(2*R+1)),this.bl_tree=new h.Buf16(2*(2*U+1)),ut(this.dyn_ltree),ut(this.dyn_dtree),ut(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new h.Buf16(Z+1),this.heap=new h.Buf16(2*T+1),ut(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new h.Buf16(2*T+1),ut(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function S(t){var p;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=c,(p=t.state).pending=0,p.pending_out=0,p.wrap<0&&(p.wrap=-p.wrap),p.status=p.wrap?w:$,t.adler=p.wrap===2?0:1,p.last_flush=C,o._tr_init(p),u):lt(t,_)}function et(t){var p=S(t);return p===u&&function(k){k.window_size=2*k.w_size,ut(k.head),k.max_lazy_match=r[k.level].max_lazy,k.good_match=r[k.level].good_length,k.nice_match=r[k.level].nice_length,k.max_chain_length=r[k.level].max_chain,k.strstart=0,k.block_start=0,k.lookahead=0,k.insert=0,k.match_length=k.prev_length=P-1,k.match_available=0,k.ins_h=0}(t.state),p}function F(t,p,k,d,a,v){if(!t)return _;var M=1;if(p===l&&(p=6),d<0?(M=0,d=-d):15<d&&(M=2,d-=16),a<1||b<a||k!==g||d<8||15<d||p<0||9<p||v<0||m<v)return lt(t,_);d===8&&(d=9);var W=new A;return(t.state=W).strm=t,W.wrap=M,W.gzhead=null,W.w_bits=d,W.w_size=1<<W.w_bits,W.w_mask=W.w_size-1,W.hash_bits=a+7,W.hash_size=1<<W.hash_bits,W.hash_mask=W.hash_size-1,W.hash_shift=~~((W.hash_bits+P-1)/P),W.window=new h.Buf8(2*W.w_size),W.head=new h.Buf16(W.hash_size),W.prev=new h.Buf16(W.w_size),W.lit_bufsize=1<<a+6,W.pending_buf_size=4*W.lit_bufsize,W.pending_buf=new h.Buf8(W.pending_buf_size),W.d_buf=1*W.lit_bufsize,W.l_buf=3*W.lit_bufsize,W.level=p,W.strategy=v,W.method=k,et(t)}r=[new y(0,0,0,0,function(t,p){var k=65535;for(k>t.pending_buf_size-5&&(k=t.pending_buf_size-5);;){if(t.lookahead<=1){if(wt(t),t.lookahead===0&&p===C)return n;if(t.lookahead===0)break}t.strstart+=t.lookahead,t.lookahead=0;var d=t.block_start+k;if((t.strstart===0||t.strstart>=d)&&(t.lookahead=t.strstart-d,t.strstart=d,z(t,!1),t.strm.avail_out===0)||t.strstart-t.block_start>=t.w_size-nt&&(z(t,!1),t.strm.avail_out===0))return n}return t.insert=0,p===E?(z(t,!0),t.strm.avail_out===0?ht:X):(t.strstart>t.block_start&&(z(t,!1),t.strm.avail_out),n)}),new y(4,4,8,4,kt),new y(4,5,16,8,kt),new y(4,6,32,32,kt),new y(4,4,16,16,dt),new y(8,16,32,32,dt),new y(8,16,128,128,dt),new y(8,32,128,256,dt),new y(32,128,258,1024,dt),new y(32,258,258,4096,dt)],s.deflateInit=function(t,p){return F(t,p,g,15,8,0)},s.deflateInit2=F,s.deflateReset=et,s.deflateResetKeep=S,s.deflateSetHeader=function(t,p){return t&&t.state?t.state.wrap!==2?_:(t.state.gzhead=p,u):_},s.deflate=function(t,p){var k,d,a,v;if(!t||!t.state||5<p||p<0)return t?lt(t,_):_;if(d=t.state,!t.output||!t.input&&t.avail_in!==0||d.status===666&&p!==E)return lt(t,t.avail_out===0?-5:_);if(d.strm=t,k=d.last_flush,d.last_flush=p,d.status===w)if(d.wrap===2)t.adler=0,ot(d,31),ot(d,139),ot(d,8),d.gzhead?(ot(d,(d.gzhead.text?1:0)+(d.gzhead.hcrc?2:0)+(d.gzhead.extra?4:0)+(d.gzhead.name?8:0)+(d.gzhead.comment?16:0)),ot(d,255&d.gzhead.time),ot(d,d.gzhead.time>>8&255),ot(d,d.gzhead.time>>16&255),ot(d,d.gzhead.time>>24&255),ot(d,d.level===9?2:2<=d.strategy||d.level<2?4:0),ot(d,255&d.gzhead.os),d.gzhead.extra&&d.gzhead.extra.length&&(ot(d,255&d.gzhead.extra.length),ot(d,d.gzhead.extra.length>>8&255)),d.gzhead.hcrc&&(t.adler=x(t.adler,d.pending_buf,d.pending,0)),d.gzindex=0,d.status=69):(ot(d,0),ot(d,0),ot(d,0),ot(d,0),ot(d,0),ot(d,d.level===9?2:2<=d.strategy||d.level<2?4:0),ot(d,3),d.status=$);else{var M=g+(d.w_bits-8<<4)<<8;M|=(2<=d.strategy||d.level<2?0:d.level<6?1:d.level===6?2:3)<<6,d.strstart!==0&&(M|=32),M+=31-M%31,d.status=$,it(d,M),d.strstart!==0&&(it(d,t.adler>>>16),it(d,65535&t.adler)),t.adler=1}if(d.status===69)if(d.gzhead.extra){for(a=d.pending;d.gzindex<(65535&d.gzhead.extra.length)&&(d.pending!==d.pending_buf_size||(d.gzhead.hcrc&&d.pending>a&&(t.adler=x(t.adler,d.pending_buf,d.pending-a,a)),B(t),a=d.pending,d.pending!==d.pending_buf_size));)ot(d,255&d.gzhead.extra[d.gzindex]),d.gzindex++;d.gzhead.hcrc&&d.pending>a&&(t.adler=x(t.adler,d.pending_buf,d.pending-a,a)),d.gzindex===d.gzhead.extra.length&&(d.gzindex=0,d.status=73)}else d.status=73;if(d.status===73)if(d.gzhead.name){a=d.pending;do{if(d.pending===d.pending_buf_size&&(d.gzhead.hcrc&&d.pending>a&&(t.adler=x(t.adler,d.pending_buf,d.pending-a,a)),B(t),a=d.pending,d.pending===d.pending_buf_size)){v=1;break}v=d.gzindex<d.gzhead.name.length?255&d.gzhead.name.charCodeAt(d.gzindex++):0,ot(d,v)}while(v!==0);d.gzhead.hcrc&&d.pending>a&&(t.adler=x(t.adler,d.pending_buf,d.pending-a,a)),v===0&&(d.gzindex=0,d.status=91)}else d.status=91;if(d.status===91)if(d.gzhead.comment){a=d.pending;do{if(d.pending===d.pending_buf_size&&(d.gzhead.hcrc&&d.pending>a&&(t.adler=x(t.adler,d.pending_buf,d.pending-a,a)),B(t),a=d.pending,d.pending===d.pending_buf_size)){v=1;break}v=d.gzindex<d.gzhead.comment.length?255&d.gzhead.comment.charCodeAt(d.gzindex++):0,ot(d,v)}while(v!==0);d.gzhead.hcrc&&d.pending>a&&(t.adler=x(t.adler,d.pending_buf,d.pending-a,a)),v===0&&(d.status=103)}else d.status=103;if(d.status===103&&(d.gzhead.hcrc?(d.pending+2>d.pending_buf_size&&B(t),d.pending+2<=d.pending_buf_size&&(ot(d,255&t.adler),ot(d,t.adler>>8&255),t.adler=0,d.status=$)):d.status=$),d.pending!==0){if(B(t),t.avail_out===0)return d.last_flush=-1,u}else if(t.avail_in===0&&Y(p)<=Y(k)&&p!==E)return lt(t,-5);if(d.status===666&&t.avail_in!==0)return lt(t,-5);if(t.avail_in!==0||d.lookahead!==0||p!==C&&d.status!==666){var W=d.strategy===2?function(O,Q){for(var tt;;){if(O.lookahead===0&&(wt(O),O.lookahead===0)){if(Q===C)return n;break}if(O.match_length=0,tt=o._tr_tally(O,0,O.window[O.strstart]),O.lookahead--,O.strstart++,tt&&(z(O,!1),O.strm.avail_out===0))return n}return O.insert=0,Q===E?(z(O,!0),O.strm.avail_out===0?ht:X):O.last_lit&&(z(O,!1),O.strm.avail_out===0)?n:H}(d,p):d.strategy===3?function(O,Q){for(var tt,j,st,mt,ft=O.window;;){if(O.lookahead<=V){if(wt(O),O.lookahead<=V&&Q===C)return n;if(O.lookahead===0)break}if(O.match_length=0,O.lookahead>=P&&0<O.strstart&&(j=ft[st=O.strstart-1])===ft[++st]&&j===ft[++st]&&j===ft[++st]){mt=O.strstart+V;do;while(j===ft[++st]&&j===ft[++st]&&j===ft[++st]&&j===ft[++st]&&j===ft[++st]&&j===ft[++st]&&j===ft[++st]&&j===ft[++st]&&st<mt);O.match_length=V-(mt-st),O.match_length>O.lookahead&&(O.match_length=O.lookahead)}if(O.match_length>=P?(tt=o._tr_tally(O,1,O.match_length-P),O.lookahead-=O.match_length,O.strstart+=O.match_length,O.match_length=0):(tt=o._tr_tally(O,0,O.window[O.strstart]),O.lookahead--,O.strstart++),tt&&(z(O,!1),O.strm.avail_out===0))return n}return O.insert=0,Q===E?(z(O,!0),O.strm.avail_out===0?ht:X):O.last_lit&&(z(O,!1),O.strm.avail_out===0)?n:H}(d,p):r[d.level].func(d,p);if(W!==ht&&W!==X||(d.status=666),W===n||W===ht)return t.avail_out===0&&(d.last_flush=-1),u;if(W===H&&(p===1?o._tr_align(d):p!==5&&(o._tr_stored_block(d,0,0,!1),p===3&&(ut(d.head),d.lookahead===0&&(d.strstart=0,d.block_start=0,d.insert=0))),B(t),t.avail_out===0))return d.last_flush=-1,u}return p!==E?u:d.wrap<=0?1:(d.wrap===2?(ot(d,255&t.adler),ot(d,t.adler>>8&255),ot(d,t.adler>>16&255),ot(d,t.adler>>24&255),ot(d,255&t.total_in),ot(d,t.total_in>>8&255),ot(d,t.total_in>>16&255),ot(d,t.total_in>>24&255)):(it(d,t.adler>>>16),it(d,65535&t.adler)),B(t),0<d.wrap&&(d.wrap=-d.wrap),d.pending!==0?u:1)},s.deflateEnd=function(t){var p;return t&&t.state?(p=t.state.status)!==w&&p!==69&&p!==73&&p!==91&&p!==103&&p!==$&&p!==666?lt(t,_):(t.state=null,p===$?lt(t,-3):u):_},s.deflateSetDictionary=function(t,p){var k,d,a,v,M,W,O,Q,tt=p.length;if(!t||!t.state||(v=(k=t.state).wrap)===2||v===1&&k.status!==w||k.lookahead)return _;for(v===1&&(t.adler=f(t.adler,p,tt,0)),k.wrap=0,tt>=k.w_size&&(v===0&&(ut(k.head),k.strstart=0,k.block_start=0,k.insert=0),Q=new h.Buf8(k.w_size),h.arraySet(Q,p,tt-k.w_size,k.w_size,0),p=Q,tt=k.w_size),M=t.avail_in,W=t.next_in,O=t.input,t.avail_in=tt,t.next_in=0,t.input=p,wt(k);k.lookahead>=P;){for(d=k.strstart,a=k.lookahead-(P-1);k.ins_h=(k.ins_h<<k.hash_shift^k.window[d+P-1])&k.hash_mask,k.prev[d&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=d,d++,--a;);k.strstart=d,k.lookahead=P-1,wt(k)}return k.strstart+=k.lookahead,k.block_start=k.strstart,k.insert=k.lookahead,k.lookahead=0,k.match_length=k.prev_length=P-1,k.match_available=0,t.next_in=W,t.input=O,t.avail_in=M,k.wrap=v,u},s.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,i,s){"use strict";i.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,i,s){"use strict";i.exports=function(r,h){var o,f,x,D,C,E,u,_,l,m,c,g,b,T,R,U,L,Z,P,V,nt,w,$,n,H;o=r.state,f=r.next_in,n=r.input,x=f+(r.avail_in-5),D=r.next_out,H=r.output,C=D-(h-r.avail_out),E=D+(r.avail_out-257),u=o.dmax,_=o.wsize,l=o.whave,m=o.wnext,c=o.window,g=o.hold,b=o.bits,T=o.lencode,R=o.distcode,U=(1<<o.lenbits)-1,L=(1<<o.distbits)-1;t:do{b<15&&(g+=n[f++]<<b,b+=8,g+=n[f++]<<b,b+=8),Z=T[g&U];e:for(;;){if(g>>>=P=Z>>>24,b-=P,(P=Z>>>16&255)===0)H[D++]=65535&Z;else{if(!(16&P)){if((64&P)==0){Z=T[(65535&Z)+(g&(1<<P)-1)];continue e}if(32&P){o.mode=12;break t}r.msg="invalid literal/length code",o.mode=30;break t}V=65535&Z,(P&=15)&&(b<P&&(g+=n[f++]<<b,b+=8),V+=g&(1<<P)-1,g>>>=P,b-=P),b<15&&(g+=n[f++]<<b,b+=8,g+=n[f++]<<b,b+=8),Z=R[g&L];r:for(;;){if(g>>>=P=Z>>>24,b-=P,!(16&(P=Z>>>16&255))){if((64&P)==0){Z=R[(65535&Z)+(g&(1<<P)-1)];continue r}r.msg="invalid distance code",o.mode=30;break t}if(nt=65535&Z,b<(P&=15)&&(g+=n[f++]<<b,(b+=8)<P&&(g+=n[f++]<<b,b+=8)),u<(nt+=g&(1<<P)-1)){r.msg="invalid distance too far back",o.mode=30;break t}if(g>>>=P,b-=P,(P=D-C)<nt){if(l<(P=nt-P)&&o.sane){r.msg="invalid distance too far back",o.mode=30;break t}if($=c,(w=0)===m){if(w+=_-P,P<V){for(V-=P;H[D++]=c[w++],--P;);w=D-nt,$=H}}else if(m<P){if(w+=_+m-P,(P-=m)<V){for(V-=P;H[D++]=c[w++],--P;);if(w=0,m<V){for(V-=P=m;H[D++]=c[w++],--P;);w=D-nt,$=H}}}else if(w+=m-P,P<V){for(V-=P;H[D++]=c[w++],--P;);w=D-nt,$=H}for(;2<V;)H[D++]=$[w++],H[D++]=$[w++],H[D++]=$[w++],V-=3;V&&(H[D++]=$[w++],1<V&&(H[D++]=$[w++]))}else{for(w=D-nt;H[D++]=H[w++],H[D++]=H[w++],H[D++]=H[w++],2<(V-=3););V&&(H[D++]=H[w++],1<V&&(H[D++]=H[w++]))}break}}break}}while(f<x&&D<E);f-=V=b>>3,g&=(1<<(b-=V<<3))-1,r.next_in=f,r.next_out=D,r.avail_in=f<x?x-f+5:5-(f-x),r.avail_out=D<E?E-D+257:257-(D-E),o.hold=g,o.bits=b}},{}],49:[function(e,i,s){"use strict";var r=e("../utils/common"),h=e("./adler32"),o=e("./crc32"),f=e("./inffast"),x=e("./inftrees"),D=1,C=2,E=0,u=-2,_=1,l=852,m=592;function c(w){return(w>>>24&255)+(w>>>8&65280)+((65280&w)<<8)+((255&w)<<24)}function g(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function b(w){var $;return w&&w.state?($=w.state,w.total_in=w.total_out=$.total=0,w.msg="",$.wrap&&(w.adler=1&$.wrap),$.mode=_,$.last=0,$.havedict=0,$.dmax=32768,$.head=null,$.hold=0,$.bits=0,$.lencode=$.lendyn=new r.Buf32(l),$.distcode=$.distdyn=new r.Buf32(m),$.sane=1,$.back=-1,E):u}function T(w){var $;return w&&w.state?(($=w.state).wsize=0,$.whave=0,$.wnext=0,b(w)):u}function R(w,$){var n,H;return w&&w.state?(H=w.state,$<0?(n=0,$=-$):(n=1+($>>4),$<48&&($&=15)),$&&($<8||15<$)?u:(H.window!==null&&H.wbits!==$&&(H.window=null),H.wrap=n,H.wbits=$,T(w))):u}function U(w,$){var n,H;return w?(H=new g,(w.state=H).window=null,(n=R(w,$))!==E&&(w.state=null),n):u}var L,Z,P=!0;function V(w){if(P){var $;for(L=new r.Buf32(512),Z=new r.Buf32(32),$=0;$<144;)w.lens[$++]=8;for(;$<256;)w.lens[$++]=9;for(;$<280;)w.lens[$++]=7;for(;$<288;)w.lens[$++]=8;for(x(D,w.lens,0,288,L,0,w.work,{bits:9}),$=0;$<32;)w.lens[$++]=5;x(C,w.lens,0,32,Z,0,w.work,{bits:5}),P=!1}w.lencode=L,w.lenbits=9,w.distcode=Z,w.distbits=5}function nt(w,$,n,H){var ht,X=w.state;return X.window===null&&(X.wsize=1<<X.wbits,X.wnext=0,X.whave=0,X.window=new r.Buf8(X.wsize)),H>=X.wsize?(r.arraySet(X.window,$,n-X.wsize,X.wsize,0),X.wnext=0,X.whave=X.wsize):(H<(ht=X.wsize-X.wnext)&&(ht=H),r.arraySet(X.window,$,n-H,ht,X.wnext),(H-=ht)?(r.arraySet(X.window,$,n-H,H,0),X.wnext=H,X.whave=X.wsize):(X.wnext+=ht,X.wnext===X.wsize&&(X.wnext=0),X.whave<X.wsize&&(X.whave+=ht))),0}s.inflateReset=T,s.inflateReset2=R,s.inflateResetKeep=b,s.inflateInit=function(w){return U(w,15)},s.inflateInit2=U,s.inflate=function(w,$){var n,H,ht,X,lt,Y,ut,B,z,ot,it,J,wt,kt,dt,y,A,S,et,F,t,p,k,d,a=0,v=new r.Buf8(4),M=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!w||!w.state||!w.output||!w.input&&w.avail_in!==0)return u;(n=w.state).mode===12&&(n.mode=13),lt=w.next_out,ht=w.output,ut=w.avail_out,X=w.next_in,H=w.input,Y=w.avail_in,B=n.hold,z=n.bits,ot=Y,it=ut,p=E;t:for(;;)switch(n.mode){case _:if(n.wrap===0){n.mode=13;break}for(;z<16;){if(Y===0)break t;Y--,B+=H[X++]<<z,z+=8}if(2&n.wrap&&B===35615){v[n.check=0]=255&B,v[1]=B>>>8&255,n.check=o(n.check,v,2,0),z=B=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&B)<<8)+(B>>8))%31){w.msg="incorrect header check",n.mode=30;break}if((15&B)!=8){w.msg="unknown compression method",n.mode=30;break}if(z-=4,t=8+(15&(B>>>=4)),n.wbits===0)n.wbits=t;else if(t>n.wbits){w.msg="invalid window size",n.mode=30;break}n.dmax=1<<t,w.adler=n.check=1,n.mode=512&B?10:12,z=B=0;break;case 2:for(;z<16;){if(Y===0)break t;Y--,B+=H[X++]<<z,z+=8}if(n.flags=B,(255&n.flags)!=8){w.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){w.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=B>>8&1),512&n.flags&&(v[0]=255&B,v[1]=B>>>8&255,n.check=o(n.check,v,2,0)),z=B=0,n.mode=3;case 3:for(;z<32;){if(Y===0)break t;Y--,B+=H[X++]<<z,z+=8}n.head&&(n.head.time=B),512&n.flags&&(v[0]=255&B,v[1]=B>>>8&255,v[2]=B>>>16&255,v[3]=B>>>24&255,n.check=o(n.check,v,4,0)),z=B=0,n.mode=4;case 4:for(;z<16;){if(Y===0)break t;Y--,B+=H[X++]<<z,z+=8}n.head&&(n.head.xflags=255&B,n.head.os=B>>8),512&n.flags&&(v[0]=255&B,v[1]=B>>>8&255,n.check=o(n.check,v,2,0)),z=B=0,n.mode=5;case 5:if(1024&n.flags){for(;z<16;){if(Y===0)break t;Y--,B+=H[X++]<<z,z+=8}n.length=B,n.head&&(n.head.extra_len=B),512&n.flags&&(v[0]=255&B,v[1]=B>>>8&255,n.check=o(n.check,v,2,0)),z=B=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&(Y<(J=n.length)&&(J=Y),J&&(n.head&&(t=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),r.arraySet(n.head.extra,H,X,J,t)),512&n.flags&&(n.check=o(n.check,H,J,X)),Y-=J,X+=J,n.length-=J),n.length))break t;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(Y===0)break t;for(J=0;t=H[X+J++],n.head&&t&&n.length<65536&&(n.head.name+=String.fromCharCode(t)),t&&J<Y;);if(512&n.flags&&(n.check=o(n.check,H,J,X)),Y-=J,X+=J,t)break t}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(Y===0)break t;for(J=0;t=H[X+J++],n.head&&t&&n.length<65536&&(n.head.comment+=String.fromCharCode(t)),t&&J<Y;);if(512&n.flags&&(n.check=o(n.check,H,J,X)),Y-=J,X+=J,t)break t}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;z<16;){if(Y===0)break t;Y--,B+=H[X++]<<z,z+=8}if(B!==(65535&n.check)){w.msg="header crc mismatch",n.mode=30;break}z=B=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),w.adler=n.check=0,n.mode=12;break;case 10:for(;z<32;){if(Y===0)break t;Y--,B+=H[X++]<<z,z+=8}w.adler=n.check=c(B),z=B=0,n.mode=11;case 11:if(n.havedict===0)return w.next_out=lt,w.avail_out=ut,w.next_in=X,w.avail_in=Y,n.hold=B,n.bits=z,2;w.adler=n.check=1,n.mode=12;case 12:if($===5||$===6)break t;case 13:if(n.last){B>>>=7&z,z-=7&z,n.mode=27;break}for(;z<3;){if(Y===0)break t;Y--,B+=H[X++]<<z,z+=8}switch(n.last=1&B,z-=1,3&(B>>>=1)){case 0:n.mode=14;break;case 1:if(V(n),n.mode=20,$!==6)break;B>>>=2,z-=2;break t;case 2:n.mode=17;break;case 3:w.msg="invalid block type",n.mode=30}B>>>=2,z-=2;break;case 14:for(B>>>=7&z,z-=7&z;z<32;){if(Y===0)break t;Y--,B+=H[X++]<<z,z+=8}if((65535&B)!=(B>>>16^65535)){w.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&B,z=B=0,n.mode=15,$===6)break t;case 15:n.mode=16;case 16:if(J=n.length){if(Y<J&&(J=Y),ut<J&&(J=ut),J===0)break t;r.arraySet(ht,H,X,J,lt),Y-=J,X+=J,ut-=J,lt+=J,n.length-=J;break}n.mode=12;break;case 17:for(;z<14;){if(Y===0)break t;Y--,B+=H[X++]<<z,z+=8}if(n.nlen=257+(31&B),B>>>=5,z-=5,n.ndist=1+(31&B),B>>>=5,z-=5,n.ncode=4+(15&B),B>>>=4,z-=4,286<n.nlen||30<n.ndist){w.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;z<3;){if(Y===0)break t;Y--,B+=H[X++]<<z,z+=8}n.lens[M[n.have++]]=7&B,B>>>=3,z-=3}for(;n.have<19;)n.lens[M[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,k={bits:n.lenbits},p=x(0,n.lens,0,19,n.lencode,0,n.work,k),n.lenbits=k.bits,p){w.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;y=(a=n.lencode[B&(1<<n.lenbits)-1])>>>16&255,A=65535&a,!((dt=a>>>24)<=z);){if(Y===0)break t;Y--,B+=H[X++]<<z,z+=8}if(A<16)B>>>=dt,z-=dt,n.lens[n.have++]=A;else{if(A===16){for(d=dt+2;z<d;){if(Y===0)break t;Y--,B+=H[X++]<<z,z+=8}if(B>>>=dt,z-=dt,n.have===0){w.msg="invalid bit length repeat",n.mode=30;break}t=n.lens[n.have-1],J=3+(3&B),B>>>=2,z-=2}else if(A===17){for(d=dt+3;z<d;){if(Y===0)break t;Y--,B+=H[X++]<<z,z+=8}z-=dt,t=0,J=3+(7&(B>>>=dt)),B>>>=3,z-=3}else{for(d=dt+7;z<d;){if(Y===0)break t;Y--,B+=H[X++]<<z,z+=8}z-=dt,t=0,J=11+(127&(B>>>=dt)),B>>>=7,z-=7}if(n.have+J>n.nlen+n.ndist){w.msg="invalid bit length repeat",n.mode=30;break}for(;J--;)n.lens[n.have++]=t}}if(n.mode===30)break;if(n.lens[256]===0){w.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,k={bits:n.lenbits},p=x(D,n.lens,0,n.nlen,n.lencode,0,n.work,k),n.lenbits=k.bits,p){w.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,k={bits:n.distbits},p=x(C,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,k),n.distbits=k.bits,p){w.msg="invalid distances set",n.mode=30;break}if(n.mode=20,$===6)break t;case 20:n.mode=21;case 21:if(6<=Y&&258<=ut){w.next_out=lt,w.avail_out=ut,w.next_in=X,w.avail_in=Y,n.hold=B,n.bits=z,f(w,it),lt=w.next_out,ht=w.output,ut=w.avail_out,X=w.next_in,H=w.input,Y=w.avail_in,B=n.hold,z=n.bits,n.mode===12&&(n.back=-1);break}for(n.back=0;y=(a=n.lencode[B&(1<<n.lenbits)-1])>>>16&255,A=65535&a,!((dt=a>>>24)<=z);){if(Y===0)break t;Y--,B+=H[X++]<<z,z+=8}if(y&&(240&y)==0){for(S=dt,et=y,F=A;y=(a=n.lencode[F+((B&(1<<S+et)-1)>>S)])>>>16&255,A=65535&a,!(S+(dt=a>>>24)<=z);){if(Y===0)break t;Y--,B+=H[X++]<<z,z+=8}B>>>=S,z-=S,n.back+=S}if(B>>>=dt,z-=dt,n.back+=dt,n.length=A,y===0){n.mode=26;break}if(32&y){n.back=-1,n.mode=12;break}if(64&y){w.msg="invalid literal/length code",n.mode=30;break}n.extra=15&y,n.mode=22;case 22:if(n.extra){for(d=n.extra;z<d;){if(Y===0)break t;Y--,B+=H[X++]<<z,z+=8}n.length+=B&(1<<n.extra)-1,B>>>=n.extra,z-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;y=(a=n.distcode[B&(1<<n.distbits)-1])>>>16&255,A=65535&a,!((dt=a>>>24)<=z);){if(Y===0)break t;Y--,B+=H[X++]<<z,z+=8}if((240&y)==0){for(S=dt,et=y,F=A;y=(a=n.distcode[F+((B&(1<<S+et)-1)>>S)])>>>16&255,A=65535&a,!(S+(dt=a>>>24)<=z);){if(Y===0)break t;Y--,B+=H[X++]<<z,z+=8}B>>>=S,z-=S,n.back+=S}if(B>>>=dt,z-=dt,n.back+=dt,64&y){w.msg="invalid distance code",n.mode=30;break}n.offset=A,n.extra=15&y,n.mode=24;case 24:if(n.extra){for(d=n.extra;z<d;){if(Y===0)break t;Y--,B+=H[X++]<<z,z+=8}n.offset+=B&(1<<n.extra)-1,B>>>=n.extra,z-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){w.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(ut===0)break t;if(J=it-ut,n.offset>J){if((J=n.offset-J)>n.whave&&n.sane){w.msg="invalid distance too far back",n.mode=30;break}wt=J>n.wnext?(J-=n.wnext,n.wsize-J):n.wnext-J,J>n.length&&(J=n.length),kt=n.window}else kt=ht,wt=lt-n.offset,J=n.length;for(ut<J&&(J=ut),ut-=J,n.length-=J;ht[lt++]=kt[wt++],--J;);n.length===0&&(n.mode=21);break;case 26:if(ut===0)break t;ht[lt++]=n.length,ut--,n.mode=21;break;case 27:if(n.wrap){for(;z<32;){if(Y===0)break t;Y--,B|=H[X++]<<z,z+=8}if(it-=ut,w.total_out+=it,n.total+=it,it&&(w.adler=n.check=n.flags?o(n.check,ht,it,lt-it):h(n.check,ht,it,lt-it)),it=ut,(n.flags?B:c(B))!==n.check){w.msg="incorrect data check",n.mode=30;break}z=B=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;z<32;){if(Y===0)break t;Y--,B+=H[X++]<<z,z+=8}if(B!==(4294967295&n.total)){w.msg="incorrect length check",n.mode=30;break}z=B=0}n.mode=29;case 29:p=1;break t;case 30:p=-3;break t;case 31:return-4;case 32:default:return u}return w.next_out=lt,w.avail_out=ut,w.next_in=X,w.avail_in=Y,n.hold=B,n.bits=z,(n.wsize||it!==w.avail_out&&n.mode<30&&(n.mode<27||$!==4))&&nt(w,w.output,w.next_out,it-w.avail_out)?(n.mode=31,-4):(ot-=w.avail_in,it-=w.avail_out,w.total_in+=ot,w.total_out+=it,n.total+=it,n.wrap&&it&&(w.adler=n.check=n.flags?o(n.check,ht,it,w.next_out-it):h(n.check,ht,it,w.next_out-it)),w.data_type=n.bits+(n.last?64:0)+(n.mode===12?128:0)+(n.mode===20||n.mode===15?256:0),(ot==0&&it===0||$===4)&&p===E&&(p=-5),p)},s.inflateEnd=function(w){if(!w||!w.state)return u;var $=w.state;return $.window&&($.window=null),w.state=null,E},s.inflateGetHeader=function(w,$){var n;return w&&w.state?(2&(n=w.state).wrap)==0?u:((n.head=$).done=!1,E):u},s.inflateSetDictionary=function(w,$){var n,H=$.length;return w&&w.state?(n=w.state).wrap!==0&&n.mode!==11?u:n.mode===11&&h(1,$,H,0)!==n.check?-3:nt(w,$,H,H)?(n.mode=31,-4):(n.havedict=1,E):u},s.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,i,s){"use strict";var r=e("../utils/common"),h=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],f=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],x=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];i.exports=function(D,C,E,u,_,l,m,c){var g,b,T,R,U,L,Z,P,V,nt=c.bits,w=0,$=0,n=0,H=0,ht=0,X=0,lt=0,Y=0,ut=0,B=0,z=null,ot=0,it=new r.Buf16(16),J=new r.Buf16(16),wt=null,kt=0;for(w=0;w<=15;w++)it[w]=0;for($=0;$<u;$++)it[C[E+$]]++;for(ht=nt,H=15;1<=H&&it[H]===0;H--);if(H<ht&&(ht=H),H===0)return _[l++]=20971520,_[l++]=20971520,c.bits=1,0;for(n=1;n<H&&it[n]===0;n++);for(ht<n&&(ht=n),w=Y=1;w<=15;w++)if(Y<<=1,(Y-=it[w])<0)return-1;if(0<Y&&(D===0||H!==1))return-1;for(J[1]=0,w=1;w<15;w++)J[w+1]=J[w]+it[w];for($=0;$<u;$++)C[E+$]!==0&&(m[J[C[E+$]]++]=$);if(L=D===0?(z=wt=m,19):D===1?(z=h,ot-=257,wt=o,kt-=257,256):(z=f,wt=x,-1),w=n,U=l,lt=$=B=0,T=-1,R=(ut=1<<(X=ht))-1,D===1&&852<ut||D===2&&592<ut)return 1;for(;;){for(Z=w-lt,V=m[$]<L?(P=0,m[$]):m[$]>L?(P=wt[kt+m[$]],z[ot+m[$]]):(P=96,0),g=1<<w-lt,n=b=1<<X;_[U+(B>>lt)+(b-=g)]=Z<<24|P<<16|V|0,b!==0;);for(g=1<<w-1;B&g;)g>>=1;if(g!==0?(B&=g-1,B+=g):B=0,$++,--it[w]==0){if(w===H)break;w=C[E+m[$]]}if(ht<w&&(B&R)!==T){for(lt===0&&(lt=ht),U+=n,Y=1<<(X=w-lt);X+lt<H&&!((Y-=it[X+lt])<=0);)X++,Y<<=1;if(ut+=1<<X,D===1&&852<ut||D===2&&592<ut)return 1;_[T=B&R]=ht<<24|X<<16|U-l|0}}return B!==0&&(_[U+B]=w-lt<<24|64<<16|0),c.bits=ht,0}},{"../utils/common":41}],51:[function(e,i,s){"use strict";i.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,i,s){"use strict";var r=e("../utils/common"),h=0,o=1;function f(a){for(var v=a.length;0<=--v;)a[v]=0}var x=0,D=29,C=256,E=C+1+D,u=30,_=19,l=2*E+1,m=15,c=16,g=7,b=256,T=16,R=17,U=18,L=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Z=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],P=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],nt=new Array(2*(E+2));f(nt);var w=new Array(2*u);f(w);var $=new Array(512);f($);var n=new Array(256);f(n);var H=new Array(D);f(H);var ht,X,lt,Y=new Array(u);function ut(a,v,M,W,O){this.static_tree=a,this.extra_bits=v,this.extra_base=M,this.elems=W,this.max_length=O,this.has_stree=a&&a.length}function B(a,v){this.dyn_tree=a,this.max_code=0,this.stat_desc=v}function z(a){return a<256?$[a]:$[256+(a>>>7)]}function ot(a,v){a.pending_buf[a.pending++]=255&v,a.pending_buf[a.pending++]=v>>>8&255}function it(a,v,M){a.bi_valid>c-M?(a.bi_buf|=v<<a.bi_valid&65535,ot(a,a.bi_buf),a.bi_buf=v>>c-a.bi_valid,a.bi_valid+=M-c):(a.bi_buf|=v<<a.bi_valid&65535,a.bi_valid+=M)}function J(a,v,M){it(a,M[2*v],M[2*v+1])}function wt(a,v){for(var M=0;M|=1&a,a>>>=1,M<<=1,0<--v;);return M>>>1}function kt(a,v,M){var W,O,Q=new Array(m+1),tt=0;for(W=1;W<=m;W++)Q[W]=tt=tt+M[W-1]<<1;for(O=0;O<=v;O++){var j=a[2*O+1];j!==0&&(a[2*O]=wt(Q[j]++,j))}}function dt(a){var v;for(v=0;v<E;v++)a.dyn_ltree[2*v]=0;for(v=0;v<u;v++)a.dyn_dtree[2*v]=0;for(v=0;v<_;v++)a.bl_tree[2*v]=0;a.dyn_ltree[2*b]=1,a.opt_len=a.static_len=0,a.last_lit=a.matches=0}function y(a){8<a.bi_valid?ot(a,a.bi_buf):0<a.bi_valid&&(a.pending_buf[a.pending++]=a.bi_buf),a.bi_buf=0,a.bi_valid=0}function A(a,v,M,W){var O=2*v,Q=2*M;return a[O]<a[Q]||a[O]===a[Q]&&W[v]<=W[M]}function S(a,v,M){for(var W=a.heap[M],O=M<<1;O<=a.heap_len&&(O<a.heap_len&&A(v,a.heap[O+1],a.heap[O],a.depth)&&O++,!A(v,W,a.heap[O],a.depth));)a.heap[M]=a.heap[O],M=O,O<<=1;a.heap[M]=W}function et(a,v,M){var W,O,Q,tt,j=0;if(a.last_lit!==0)for(;W=a.pending_buf[a.d_buf+2*j]<<8|a.pending_buf[a.d_buf+2*j+1],O=a.pending_buf[a.l_buf+j],j++,W===0?J(a,O,v):(J(a,(Q=n[O])+C+1,v),(tt=L[Q])!==0&&it(a,O-=H[Q],tt),J(a,Q=z(--W),M),(tt=Z[Q])!==0&&it(a,W-=Y[Q],tt)),j<a.last_lit;);J(a,b,v)}function F(a,v){var M,W,O,Q=v.dyn_tree,tt=v.stat_desc.static_tree,j=v.stat_desc.has_stree,st=v.stat_desc.elems,mt=-1;for(a.heap_len=0,a.heap_max=l,M=0;M<st;M++)Q[2*M]!==0?(a.heap[++a.heap_len]=mt=M,a.depth[M]=0):Q[2*M+1]=0;for(;a.heap_len<2;)Q[2*(O=a.heap[++a.heap_len]=mt<2?++mt:0)]=1,a.depth[O]=0,a.opt_len--,j&&(a.static_len-=tt[2*O+1]);for(v.max_code=mt,M=a.heap_len>>1;1<=M;M--)S(a,Q,M);for(O=st;M=a.heap[1],a.heap[1]=a.heap[a.heap_len--],S(a,Q,1),W=a.heap[1],a.heap[--a.heap_max]=M,a.heap[--a.heap_max]=W,Q[2*O]=Q[2*M]+Q[2*W],a.depth[O]=(a.depth[M]>=a.depth[W]?a.depth[M]:a.depth[W])+1,Q[2*M+1]=Q[2*W+1]=O,a.heap[1]=O++,S(a,Q,1),2<=a.heap_len;);a.heap[--a.heap_max]=a.heap[1],function(ft,at){var K,N,I,rt,G,q,ct=at.dyn_tree,gt=at.max_code,vt=at.stat_desc.static_tree,yt=at.stat_desc.has_stree,pt=at.stat_desc.extra_bits,It=at.stat_desc.extra_base,Ot=at.stat_desc.max_length,Nt=0;for(rt=0;rt<=m;rt++)ft.bl_count[rt]=0;for(ct[2*ft.heap[ft.heap_max]+1]=0,K=ft.heap_max+1;K<l;K++)Ot<(rt=ct[2*ct[2*(N=ft.heap[K])+1]+1]+1)&&(rt=Ot,Nt++),ct[2*N+1]=rt,gt<N||(ft.bl_count[rt]++,G=0,It<=N&&(G=pt[N-It]),q=ct[2*N],ft.opt_len+=q*(rt+G),yt&&(ft.static_len+=q*(vt[2*N+1]+G)));if(Nt!==0){do{for(rt=Ot-1;ft.bl_count[rt]===0;)rt--;ft.bl_count[rt]--,ft.bl_count[rt+1]+=2,ft.bl_count[Ot]--,Nt-=2}while(0<Nt);for(rt=Ot;rt!==0;rt--)for(N=ft.bl_count[rt];N!==0;)gt<(I=ft.heap[--K])||(ct[2*I+1]!==rt&&(ft.opt_len+=(rt-ct[2*I+1])*ct[2*I],ct[2*I+1]=rt),N--)}}(a,v),kt(Q,mt,a.bl_count)}function t(a,v,M){var W,O,Q=-1,tt=v[1],j=0,st=7,mt=4;for(tt===0&&(st=138,mt=3),v[2*(M+1)+1]=65535,W=0;W<=M;W++)O=tt,tt=v[2*(W+1)+1],++j<st&&O===tt||(j<mt?a.bl_tree[2*O]+=j:O!==0?(O!==Q&&a.bl_tree[2*O]++,a.bl_tree[2*T]++):j<=10?a.bl_tree[2*R]++:a.bl_tree[2*U]++,Q=O,mt=(j=0)===tt?(st=138,3):O===tt?(st=6,3):(st=7,4))}function p(a,v,M){var W,O,Q=-1,tt=v[1],j=0,st=7,mt=4;for(tt===0&&(st=138,mt=3),W=0;W<=M;W++)if(O=tt,tt=v[2*(W+1)+1],!(++j<st&&O===tt)){if(j<mt)for(;J(a,O,a.bl_tree),--j!=0;);else O!==0?(O!==Q&&(J(a,O,a.bl_tree),j--),J(a,T,a.bl_tree),it(a,j-3,2)):j<=10?(J(a,R,a.bl_tree),it(a,j-3,3)):(J(a,U,a.bl_tree),it(a,j-11,7));Q=O,mt=(j=0)===tt?(st=138,3):O===tt?(st=6,3):(st=7,4)}}f(Y);var k=!1;function d(a,v,M,W){it(a,(x<<1)+(W?1:0),3),function(O,Q,tt,j){y(O),j&&(ot(O,tt),ot(O,~tt)),r.arraySet(O.pending_buf,O.window,Q,tt,O.pending),O.pending+=tt}(a,v,M,!0)}s._tr_init=function(a){k||(function(){var v,M,W,O,Q,tt=new Array(m+1);for(O=W=0;O<D-1;O++)for(H[O]=W,v=0;v<1<<L[O];v++)n[W++]=O;for(n[W-1]=O,O=Q=0;O<16;O++)for(Y[O]=Q,v=0;v<1<<Z[O];v++)$[Q++]=O;for(Q>>=7;O<u;O++)for(Y[O]=Q<<7,v=0;v<1<<Z[O]-7;v++)$[256+Q++]=O;for(M=0;M<=m;M++)tt[M]=0;for(v=0;v<=143;)nt[2*v+1]=8,v++,tt[8]++;for(;v<=255;)nt[2*v+1]=9,v++,tt[9]++;for(;v<=279;)nt[2*v+1]=7,v++,tt[7]++;for(;v<=287;)nt[2*v+1]=8,v++,tt[8]++;for(kt(nt,E+1,tt),v=0;v<u;v++)w[2*v+1]=5,w[2*v]=wt(v,5);ht=new ut(nt,L,C+1,E,m),X=new ut(w,Z,0,u,m),lt=new ut(new Array(0),P,0,_,g)}(),k=!0),a.l_desc=new B(a.dyn_ltree,ht),a.d_desc=new B(a.dyn_dtree,X),a.bl_desc=new B(a.bl_tree,lt),a.bi_buf=0,a.bi_valid=0,dt(a)},s._tr_stored_block=d,s._tr_flush_block=function(a,v,M,W){var O,Q,tt=0;0<a.level?(a.strm.data_type===2&&(a.strm.data_type=function(j){var st,mt=4093624447;for(st=0;st<=31;st++,mt>>>=1)if(1&mt&&j.dyn_ltree[2*st]!==0)return h;if(j.dyn_ltree[18]!==0||j.dyn_ltree[20]!==0||j.dyn_ltree[26]!==0)return o;for(st=32;st<C;st++)if(j.dyn_ltree[2*st]!==0)return o;return h}(a)),F(a,a.l_desc),F(a,a.d_desc),tt=function(j){var st;for(t(j,j.dyn_ltree,j.l_desc.max_code),t(j,j.dyn_dtree,j.d_desc.max_code),F(j,j.bl_desc),st=_-1;3<=st&&j.bl_tree[2*V[st]+1]===0;st--);return j.opt_len+=3*(st+1)+5+5+4,st}(a),O=a.opt_len+3+7>>>3,(Q=a.static_len+3+7>>>3)<=O&&(O=Q)):O=Q=M+5,M+4<=O&&v!==-1?d(a,v,M,W):a.strategy===4||Q===O?(it(a,2+(W?1:0),3),et(a,nt,w)):(it(a,4+(W?1:0),3),function(j,st,mt,ft){var at;for(it(j,st-257,5),it(j,mt-1,5),it(j,ft-4,4),at=0;at<ft;at++)it(j,j.bl_tree[2*V[at]+1],3);p(j,j.dyn_ltree,st-1),p(j,j.dyn_dtree,mt-1)}(a,a.l_desc.max_code+1,a.d_desc.max_code+1,tt+1),et(a,a.dyn_ltree,a.dyn_dtree)),dt(a),W&&y(a)},s._tr_tally=function(a,v,M){return a.pending_buf[a.d_buf+2*a.last_lit]=v>>>8&255,a.pending_buf[a.d_buf+2*a.last_lit+1]=255&v,a.pending_buf[a.l_buf+a.last_lit]=255&M,a.last_lit++,v===0?a.dyn_ltree[2*M]++:(a.matches++,v--,a.dyn_ltree[2*(n[M]+C+1)]++,a.dyn_dtree[2*z(v)]++),a.last_lit===a.lit_bufsize-1},s._tr_align=function(a){it(a,2,3),J(a,b,nt),function(v){v.bi_valid===16?(ot(v,v.bi_buf),v.bi_buf=0,v.bi_valid=0):8<=v.bi_valid&&(v.pending_buf[v.pending++]=255&v.bi_buf,v.bi_buf>>=8,v.bi_valid-=8)}(a)}},{"../utils/common":41}],53:[function(e,i,s){"use strict";i.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,i,s){(function(r){(function(h,o){"use strict";if(!h.setImmediate){var f,x,D,C,E=1,u={},_=!1,l=h.document,m=Object.getPrototypeOf&&Object.getPrototypeOf(h);m=m&&m.setTimeout?m:h,f={}.toString.call(h.process)==="[object process]"?function(T){process.nextTick(function(){g(T)})}:function(){if(h.postMessage&&!h.importScripts){var T=!0,R=h.onmessage;return h.onmessage=function(){T=!1},h.postMessage("","*"),h.onmessage=R,T}}()?(C="setImmediate$"+Math.random()+"$",h.addEventListener?h.addEventListener("message",b,!1):h.attachEvent("onmessage",b),function(T){h.postMessage(C+T,"*")}):h.MessageChannel?((D=new MessageChannel).port1.onmessage=function(T){g(T.data)},function(T){D.port2.postMessage(T)}):l&&"onreadystatechange"in l.createElement("script")?(x=l.documentElement,function(T){var R=l.createElement("script");R.onreadystatechange=function(){g(T),R.onreadystatechange=null,x.removeChild(R),R=null},x.appendChild(R)}):function(T){setTimeout(g,0,T)},m.setImmediate=function(T){typeof T!="function"&&(T=new Function(""+T));for(var R=new Array(arguments.length-1),U=0;U<R.length;U++)R[U]=arguments[U+1];var L={callback:T,args:R};return u[E]=L,f(E),E++},m.clearImmediate=c}function c(T){delete u[T]}function g(T){if(_)setTimeout(g,0,T);else{var R=u[T];if(R){_=!0;try{(function(U){var L=U.callback,Z=U.args;switch(Z.length){case 0:L();break;case 1:L(Z[0]);break;case 2:L(Z[0],Z[1]);break;case 3:L(Z[0],Z[1],Z[2]);break;default:L.apply(o,Z)}})(R)}finally{c(T),_=!1}}}}function b(T){T.source===h&&typeof T.data=="string"&&T.data.indexOf(C)===0&&g(+T.data.slice(C.length))}})(typeof self>"u"?r===void 0?this:r:self)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})});var Oe=Pt(bt=>{"use strict";Object.defineProperty(bt,"__esModule",{value:!0});bt.CHAR=`	
\r -\uD7FF\uE000-\uFFFD\u{10000}-\u{10FFFF}`;bt.S=` 	\r
`;bt.NAME_START_CHAR=":A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u{10000}-\u{EFFFF}";bt.NAME_CHAR="-"+bt.NAME_START_CHAR+".0-9\xB7\u0300-\u036F\u203F-\u2040";bt.CHAR_RE=new RegExp("^["+bt.CHAR+"]$","u");bt.S_RE=new RegExp("^["+bt.S+"]+$","u");bt.NAME_START_CHAR_RE=new RegExp("^["+bt.NAME_START_CHAR+"]$","u");bt.NAME_CHAR_RE=new RegExp("^["+bt.NAME_CHAR+"]$","u");bt.NAME_RE=new RegExp("^["+bt.NAME_START_CHAR+"]["+bt.NAME_CHAR+"]*$","u");bt.NMTOKEN_RE=new RegExp("^["+bt.NAME_CHAR+"]+$","u");var oe=9,he=10,le=13,ue=32;bt.S_LIST=[ue,he,le,oe];function br(e){return e>=ue&&e<=55295||e===he||e===le||e===oe||e>=57344&&e<=65533||e>=65536&&e<=1114111}bt.isChar=br;function xr(e){return e===ue||e===he||e===le||e===oe}bt.isS=xr;function Re(e){return e>=65&&e<=90||e>=97&&e<=122||e===58||e===95||e===8204||e===8205||e>=192&&e<=214||e>=216&&e<=246||e>=248&&e<=767||e>=880&&e<=893||e>=895&&e<=8191||e>=8304&&e<=8591||e>=11264&&e<=12271||e>=12289&&e<=55295||e>=63744&&e<=64975||e>=65008&&e<=65533||e>=65536&&e<=983039}bt.isNameStartChar=Re;function wr(e){return Re(e)||e>=48&&e<=57||e===45||e===46||e===183||e>=768&&e<=879||e>=8255&&e<=8256}bt.isNameChar=wr});var Le=Pt(_t=>{"use strict";Object.defineProperty(_t,"__esModule",{value:!0});_t.CHAR="-\uD7FF\uE000-\uFFFD\u{10000}-\u{10FFFF}";_t.RESTRICTED_CHAR="-\b\v\f-\x7F-\x84\x86-\x9F";_t.S=` 	\r
`;_t.NAME_START_CHAR=":A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u{10000}-\u{EFFFF}";_t.NAME_CHAR="-"+_t.NAME_START_CHAR+".0-9\xB7\u0300-\u036F\u203F-\u2040";_t.CHAR_RE=new RegExp("^["+_t.CHAR+"]$","u");_t.RESTRICTED_CHAR_RE=new RegExp("^["+_t.RESTRICTED_CHAR+"]$","u");_t.S_RE=new RegExp("^["+_t.S+"]+$","u");_t.NAME_START_CHAR_RE=new RegExp("^["+_t.NAME_START_CHAR+"]$","u");_t.NAME_CHAR_RE=new RegExp("^["+_t.NAME_CHAR+"]$","u");_t.NAME_RE=new RegExp("^["+_t.NAME_START_CHAR+"]["+_t.NAME_CHAR+"]*$","u");_t.NMTOKEN_RE=new RegExp("^["+_t.NAME_CHAR+"]+$","u");var Ie=9,ze=10,Me=13,Be=32;_t.S_LIST=[Be,ze,Me,Ie];function vr(e){return e>=1&&e<=55295||e>=57344&&e<=65533||e>=65536&&e<=1114111}_t.isChar=vr;function yr(e){return e>=1&&e<=8||e===11||e===12||e>=14&&e<=31||e>=127&&e<=132||e>=134&&e<=159}_t.isRestrictedChar=yr;function kr(e){return e===9||e===10||e===13||e>31&&e<127||e===133||e>159&&e<=55295||e>=57344&&e<=65533||e>=65536&&e<=1114111}_t.isCharAndNotRestricted=kr;function Cr(e){return e===Be||e===ze||e===Me||e===Ie}_t.isS=Cr;function Pe(e){return e>=65&&e<=90||e>=97&&e<=122||e===58||e===95||e===8204||e===8205||e>=192&&e<=214||e>=216&&e<=246||e>=248&&e<=767||e>=880&&e<=893||e>=895&&e<=8191||e>=8304&&e<=8591||e>=11264&&e<=12271||e>=12289&&e<=55295||e>=63744&&e<=64975||e>=65008&&e<=65533||e>=65536&&e<=983039}_t.isNameStartChar=Pe;function Er(e){return Pe(e)||e>=48&&e<=57||e===45||e===46||e===183||e>=768&&e<=879||e>=8255&&e<=8256}_t.isNameChar=Er});var $e=Pt(St=>{"use strict";Object.defineProperty(St,"__esModule",{value:!0});St.NC_NAME_START_CHAR="A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u{10000}-\u{EFFFF}";St.NC_NAME_CHAR="-"+St.NC_NAME_START_CHAR+".0-9\xB7\u0300-\u036F\u203F-\u2040";St.NC_NAME_START_CHAR_RE=new RegExp("^["+St.NC_NAME_START_CHAR+"]$","u");St.NC_NAME_CHAR_RE=new RegExp("^["+St.NC_NAME_CHAR+"]$","u");St.NC_NAME_RE=new RegExp("^["+St.NC_NAME_START_CHAR+"]["+St.NC_NAME_CHAR+"]*$","u");function Ue(e){return e>=65&&e<=90||e===95||e>=97&&e<=122||e>=192&&e<=214||e>=216&&e<=246||e>=248&&e<=767||e>=880&&e<=893||e>=895&&e<=8191||e>=8204&&e<=8205||e>=8304&&e<=8591||e>=11264&&e<=12271||e>=12289&&e<=55295||e>=63744&&e<=64975||e>=65008&&e<=65533||e>=65536&&e<=983039}St.isNCNameStartChar=Ue;function Ar(e){return Ue(e)||e===45||e===46||e>=48&&e<=57||e===183||e>=768&&e<=879||e>=8255&&e<=8256}St.isNCNameChar=Ar});var or=Pt(jt=>{"use strict";Object.defineProperty(jt,"__esModule",{value:!0});jt.SaxesParser=jt.EVENTS=void 0;var Zt=Oe(),Sr=Le(),Ce=$e(),Dt=Zt.isS,Dr=Zt.isChar,qt=Zt.isNameStartChar,He=Zt.isNameChar,rr=Zt.S_LIST,Tr=Zt.NAME_RE,Fr=Sr.isChar,Nr=Ce.isNCNameStartChar,Rr=Ce.isNCNameChar,Or=Ce.NC_NAME_RE,ne="http://www.w3.org/XML/1998/namespace",Wt="http://www.w3.org/2000/xmlns/",Ir={__proto__:null,xml:ne,xmlns:Wt},zr={__proto__:null,amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},xt=-1,Rt=-2,We=0,Mr=1,ce=2,Br=3,Ut=4,Pr=5,Lr=6,Ur=7,fe=8,$r=9,Hr=10,Wr=11,jr=12,At=13,Jt=14,de=15,Zr=16,pe=17,Xr=18,Gr=19,me=20,Vr=21,qr=22,Kr=23,je=24,_e=25,te=26,Ze=27,Yr=28,Qr=29,Xe=30,Jr=31,ti=32,Mt=33,ei=34,ge=35,Kt=36,be=37,ri=38,Ge=39,Ve=40,ii=41,qe=42,ni=43,si=44,xe=9,Ft=10,we=13,Ke=32,Ye=33,ir=34,Yt=38,nr=39,ee=45,re=47,ai=59,zt=60,$t=61,Ct=62,Et=63,sr=91,Ht=93,Qe=133,Je=8232,ie=e=>e===ir||e===nr,ar=[ir,nr],oi=[...ar,sr,Ct],hi=[...ar,zt,Ht],li=[$t,Et,...rr],ui=[...rr,Ct,Yt,zt];function ye(e,i,s){switch(i){case"xml":s!==ne&&e.fail(`xml prefix must be bound to ${ne}.`);break;case"xmlns":s!==Wt&&e.fail(`xmlns prefix must be bound to ${Wt}.`);break;default:}switch(s){case Wt:e.fail(i===""?`the default namespace may not be set to ${s}.`:`may not assign a prefix (even "xmlns") to the URI ${Wt}.`);break;case ne:switch(i){case"xml":break;case"":e.fail(`the default namespace may not be set to ${s}.`);break;default:e.fail("may not assign the xml namespace to another prefix.")}break;default:}}function ci(e,i){for(let s of Object.keys(i))ye(e,s,i[s])}var fi=e=>Or.test(e),di=e=>Tr.test(e),Bt=0,tr=1,ve=2;jt.EVENTS=["xmldecl","text","processinginstruction","doctype","comment","opentagstart","attribute","opentag","closetag","cdata","error","end","ready"];var er={xmldecl:"xmldeclHandler",text:"textHandler",processinginstruction:"piHandler",doctype:"doctypeHandler",comment:"commentHandler",opentagstart:"openTagStartHandler",attribute:"attributeHandler",opentag:"openTagHandler",closetag:"closeTagHandler",cdata:"cdataHandler",error:"errorHandler",end:"endHandler",ready:"readyHandler"},ke=class{constructor(i){this.opt=i??{},this.fragmentOpt=!!this.opt.fragment;let s=this.xmlnsOpt=!!this.opt.xmlns;if(this.trackPosition=this.opt.position!==!1,this.fileName=this.opt.fileName,s){this.nameStartCheck=Nr,this.nameCheck=Rr,this.isName=fi,this.processAttribs=this.processAttribsNS,this.pushAttrib=this.pushAttribNS,this.ns=Object.assign({__proto__:null},Ir);let r=this.opt.additionalNamespaces;r!=null&&(ci(this,r),Object.assign(this.ns,r))}else this.nameStartCheck=qt,this.nameCheck=He,this.isName=di,this.processAttribs=this.processAttribsPlain,this.pushAttrib=this.pushAttribPlain;this.stateTable=[this.sBegin,this.sBeginWhitespace,this.sDoctype,this.sDoctypeQuote,this.sDTD,this.sDTDQuoted,this.sDTDOpenWaka,this.sDTDOpenWakaBang,this.sDTDComment,this.sDTDCommentEnding,this.sDTDCommentEnded,this.sDTDPI,this.sDTDPIEnding,this.sText,this.sEntity,this.sOpenWaka,this.sOpenWakaBang,this.sComment,this.sCommentEnding,this.sCommentEnded,this.sCData,this.sCDataEnding,this.sCDataEnding2,this.sPIFirstChar,this.sPIRest,this.sPIBody,this.sPIEnding,this.sXMLDeclNameStart,this.sXMLDeclName,this.sXMLDeclEq,this.sXMLDeclValueStart,this.sXMLDeclValue,this.sXMLDeclSeparator,this.sXMLDeclEnding,this.sOpenTag,this.sOpenTagSlash,this.sAttrib,this.sAttribName,this.sAttribNameSawWhite,this.sAttribValue,this.sAttribValueQuoted,this.sAttribValueClosed,this.sAttribValueUnquoted,this.sCloseTag,this.sCloseTagSawWhite],this._init()}get closed(){return this._closed}_init(){var i;this.openWakaBang="",this.text="",this.name="",this.piTarget="",this.entity="",this.q=null,this.tags=[],this.tag=null,this.topNS=null,this.chunk="",this.chunkPosition=0,this.i=0,this.prevI=0,this.carriedFromPrevious=void 0,this.forbiddenState=Bt,this.attribList=[];let{fragmentOpt:s}=this;this.state=s?At:We,this.reportedTextBeforeRoot=this.reportedTextAfterRoot=this.closedRoot=this.sawRoot=s,this.xmlDeclPossible=!s,this.xmlDeclExpects=["version"],this.entityReturnState=void 0;let{defaultXMLVersion:r}=this.opt;if(r===void 0){if(this.opt.forceXMLVersion===!0)throw new Error("forceXMLVersion set but defaultXMLVersion is not set");r="1.0"}this.setXMLVersion(r),this.positionAtNewLine=0,this.doctype=!1,this._closed=!1,this.xmlDecl={version:void 0,encoding:void 0,standalone:void 0},this.line=1,this.column=0,this.ENTITIES=Object.create(zr),(i=this.readyHandler)===null||i===void 0||i.call(this)}get position(){return this.chunkPosition+this.i}get columnIndex(){return this.position-this.positionAtNewLine}on(i,s){this[er[i]]=s}off(i){this[er[i]]=void 0}makeError(i){var s;let r=(s=this.fileName)!==null&&s!==void 0?s:"";return this.trackPosition&&(r.length>0&&(r+=":"),r+=`${this.line}:${this.column}`),r.length>0&&(r+=": "),new Error(r+i)}fail(i){let s=this.makeError(i),r=this.errorHandler;if(r===void 0)throw s;return r(s),this}write(i){if(this.closed)return this.fail("cannot write after close; assign an onready handler.");let s=!1;i===null?(s=!0,i=""):typeof i=="object"&&(i=i.toString()),this.carriedFromPrevious!==void 0&&(i=`${this.carriedFromPrevious}${i}`,this.carriedFromPrevious=void 0);let r=i.length,h=i.charCodeAt(r-1);!s&&(h===we||h>=55296&&h<=56319)&&(this.carriedFromPrevious=i[r-1],r--,i=i.slice(0,r));let{stateTable:o}=this;for(this.chunk=i,this.i=0;this.i<r;)o[this.state].call(this);return this.chunkPosition+=r,s?this.end():this}close(){return this.write(null)}getCode10(){let{chunk:i,i:s}=this;if(this.prevI=s,this.i=s+1,s>=i.length)return xt;let r=i.charCodeAt(s);if(this.column++,r<55296){if(r>=Ke||r===xe)return r;switch(r){case Ft:return this.line++,this.column=0,this.positionAtNewLine=this.position,Ft;case we:return i.charCodeAt(s+1)===Ft&&(this.i=s+2),this.line++,this.column=0,this.positionAtNewLine=this.position,Rt;default:return this.fail("disallowed character."),r}}if(r>56319)return r>=57344&&r<=65533||this.fail("disallowed character."),r;let h=65536+(r-55296)*1024+(i.charCodeAt(s+1)-56320);return this.i=s+2,h>1114111&&this.fail("disallowed character."),h}getCode11(){let{chunk:i,i:s}=this;if(this.prevI=s,this.i=s+1,s>=i.length)return xt;let r=i.charCodeAt(s);if(this.column++,r<55296){if(r>31&&r<127||r>159&&r!==Je||r===xe)return r;switch(r){case Ft:return this.line++,this.column=0,this.positionAtNewLine=this.position,Ft;case we:{let o=i.charCodeAt(s+1);(o===Ft||o===Qe)&&(this.i=s+2)}case Qe:case Je:return this.line++,this.column=0,this.positionAtNewLine=this.position,Rt;default:return this.fail("disallowed character."),r}}if(r>56319)return r>=57344&&r<=65533||this.fail("disallowed character."),r;let h=65536+(r-55296)*1024+(i.charCodeAt(s+1)-56320);return this.i=s+2,h>1114111&&this.fail("disallowed character."),h}getCodeNorm(){let i=this.getCode();return i===Rt?Ft:i}unget(){this.i=this.prevI,this.column--}captureTo(i){let{i:s}=this,{chunk:r}=this;for(;;){let h=this.getCode(),o=h===Rt,f=o?Ft:h;if(f===xt||i.includes(f))return this.text+=r.slice(s,this.prevI),f;o&&(this.text+=`${r.slice(s,this.prevI)}
`,s=this.i)}}captureToChar(i){let{i:s}=this,{chunk:r}=this;for(;;){let h=this.getCode();switch(h){case Rt:this.text+=`${r.slice(s,this.prevI)}
`,s=this.i,h=Ft;break;case xt:return this.text+=r.slice(s),!1;default:}if(h===i)return this.text+=r.slice(s,this.prevI),!0}}captureNameChars(){let{chunk:i,i:s}=this;for(;;){let r=this.getCode();if(r===xt)return this.name+=i.slice(s),xt;if(!He(r))return this.name+=i.slice(s,this.prevI),r===Rt?Ft:r}}skipSpaces(){for(;;){let i=this.getCodeNorm();if(i===xt||!Dt(i))return i}}setXMLVersion(i){this.currentXMLVersion=i,i==="1.0"?(this.isChar=Dr,this.getCode=this.getCode10):(this.isChar=Fr,this.getCode=this.getCode11)}sBegin(){this.chunk.charCodeAt(0)===65279&&(this.i++,this.column++),this.state=Mr}sBeginWhitespace(){let i=this.i,s=this.skipSpaces();switch(this.prevI!==i&&(this.xmlDeclPossible=!1),s){case zt:if(this.state=de,this.text.length!==0)throw new Error("no-empty text at start");break;case xt:break;default:this.unget(),this.state=At,this.xmlDeclPossible=!1}}sDoctype(){var i;let s=this.captureTo(oi);switch(s){case Ct:{(i=this.doctypeHandler)===null||i===void 0||i.call(this,this.text),this.text="",this.state=At,this.doctype=!0;break}case xt:break;default:this.text+=String.fromCodePoint(s),s===sr?this.state=Ut:ie(s)&&(this.state=Br,this.q=s)}}sDoctypeQuote(){let i=this.q;this.captureToChar(i)&&(this.text+=String.fromCodePoint(i),this.q=null,this.state=ce)}sDTD(){let i=this.captureTo(hi);i!==xt&&(this.text+=String.fromCodePoint(i),i===Ht?this.state=ce:i===zt?this.state=Lr:ie(i)&&(this.state=Pr,this.q=i))}sDTDQuoted(){let i=this.q;this.captureToChar(i)&&(this.text+=String.fromCodePoint(i),this.state=Ut,this.q=null)}sDTDOpenWaka(){let i=this.getCodeNorm();switch(this.text+=String.fromCodePoint(i),i){case Ye:this.state=Ur,this.openWakaBang="";break;case Et:this.state=Wr;break;default:this.state=Ut}}sDTDOpenWakaBang(){let i=String.fromCodePoint(this.getCodeNorm()),s=this.openWakaBang+=i;this.text+=i,s!=="-"&&(this.state=s==="--"?fe:Ut,this.openWakaBang="")}sDTDComment(){this.captureToChar(ee)&&(this.text+="-",this.state=$r)}sDTDCommentEnding(){let i=this.getCodeNorm();this.text+=String.fromCodePoint(i),this.state=i===ee?Hr:fe}sDTDCommentEnded(){let i=this.getCodeNorm();this.text+=String.fromCodePoint(i),i===Ct?this.state=Ut:(this.fail("malformed comment."),this.state=fe)}sDTDPI(){this.captureToChar(Et)&&(this.text+="?",this.state=jr)}sDTDPIEnding(){let i=this.getCodeNorm();this.text+=String.fromCodePoint(i),i===Ct&&(this.state=Ut)}sText(){this.tags.length!==0?this.handleTextInRoot():this.handleTextOutsideRoot()}sEntity(){let{i}=this,{chunk:s}=this;t:for(;;)switch(this.getCode()){case Rt:this.entity+=`${s.slice(i,this.prevI)}
`,i=this.i;break;case ai:{let{entityReturnState:r}=this,h=this.entity+s.slice(i,this.prevI);this.state=r;let o;h===""?(this.fail("empty entity name."),o="&;"):(o=this.parseEntity(h),this.entity=""),(r!==At||this.textHandler!==void 0)&&(this.text+=o);break t}case xt:this.entity+=s.slice(i);break t;default:}}sOpenWaka(){let i=this.getCode();if(qt(i))this.state=ei,this.unget(),this.xmlDeclPossible=!1;else switch(i){case re:this.state=ni,this.xmlDeclPossible=!1;break;case Ye:this.state=Zr,this.openWakaBang="",this.xmlDeclPossible=!1;break;case Et:this.state=Kr;break;default:this.fail("disallowed character in tag name"),this.state=At,this.xmlDeclPossible=!1}}sOpenWakaBang(){switch(this.openWakaBang+=String.fromCodePoint(this.getCodeNorm()),this.openWakaBang){case"[CDATA[":!this.sawRoot&&!this.reportedTextBeforeRoot&&(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0),this.state=me,this.openWakaBang="";break;case"--":this.state=pe,this.openWakaBang="";break;case"DOCTYPE":this.state=ce,(this.doctype||this.sawRoot)&&this.fail("inappropriately located doctype declaration."),this.openWakaBang="";break;default:this.openWakaBang.length>=7&&this.fail("incorrect syntax.")}}sComment(){this.captureToChar(ee)&&(this.state=Xr)}sCommentEnding(){var i;let s=this.getCodeNorm();s===ee?(this.state=Gr,(i=this.commentHandler)===null||i===void 0||i.call(this,this.text),this.text=""):(this.text+=`-${String.fromCodePoint(s)}`,this.state=pe)}sCommentEnded(){let i=this.getCodeNorm();i!==Ct?(this.fail("malformed comment."),this.text+=`--${String.fromCodePoint(i)}`,this.state=pe):this.state=At}sCData(){this.captureToChar(Ht)&&(this.state=Vr)}sCDataEnding(){let i=this.getCodeNorm();i===Ht?this.state=qr:(this.text+=`]${String.fromCodePoint(i)}`,this.state=me)}sCDataEnding2(){var i;let s=this.getCodeNorm();switch(s){case Ct:{(i=this.cdataHandler)===null||i===void 0||i.call(this,this.text),this.text="",this.state=At;break}case Ht:this.text+="]";break;default:this.text+=`]]${String.fromCodePoint(s)}`,this.state=me}}sPIFirstChar(){let i=this.getCodeNorm();this.nameStartCheck(i)?(this.piTarget+=String.fromCodePoint(i),this.state=je):i===Et||Dt(i)?(this.fail("processing instruction without a target."),this.state=i===Et?te:_e):(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(i),this.state=je)}sPIRest(){let{chunk:i,i:s}=this;for(;;){let r=this.getCodeNorm();if(r===xt){this.piTarget+=i.slice(s);return}if(!this.nameCheck(r)){this.piTarget+=i.slice(s,this.prevI);let h=r===Et;h||Dt(r)?this.piTarget==="xml"?(this.xmlDeclPossible||this.fail("an XML declaration must be at the start of the document."),this.state=h?Mt:Ze):this.state=h?te:_e:(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(r));break}}}sPIBody(){if(this.text.length===0){let i=this.getCodeNorm();i===Et?this.state=te:Dt(i)||(this.text=String.fromCodePoint(i))}else this.captureToChar(Et)&&(this.state=te)}sPIEnding(){var i;let s=this.getCodeNorm();if(s===Ct){let{piTarget:r}=this;r.toLowerCase()==="xml"&&this.fail("the XML declaration must appear at the start of the document."),(i=this.piHandler)===null||i===void 0||i.call(this,{target:r,body:this.text}),this.piTarget=this.text="",this.state=At}else s===Et?this.text+="?":(this.text+=`?${String.fromCodePoint(s)}`,this.state=_e);this.xmlDeclPossible=!1}sXMLDeclNameStart(){let i=this.skipSpaces();if(i===Et){this.state=Mt;return}i!==xt&&(this.state=Yr,this.name=String.fromCodePoint(i))}sXMLDeclName(){let i=this.captureTo(li);if(i===Et){this.state=Mt,this.name+=this.text,this.text="",this.fail("XML declaration is incomplete.");return}if(!!(Dt(i)||i===$t)){if(this.name+=this.text,this.text="",!this.xmlDeclExpects.includes(this.name))switch(this.name.length){case 0:this.fail("did not expect any more name/value pairs.");break;case 1:this.fail(`expected the name ${this.xmlDeclExpects[0]}.`);break;default:this.fail(`expected one of ${this.xmlDeclExpects.join(", ")}`)}this.state=i===$t?Xe:Qr}}sXMLDeclEq(){let i=this.getCodeNorm();if(i===Et){this.state=Mt,this.fail("XML declaration is incomplete.");return}Dt(i)||(i!==$t&&this.fail("value required."),this.state=Xe)}sXMLDeclValueStart(){let i=this.getCodeNorm();if(i===Et){this.state=Mt,this.fail("XML declaration is incomplete.");return}Dt(i)||(ie(i)?this.q=i:(this.fail("value must be quoted."),this.q=Ke),this.state=Jr)}sXMLDeclValue(){let i=this.captureTo([this.q,Et]);if(i===Et){this.state=Mt,this.text="",this.fail("XML declaration is incomplete.");return}if(i===xt)return;let s=this.text;switch(this.text="",this.name){case"version":{this.xmlDeclExpects=["encoding","standalone"];let r=s;this.xmlDecl.version=r,/^1\.[0-9]+$/.test(r)?this.opt.forceXMLVersion||this.setXMLVersion(r):this.fail("version number must match /^1\\.[0-9]+$/.");break}case"encoding":/^[A-Za-z][A-Za-z0-9._-]*$/.test(s)||this.fail("encoding value must match /^[A-Za-z0-9][A-Za-z0-9._-]*$/."),this.xmlDeclExpects=["standalone"],this.xmlDecl.encoding=s;break;case"standalone":s!=="yes"&&s!=="no"&&this.fail('standalone value must match "yes" or "no".'),this.xmlDeclExpects=[],this.xmlDecl.standalone=s;break;default:}this.name="",this.state=ti}sXMLDeclSeparator(){let i=this.getCodeNorm();if(i===Et){this.state=Mt;return}Dt(i)||(this.fail("whitespace required."),this.unget()),this.state=Ze}sXMLDeclEnding(){var i;this.getCodeNorm()===Ct?(this.piTarget!=="xml"?this.fail("processing instructions are not allowed before root."):this.name!=="version"&&this.xmlDeclExpects.includes("version")&&this.fail("XML declaration must contain a version."),(i=this.xmldeclHandler)===null||i===void 0||i.call(this,this.xmlDecl),this.name="",this.piTarget=this.text="",this.state=At):this.fail("The character ? is disallowed anywhere in XML declarations."),this.xmlDeclPossible=!1}sOpenTag(){var i;let s=this.captureNameChars();if(s===xt)return;let r=this.tag={name:this.name,attributes:Object.create(null)};switch(this.name="",this.xmlnsOpt&&(this.topNS=r.ns=Object.create(null)),(i=this.openTagStartHandler)===null||i===void 0||i.call(this,r),this.sawRoot=!0,!this.fragmentOpt&&this.closedRoot&&this.fail("documents may contain only one root."),s){case Ct:this.openTag();break;case re:this.state=ge;break;default:Dt(s)||this.fail("disallowed character in tag name."),this.state=Kt}}sOpenTagSlash(){this.getCode()===Ct?this.openSelfClosingTag():(this.fail("forward-slash in opening tag not followed by >."),this.state=Kt)}sAttrib(){let i=this.skipSpaces();i!==xt&&(qt(i)?(this.unget(),this.state=be):i===Ct?this.openTag():i===re?this.state=ge:this.fail("disallowed character in attribute name."))}sAttribName(){let i=this.captureNameChars();i===$t?this.state=Ge:Dt(i)?this.state=ri:i===Ct?(this.fail("attribute without value."),this.pushAttrib(this.name,this.name),this.name=this.text="",this.openTag()):i!==xt&&this.fail("disallowed character in attribute name.")}sAttribNameSawWhite(){let i=this.skipSpaces();switch(i){case xt:return;case $t:this.state=Ge;break;default:this.fail("attribute without value."),this.text="",this.name="",i===Ct?this.openTag():qt(i)?(this.unget(),this.state=be):(this.fail("disallowed character in attribute name."),this.state=Kt)}}sAttribValue(){let i=this.getCodeNorm();ie(i)?(this.q=i,this.state=Ve):Dt(i)||(this.fail("unquoted attribute value."),this.state=qe,this.unget())}sAttribValueQuoted(){let{q:i,chunk:s}=this,{i:r}=this;for(;;)switch(this.getCode()){case i:this.pushAttrib(this.name,this.text+s.slice(r,this.prevI)),this.name=this.text="",this.q=null,this.state=ii;return;case Yt:this.text+=s.slice(r,this.prevI),this.state=Jt,this.entityReturnState=Ve;return;case Ft:case Rt:case xe:this.text+=`${s.slice(r,this.prevI)} `,r=this.i;break;case zt:this.text+=s.slice(r,this.prevI),this.fail("disallowed character.");return;case xt:this.text+=s.slice(r);return;default:}}sAttribValueClosed(){let i=this.getCodeNorm();Dt(i)?this.state=Kt:i===Ct?this.openTag():i===re?this.state=ge:qt(i)?(this.fail("no whitespace between attributes."),this.unget(),this.state=be):this.fail("disallowed character in attribute name.")}sAttribValueUnquoted(){let i=this.captureTo(ui);switch(i){case Yt:this.state=Jt,this.entityReturnState=qe;break;case zt:this.fail("disallowed character.");break;case xt:break;default:this.text.includes("]]>")&&this.fail('the string "]]>" is disallowed in char data.'),this.pushAttrib(this.name,this.text),this.name=this.text="",i===Ct?this.openTag():this.state=Kt}}sCloseTag(){let i=this.captureNameChars();i===Ct?this.closeTag():Dt(i)?this.state=si:i!==xt&&this.fail("disallowed character in closing tag.")}sCloseTagSawWhite(){switch(this.skipSpaces()){case Ct:this.closeTag();break;case xt:break;default:this.fail("disallowed character in closing tag.")}}handleTextInRoot(){let{i,forbiddenState:s}=this,{chunk:r,textHandler:h}=this;t:for(;;)switch(this.getCode()){case zt:{if(this.state=de,h!==void 0){let{text:o}=this,f=r.slice(i,this.prevI);o.length!==0?(h(o+f),this.text=""):f.length!==0&&h(f)}s=Bt;break t}case Yt:this.state=Jt,this.entityReturnState=At,h!==void 0&&(this.text+=r.slice(i,this.prevI)),s=Bt;break t;case Ht:switch(s){case Bt:s=tr;break;case tr:s=ve;break;case ve:break;default:throw new Error("impossible state")}break;case Ct:s===ve&&this.fail('the string "]]>" is disallowed in char data.'),s=Bt;break;case Rt:h!==void 0&&(this.text+=`${r.slice(i,this.prevI)}
`),i=this.i,s=Bt;break;case xt:h!==void 0&&(this.text+=r.slice(i));break t;default:s=Bt}this.forbiddenState=s}handleTextOutsideRoot(){let{i}=this,{chunk:s,textHandler:r}=this,h=!1;t:for(;;){let o=this.getCode();switch(o){case zt:{if(this.state=de,r!==void 0){let{text:f}=this,x=s.slice(i,this.prevI);f.length!==0?(r(f+x),this.text=""):x.length!==0&&r(x)}break t}case Yt:this.state=Jt,this.entityReturnState=At,r!==void 0&&(this.text+=s.slice(i,this.prevI)),h=!0;break t;case Rt:r!==void 0&&(this.text+=`${s.slice(i,this.prevI)}
`),i=this.i;break;case xt:r!==void 0&&(this.text+=s.slice(i));break t;default:Dt(o)||(h=!0)}}!h||(!this.sawRoot&&!this.reportedTextBeforeRoot&&(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0))}pushAttribNS(i,s){var r;let{prefix:h,local:o}=this.qname(i),f={name:i,prefix:h,local:o,value:s};if(this.attribList.push(f),(r=this.attributeHandler)===null||r===void 0||r.call(this,f),h==="xmlns"){let x=s.trim();this.currentXMLVersion==="1.0"&&x===""&&this.fail("invalid attempt to undefine prefix in XML 1.0"),this.topNS[o]=x,ye(this,o,x)}else if(i==="xmlns"){let x=s.trim();this.topNS[""]=x,ye(this,"",x)}}pushAttribPlain(i,s){var r;let h={name:i,value:s};this.attribList.push(h),(r=this.attributeHandler)===null||r===void 0||r.call(this,h)}end(){var i,s;this.sawRoot||this.fail("document must contain a root element.");let{tags:r}=this;for(;r.length>0;){let o=r.pop();this.fail(`unclosed tag: ${o.name}`)}this.state!==We&&this.state!==At&&this.fail("unexpected end.");let{text:h}=this;return h.length!==0&&((i=this.textHandler)===null||i===void 0||i.call(this,h),this.text=""),this._closed=!0,(s=this.endHandler)===null||s===void 0||s.call(this),this._init(),this}resolve(i){var s,r;let h=this.topNS[i];if(h!==void 0)return h;let{tags:o}=this;for(let f=o.length-1;f>=0;f--)if(h=o[f].ns[i],h!==void 0)return h;return h=this.ns[i],h!==void 0?h:(r=(s=this.opt).resolvePrefix)===null||r===void 0?void 0:r.call(s,i)}qname(i){let s=i.indexOf(":");if(s===-1)return{prefix:"",local:i};let r=i.slice(s+1),h=i.slice(0,s);return(h===""||r===""||r.includes(":"))&&this.fail(`malformed name: ${i}.`),{prefix:h,local:r}}processAttribsNS(){var i;let{attribList:s}=this,r=this.tag;{let{prefix:f,local:x}=this.qname(r.name);r.prefix=f,r.local=x;let D=r.uri=(i=this.resolve(f))!==null&&i!==void 0?i:"";f!==""&&(f==="xmlns"&&this.fail('tags may not have "xmlns" as prefix.'),D===""&&(this.fail(`unbound namespace prefix: ${JSON.stringify(f)}.`),r.uri=f))}if(s.length===0)return;let{attributes:h}=r,o=new Set;for(let f of s){let{name:x,prefix:D,local:C}=f,E,u;D===""?(E=x==="xmlns"?Wt:"",u=x):(E=this.resolve(D),E===void 0&&(this.fail(`unbound namespace prefix: ${JSON.stringify(D)}.`),E=D),u=`{${E}}${C}`),o.has(u)&&this.fail(`duplicate attribute: ${u}.`),o.add(u),f.uri=E,h[x]=f}this.attribList=[]}processAttribsPlain(){let{attribList:i}=this,s=this.tag.attributes;for(let{name:r,value:h}of i)s[r]!==void 0&&this.fail(`duplicate attribute: ${r}.`),s[r]=h;this.attribList=[]}openTag(){var i;this.processAttribs();let{tags:s}=this,r=this.tag;r.isSelfClosing=!1,(i=this.openTagHandler)===null||i===void 0||i.call(this,r),s.push(r),this.state=At,this.name=""}openSelfClosingTag(){var i,s,r;this.processAttribs();let{tags:h}=this,o=this.tag;o.isSelfClosing=!0,(i=this.openTagHandler)===null||i===void 0||i.call(this,o),(s=this.closeTagHandler)===null||s===void 0||s.call(this,o),(this.tag=(r=h[h.length-1])!==null&&r!==void 0?r:null)===null&&(this.closedRoot=!0),this.state=At,this.name=""}closeTag(){let{tags:i,name:s}=this;if(this.state=At,this.name="",s===""){this.fail("weird empty close tag."),this.text+="</>";return}let r=this.closeTagHandler,h=i.length;for(;h-- >0;){let o=this.tag=i.pop();if(this.topNS=o.ns,r?.(o),o.name===s)break;this.fail("unexpected close tag.")}h===0?this.closedRoot=!0:h<0&&(this.fail(`unmatched closing tag: ${s}.`),this.text+=`</${s}>`)}parseEntity(i){if(i[0]!=="#"){let r=this.ENTITIES[i];return r!==void 0?r:(this.fail(this.isName(i)?"undefined entity.":"disallowed character in entity name."),`&${i};`)}let s=NaN;return i[1]==="x"&&/^#x[0-9a-f]+$/i.test(i)?s=parseInt(i.slice(2),16):/^#[0-9]+$/.test(i)&&(s=parseInt(i.slice(1),10)),this.isChar(s)?String.fromCodePoint(s):(this.fail("malformed character entity."),`&${i};`)}};jt.SaxesParser=ke});var lr=Pt((ki,Ee)=>{var hr={},pi=function(i){i.version="0.11.2";function s(y){for(var A="",S=y.length-1;S>=0;)A+=y.charAt(S--);return A}function r(y,A){for(var S="";S.length<A;)S+=y;return S}function h(y,A){var S=""+y;return S.length>=A?S:r("0",A-S.length)+S}function o(y,A){var S=""+y;return S.length>=A?S:r(" ",A-S.length)+S}function f(y,A){var S=""+y;return S.length>=A?S:S+r(" ",A-S.length)}function x(y,A){var S=""+Math.round(y);return S.length>=A?S:r("0",A-S.length)+S}function D(y,A){var S=""+y;return S.length>=A?S:r("0",A-S.length)+S}var C=Math.pow(2,32);function E(y,A){if(y>C||y<-C)return x(y,A);var S=Math.round(y);return D(S,A)}function u(y,A){return A=A||0,y.length>=7+A&&(y.charCodeAt(A)|32)===103&&(y.charCodeAt(A+1)|32)===101&&(y.charCodeAt(A+2)|32)===110&&(y.charCodeAt(A+3)|32)===101&&(y.charCodeAt(A+4)|32)===114&&(y.charCodeAt(A+5)|32)===97&&(y.charCodeAt(A+6)|32)===108}var _=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],l=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function m(y){y[0]="General",y[1]="0",y[2]="0.00",y[3]="#,##0",y[4]="#,##0.00",y[9]="0%",y[10]="0.00%",y[11]="0.00E+00",y[12]="# ?/?",y[13]="# ??/??",y[14]="m/d/yy",y[15]="d-mmm-yy",y[16]="d-mmm",y[17]="mmm-yy",y[18]="h:mm AM/PM",y[19]="h:mm:ss AM/PM",y[20]="h:mm",y[21]="h:mm:ss",y[22]="m/d/yy h:mm",y[37]="#,##0 ;(#,##0)",y[38]="#,##0 ;[Red](#,##0)",y[39]="#,##0.00;(#,##0.00)",y[40]="#,##0.00;[Red](#,##0.00)",y[45]="mm:ss",y[46]="[h]:mm:ss",y[47]="mmss.0",y[48]="##0.0E+0",y[49]="@",y[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'}var c={};m(c);var g=[],b=0;for(b=5;b<=8;++b)g[b]=32+b;for(b=23;b<=26;++b)g[b]=0;for(b=27;b<=31;++b)g[b]=14;for(b=50;b<=58;++b)g[b]=14;for(b=59;b<=62;++b)g[b]=b-58;for(b=67;b<=68;++b)g[b]=b-58;for(b=72;b<=75;++b)g[b]=b-58;for(b=67;b<=68;++b)g[b]=b-57;for(b=76;b<=78;++b)g[b]=b-56;for(b=79;b<=81;++b)g[b]=b-34;var T=[];T[5]=T[63]='"$"#,##0_);\\("$"#,##0\\)',T[6]=T[64]='"$"#,##0_);[Red]\\("$"#,##0\\)',T[7]=T[65]='"$"#,##0.00_);\\("$"#,##0.00\\)',T[8]=T[66]='"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',T[41]='_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',T[42]='_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',T[43]='_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',T[44]='_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)';function R(y,A,S){for(var et=y<0?-1:1,F=y*et,t=0,p=1,k=0,d=1,a=0,v=0,M=Math.floor(F);a<A&&(M=Math.floor(F),k=M*p+t,v=M*a+d,!(F-M<5e-8));)F=1/(F-M),t=p,p=k,d=a,a=v;if(v>A&&(a>A?(v=d,k=t):(v=a,k=p)),!S)return[0,et*k,v];var W=Math.floor(et*k/v);return[W,et*k-W*v,v]}function U(y,A,S){if(y>2958465||y<0)return null;var et=y|0,F=Math.floor(86400*(y-et)),t=0,p=[],k={D:et,T:F,u:86400*(y-et)-F,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(k.u)<1e-6&&(k.u=0),A&&A.date1904&&(et+=1462),k.u>.9999&&(k.u=0,++F==86400&&(k.T=F=0,++et,++k.D)),et===60)p=S?[1317,10,29]:[1900,2,29],t=3;else if(et===0)p=S?[1317,8,29]:[1900,1,0],t=6;else{et>60&&--et;var d=new Date(1900,0,1);d.setDate(d.getDate()+et-1),p=[d.getFullYear(),d.getMonth()+1,d.getDate()],t=d.getDay(),et<60&&(t=(t+6)%7),S&&(t=n(d,p))}return k.y=p[0],k.m=p[1],k.d=p[2],k.S=F%60,F=Math.floor(F/60),k.M=F%60,F=Math.floor(F/60),k.H=F,k.q=t,k}i.parse_date_code=U;var L=new Date(1899,11,31,0,0,0),Z=L.getTime(),P=new Date(1900,2,1,0,0,0);function V(y,A){var S=y.getTime();return A?S-=1262304e5:y>=P&&(S+=864e5),(S-(Z+(y.getTimezoneOffset()-L.getTimezoneOffset())*6e4))/864e5}function nt(y){return y.toString(10)}i._general_int=nt;var w=function(){var A=/(?:\.0*|(\.\d*[1-9])0+)$/;function S(a){return a.indexOf(".")==-1?a:a.replace(A,"$1")}var et=/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,F=/(E[+-])(\d)$/;function t(a){return a.indexOf("E")==-1?a:a.replace(et,"$1E").replace(F,"$10$2")}function p(a){var v=a<0?12:11,M=S(a.toFixed(12));return M.length<=v||(M=a.toPrecision(10),M.length<=v)?M:a.toExponential(5)}function k(a){var v=S(a.toFixed(11));return v.length>(a<0?12:11)||v==="0"||v==="-0"?a.toPrecision(6):v}function d(a){var v=Math.floor(Math.log(Math.abs(a))*Math.LOG10E),M;return v>=-4&&v<=-1?M=a.toPrecision(10+v):Math.abs(v)<=9?M=p(a):v===10?M=a.toFixed(10).substr(0,12):M=k(a),S(t(M.toUpperCase()))}return d}();i._general_num=w;function $(y,A){switch(typeof y){case"string":return y;case"boolean":return y?"TRUE":"FALSE";case"number":return(y|0)===y?y.toString(10):w(y);case"undefined":return"";case"object":if(y==null)return"";if(y instanceof Date)return kt(14,V(y,A&&A.date1904),A)}throw new Error("unsupported value in General format: "+y)}i._general=$;function n(y,A){A[0]-=581;var S=y.getDay();return y<60&&(S=(S+6)%7),S}var H="\u0E50\u0E51\u0E52\u0E53\u0E54\u0E55\u0E56\u0E57\u0E58\u0E59".split("");function ht(y,A,S,et){var F="",t=0,p=0,k=S.y,d,a=0;switch(y){case 98:k=S.y+543;case 121:switch(A.length){case 1:case 2:d=k%100,a=2;break;default:d=k%1e4,a=4;break}break;case 109:switch(A.length){case 1:case 2:d=S.m,a=A.length;break;case 3:return l[S.m-1][1];case 5:return l[S.m-1][0];default:return l[S.m-1][2]}break;case 100:switch(A.length){case 1:case 2:d=S.d,a=A.length;break;case 3:return _[S.q][0];default:return _[S.q][1]}break;case 104:switch(A.length){case 1:case 2:d=1+(S.H+11)%12,a=A.length;break;default:throw"bad hour format: "+A}break;case 72:switch(A.length){case 1:case 2:d=S.H,a=A.length;break;default:throw"bad hour format: "+A}break;case 77:switch(A.length){case 1:case 2:d=S.M,a=A.length;break;default:throw"bad minute format: "+A}break;case 115:if(A!="s"&&A!="ss"&&A!=".0"&&A!=".00"&&A!=".000")throw"bad second format: "+A;return S.u===0&&(A=="s"||A=="ss")?h(S.S,A.length):(et>=2?p=et===3?1e3:100:p=et===1?10:1,t=Math.round(p*(S.S+S.u)),t>=60*p&&(t=0),A==="s"?t===0?"0":""+t/p:(F=h(t,2+et),A==="ss"?F.substr(0,2):"."+F.substr(2,A.length-1)));case 90:switch(A){case"[h]":case"[hh]":d=S.D*24+S.H;break;case"[m]":case"[mm]":d=(S.D*24+S.H)*60+S.M;break;case"[s]":case"[ss]":d=((S.D*24+S.H)*60+S.M)*60+Math.round(S.S+S.u);break;default:throw"bad abstime format: "+A}a=A.length===3?1:2;break;case 101:d=k,a=1;break}var v=a>0?h(d,a):"";return v}function X(y){var A=3;if(y.length<=A)return y;for(var S=y.length%A,et=y.substr(0,S);S!=y.length;S+=A)et+=(et.length>0?",":"")+y.substr(S,A);return et}var lt=function(){var A=/%/g;function S(K,N,I){var rt=N.replace(A,""),G=N.length-rt.length;return lt(K,rt,I*Math.pow(10,2*G))+r("%",G)}function et(K,N,I){for(var rt=N.length-1;N.charCodeAt(rt-1)===44;)--rt;return lt(K,N.substr(0,rt),I/Math.pow(10,3*(N.length-rt)))}function F(K,N){var I,rt=K.indexOf("E")-K.indexOf(".")-1;if(K.match(/^#+0.0E\+0$/)){if(N==0)return"0.0E+0";if(N<0)return"-"+F(K,-N);var G=K.indexOf(".");G===-1&&(G=K.indexOf("E"));var q=Math.floor(Math.log(N)*Math.LOG10E)%G;if(q<0&&(q+=G),I=(N/Math.pow(10,q)).toPrecision(rt+1+(G+q)%G),I.indexOf("e")===-1){var ct=Math.floor(Math.log(N)*Math.LOG10E);for(I.indexOf(".")===-1?I=I.charAt(0)+"."+I.substr(1)+"E+"+(ct-I.length+q):I+="E+"+(ct-q);I.substr(0,2)==="0.";)I=I.charAt(0)+I.substr(2,G)+"."+I.substr(2+G),I=I.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");I=I.replace(/\+-/,"-")}I=I.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(gt,vt,yt,pt){return vt+yt+pt.substr(0,(G+q)%G)+"."+pt.substr(q)+"E"})}else I=N.toExponential(rt);return K.match(/E\+00$/)&&I.match(/e[+-]\d$/)&&(I=I.substr(0,I.length-1)+"0"+I.charAt(I.length-1)),K.match(/E\-/)&&I.match(/e\+/)&&(I=I.replace(/e\+/,"e")),I.replace("e","E")}var t=/# (\?+)( ?)\/( ?)(\d+)/;function p(K,N,I){var rt=parseInt(K[4],10),G=Math.round(N*rt),q=Math.floor(G/rt),ct=G-q*rt,gt=rt;return I+(q===0?"":""+q)+" "+(ct===0?r(" ",K[1].length+1+K[4].length):o(ct,K[1].length)+K[2]+"/"+K[3]+h(gt,K[4].length))}function k(K,N,I){return I+(N===0?"":""+N)+r(" ",K[1].length+2+K[4].length)}var d=/^#*0*\.([0#]+)/,a=/\).*[0#]/,v=/\(###\) ###\\?-####/;function M(K){for(var N="",I,rt=0;rt!=K.length;++rt)switch(I=K.charCodeAt(rt)){case 35:break;case 63:N+=" ";break;case 48:N+="0";break;default:N+=String.fromCharCode(I)}return N}function W(K,N){var I=Math.pow(10,N);return""+Math.round(K*I)/I}function O(K,N){var I=K-Math.floor(K),rt=Math.pow(10,N);return N<(""+Math.round(I*rt)).length?0:Math.round(I*rt)}function Q(K,N){return N<(""+Math.round((K-Math.floor(K))*Math.pow(10,N))).length?1:0}function tt(K){return K<2147483647&&K>-2147483648?""+(K>=0?K|0:K-1|0):""+Math.floor(K)}function j(K,N,I){if(K.charCodeAt(0)===40&&!N.match(a)){var rt=N.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return I>=0?j("n",rt,I):"("+j("n",rt,-I)+")"}if(N.charCodeAt(N.length-1)===44)return et(K,N,I);if(N.indexOf("%")!==-1)return S(K,N,I);if(N.indexOf("E")!==-1)return F(N,I);if(N.charCodeAt(0)===36)return"$"+j(K,N.substr(N.charAt(1)==" "?2:1),I);var G,q,ct,gt,vt=Math.abs(I),yt=I<0?"-":"";if(N.match(/^00+$/))return yt+E(vt,N.length);if(N.match(/^[#?]+$/))return G=E(I,0),G==="0"&&(G=""),G.length>N.length?G:M(N.substr(0,N.length-G.length))+G;if(q=N.match(t))return p(q,vt,yt);if(N.match(/^#+0+$/))return yt+E(vt,N.length-N.indexOf("0"));if(q=N.match(d))return G=W(I,q[1].length).replace(/^([^\.]+)$/,"$1."+M(q[1])).replace(/\.$/,"."+M(q[1])).replace(/\.(\d*)$/,function(Tt,Gt){return"."+Gt+r("0",M(q[1]).length-Gt.length)}),N.indexOf("0.")!==-1?G:G.replace(/^0\./,".");if(N=N.replace(/^#+([0.])/,"$1"),q=N.match(/^(0*)\.(#*)$/))return yt+W(vt,q[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,q[1].length?"0.":".");if(q=N.match(/^#{1,3},##0(\.?)$/))return yt+X(E(vt,0));if(q=N.match(/^#,##0\.([#0]*0)$/))return I<0?"-"+j(K,N,-I):X(""+(Math.floor(I)+Q(I,q[1].length)))+"."+h(O(I,q[1].length),q[1].length);if(q=N.match(/^#,#*,#0/))return j(K,N.replace(/^#,#*,/,""),I);if(q=N.match(/^([0#]+)(\\?-([0#]+))+$/))return G=s(j(K,N.replace(/[\\-]/g,""),I)),ct=0,s(s(N.replace(/\\/g,"")).replace(/[0#]/g,function(Tt){return ct<G.length?G.charAt(ct++):Tt==="0"?"0":""}));if(N.match(v))return G=j(K,"##########",I),"("+G.substr(0,3)+") "+G.substr(3,3)+"-"+G.substr(6);var pt="";if(q=N.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return ct=Math.min(q[4].length,7),gt=R(vt,Math.pow(10,ct)-1,!1),G=""+yt,pt=lt("n",q[1],gt[1]),pt.charAt(pt.length-1)==" "&&(pt=pt.substr(0,pt.length-1)+"0"),G+=pt+q[2]+"/"+q[3],pt=f(gt[2],ct),pt.length<q[4].length&&(pt=M(q[4].substr(q[4].length-pt.length))+pt),G+=pt,G;if(q=N.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return ct=Math.min(Math.max(q[1].length,q[4].length),7),gt=R(vt,Math.pow(10,ct)-1,!0),yt+(gt[0]||(gt[1]?"":"0"))+" "+(gt[1]?o(gt[1],ct)+q[2]+"/"+q[3]+f(gt[2],ct):r(" ",2*ct+1+q[2].length+q[3].length));if(q=N.match(/^[#0?]+$/))return G=E(I,0),N.length<=G.length?G:M(N.substr(0,N.length-G.length))+G;if(q=N.match(/^([#0?]+)\.([#0]+)$/)){G=""+I.toFixed(Math.min(q[2].length,10)).replace(/([^0])0+$/,"$1"),ct=G.indexOf(".");var It=N.indexOf(".")-ct,Ot=N.length-G.length-It;return M(N.substr(0,It)+G+N.substr(N.length-Ot))}if(q=N.match(/^00,000\.([#0]*0)$/))return ct=O(I,q[1].length),I<0?"-"+j(K,N,-I):X(tt(I)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(Tt){return"00,"+(Tt.length<3?h(0,3-Tt.length):"")+Tt})+"."+h(ct,q[1].length);switch(N){case"###,##0.00":return j(K,"#,##0.00",I);case"###,###":case"##,###":case"#,###":var Nt=X(E(vt,0));return Nt!=="0"?yt+Nt:"";case"###,###.00":return j(K,"###,##0.00",I).replace(/^0\./,".");case"#,###.00":return j(K,"#,##0.00",I).replace(/^0\./,".");default:}throw new Error("unsupported format |"+N+"|")}function st(K,N,I){for(var rt=N.length-1;N.charCodeAt(rt-1)===44;)--rt;return lt(K,N.substr(0,rt),I/Math.pow(10,3*(N.length-rt)))}function mt(K,N,I){var rt=N.replace(A,""),G=N.length-rt.length;return lt(K,rt,I*Math.pow(10,2*G))+r("%",G)}function ft(K,N){var I,rt=K.indexOf("E")-K.indexOf(".")-1;if(K.match(/^#+0.0E\+0$/)){if(N==0)return"0.0E+0";if(N<0)return"-"+ft(K,-N);var G=K.indexOf(".");G===-1&&(G=K.indexOf("E"));var q=Math.floor(Math.log(N)*Math.LOG10E)%G;if(q<0&&(q+=G),I=(N/Math.pow(10,q)).toPrecision(rt+1+(G+q)%G),!I.match(/[Ee]/)){var ct=Math.floor(Math.log(N)*Math.LOG10E);I.indexOf(".")===-1?I=I.charAt(0)+"."+I.substr(1)+"E+"+(ct-I.length+q):I+="E+"+(ct-q),I=I.replace(/\+-/,"-")}I=I.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(gt,vt,yt,pt){return vt+yt+pt.substr(0,(G+q)%G)+"."+pt.substr(q)+"E"})}else I=N.toExponential(rt);return K.match(/E\+00$/)&&I.match(/e[+-]\d$/)&&(I=I.substr(0,I.length-1)+"0"+I.charAt(I.length-1)),K.match(/E\-/)&&I.match(/e\+/)&&(I=I.replace(/e\+/,"e")),I.replace("e","E")}function at(K,N,I){if(K.charCodeAt(0)===40&&!N.match(a)){var rt=N.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return I>=0?at("n",rt,I):"("+at("n",rt,-I)+")"}if(N.charCodeAt(N.length-1)===44)return st(K,N,I);if(N.indexOf("%")!==-1)return mt(K,N,I);if(N.indexOf("E")!==-1)return ft(N,I);if(N.charCodeAt(0)===36)return"$"+at(K,N.substr(N.charAt(1)==" "?2:1),I);var G,q,ct,gt,vt=Math.abs(I),yt=I<0?"-":"";if(N.match(/^00+$/))return yt+h(vt,N.length);if(N.match(/^[#?]+$/))return G=""+I,I===0&&(G=""),G.length>N.length?G:M(N.substr(0,N.length-G.length))+G;if(q=N.match(t))return k(q,vt,yt);if(N.match(/^#+0+$/))return yt+h(vt,N.length-N.indexOf("0"));if(q=N.match(d))return G=(""+I).replace(/^([^\.]+)$/,"$1."+M(q[1])).replace(/\.$/,"."+M(q[1])),G=G.replace(/\.(\d*)$/,function(Tt,Gt){return"."+Gt+r("0",M(q[1]).length-Gt.length)}),N.indexOf("0.")!==-1?G:G.replace(/^0\./,".");if(N=N.replace(/^#+([0.])/,"$1"),q=N.match(/^(0*)\.(#*)$/))return yt+(""+vt).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,q[1].length?"0.":".");if(q=N.match(/^#{1,3},##0(\.?)$/))return yt+X(""+vt);if(q=N.match(/^#,##0\.([#0]*0)$/))return I<0?"-"+at(K,N,-I):X(""+I)+"."+r("0",q[1].length);if(q=N.match(/^#,#*,#0/))return at(K,N.replace(/^#,#*,/,""),I);if(q=N.match(/^([0#]+)(\\?-([0#]+))+$/))return G=s(at(K,N.replace(/[\\-]/g,""),I)),ct=0,s(s(N.replace(/\\/g,"")).replace(/[0#]/g,function(Tt){return ct<G.length?G.charAt(ct++):Tt==="0"?"0":""}));if(N.match(v))return G=at(K,"##########",I),"("+G.substr(0,3)+") "+G.substr(3,3)+"-"+G.substr(6);var pt="";if(q=N.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return ct=Math.min(q[4].length,7),gt=R(vt,Math.pow(10,ct)-1,!1),G=""+yt,pt=lt("n",q[1],gt[1]),pt.charAt(pt.length-1)==" "&&(pt=pt.substr(0,pt.length-1)+"0"),G+=pt+q[2]+"/"+q[3],pt=f(gt[2],ct),pt.length<q[4].length&&(pt=M(q[4].substr(q[4].length-pt.length))+pt),G+=pt,G;if(q=N.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return ct=Math.min(Math.max(q[1].length,q[4].length),7),gt=R(vt,Math.pow(10,ct)-1,!0),yt+(gt[0]||(gt[1]?"":"0"))+" "+(gt[1]?o(gt[1],ct)+q[2]+"/"+q[3]+f(gt[2],ct):r(" ",2*ct+1+q[2].length+q[3].length));if(q=N.match(/^[#0?]+$/))return G=""+I,N.length<=G.length?G:M(N.substr(0,N.length-G.length))+G;if(q=N.match(/^([#0]+)\.([#0]+)$/)){G=""+I.toFixed(Math.min(q[2].length,10)).replace(/([^0])0+$/,"$1"),ct=G.indexOf(".");var It=N.indexOf(".")-ct,Ot=N.length-G.length-It;return M(N.substr(0,It)+G+N.substr(N.length-Ot))}if(q=N.match(/^00,000\.([#0]*0)$/))return I<0?"-"+at(K,N,-I):X(""+I).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(Tt){return"00,"+(Tt.length<3?h(0,3-Tt.length):"")+Tt})+"."+h(0,q[1].length);switch(N){case"###,###":case"##,###":case"#,###":var Nt=X(""+vt);return Nt!=="0"?yt+Nt:"";default:if(N.match(/\.[0#?]*$/))return at(K,N.slice(0,N.lastIndexOf(".")),I)+M(N.slice(N.lastIndexOf(".")))}throw new Error("unsupported format |"+N+"|")}return function(N,I,rt){return(rt|0)===rt?at(N,I,rt):j(N,I,rt)}}();function Y(y){for(var A=[],S=!1,et=0,F=0;et<y.length;++et)switch(y.charCodeAt(et)){case 34:S=!S;break;case 95:case 42:case 92:++et;break;case 59:A[A.length]=y.substr(F,et-F),F=et+1}if(A[A.length]=y.substr(F),S===!0)throw new Error("Format |"+y+"| unterminated string ");return A}i._split=Y;var ut=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function B(y){for(var A=0,S="",et="";A<y.length;)switch(S=y.charAt(A)){case"G":u(y,A)&&(A+=6),A++;break;case'"':for(;y.charCodeAt(++A)!==34&&A<y.length;);++A;break;case"\\":A+=2;break;case"_":A+=2;break;case"@":++A;break;case"B":case"b":if(y.charAt(A+1)==="1"||y.charAt(A+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(y.substr(A,3).toUpperCase()==="A/P"||y.substr(A,5).toUpperCase()==="AM/PM"||y.substr(A,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++A;break;case"[":for(et=S;y.charAt(A++)!=="]"&&A<y.length;)et+=y.charAt(A);if(et.match(ut))return!0;break;case".":case"0":case"#":for(;A<y.length&&("0#?.,E+-%".indexOf(S=y.charAt(++A))>-1||S=="\\"&&y.charAt(A+1)=="-"&&"0#".indexOf(y.charAt(A+2))>-1););break;case"?":for(;y.charAt(++A)===S;);break;case"*":++A,(y.charAt(A)==" "||y.charAt(A)=="*")&&++A;break;case"(":case")":++A;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;A<y.length&&"0123456789".indexOf(y.charAt(++A))>-1;);break;case" ":++A;break;default:++A;break}return!1}i.is_date=B;function z(y,A,S,et){for(var F=[],t="",p=0,k="",d="t",a,v,M,W="H";p<y.length;)switch(k=y.charAt(p)){case"G":if(!u(y,p))throw new Error("unrecognized character "+k+" in "+y);F[F.length]={t:"G",v:"General"},p+=7;break;case'"':for(t="";(M=y.charCodeAt(++p))!==34&&p<y.length;)t+=String.fromCharCode(M);F[F.length]={t:"t",v:t},++p;break;case"\\":var O=y.charAt(++p),Q=O==="("||O===")"?O:"t";F[F.length]={t:Q,v:O},++p;break;case"_":F[F.length]={t:"t",v:" "},p+=2;break;case"@":F[F.length]={t:"T",v:A},++p;break;case"B":case"b":if(y.charAt(p+1)==="1"||y.charAt(p+1)==="2"){if(a==null&&(a=U(A,S,y.charAt(p+1)==="2"),a==null))return"";F[F.length]={t:"X",v:y.substr(p,2)},d=k,p+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":k=k.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(A<0||a==null&&(a=U(A,S),a==null))return"";for(t=k;++p<y.length&&y.charAt(p).toLowerCase()===k;)t+=k;k==="m"&&d.toLowerCase()==="h"&&(k="M"),k==="h"&&(k=W),F[F.length]={t:k,v:t},d=k;break;case"A":case"a":case"\u4E0A":var tt={t:k,v:k};if(a==null&&(a=U(A,S)),y.substr(p,3).toUpperCase()==="A/P"?(a!=null&&(tt.v=a.H>=12?"P":"A"),tt.t="T",W="h",p+=3):y.substr(p,5).toUpperCase()==="AM/PM"?(a!=null&&(tt.v=a.H>=12?"PM":"AM"),tt.t="T",p+=5,W="h"):y.substr(p,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(a!=null&&(tt.v=a.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),tt.t="T",p+=5,W="h"):(tt.t="t",++p),a==null&&tt.t==="T")return"";F[F.length]=tt,d=k;break;case"[":for(t=k;y.charAt(p++)!=="]"&&p<y.length;)t+=y.charAt(p);if(t.slice(-1)!=="]")throw'unterminated "[" block: |'+t+"|";if(t.match(ut)){if(a==null&&(a=U(A,S),a==null))return"";F[F.length]={t:"Z",v:t.toLowerCase()},d=t.charAt(1)}else t.indexOf("$")>-1&&(t=(t.match(/\$([^-\[\]]*)/)||[])[1]||"$",B(y)||(F[F.length]={t:"t",v:t}));break;case".":if(a!=null){for(t=k;++p<y.length&&(k=y.charAt(p))==="0";)t+=k;F[F.length]={t:"s",v:t};break}case"0":case"#":for(t=k;++p<y.length&&"0#?.,E+-%".indexOf(k=y.charAt(p))>-1;)t+=k;F[F.length]={t:"n",v:t};break;case"?":for(t=k;y.charAt(++p)===k;)t+=k;F[F.length]={t:k,v:t},d=k;break;case"*":++p,(y.charAt(p)==" "||y.charAt(p)=="*")&&++p;break;case"(":case")":F[F.length]={t:et===1?"t":k,v:k},++p;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(t=k;p<y.length&&"0123456789".indexOf(y.charAt(++p))>-1;)t+=y.charAt(p);F[F.length]={t:"D",v:t};break;case" ":F[F.length]={t:k,v:k},++p;break;case"$":F[F.length]={t:"t",v:"$"},++p;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(k)===-1)throw new Error("unrecognized character "+k+" in "+y);F[F.length]={t:"t",v:k},++p;break}var j=0,st=0,mt;for(p=F.length-1,d="t";p>=0;--p)switch(F[p].t){case"h":case"H":F[p].t=W,d="h",j<1&&(j=1);break;case"s":(mt=F[p].v.match(/\.0+$/))&&(st=Math.max(st,mt[0].length-1)),j<3&&(j=3);case"d":case"y":case"M":case"e":d=F[p].t;break;case"m":d==="s"&&(F[p].t="M",j<2&&(j=2));break;case"X":break;case"Z":j<1&&F[p].v.match(/[Hh]/)&&(j=1),j<2&&F[p].v.match(/[Mm]/)&&(j=2),j<3&&F[p].v.match(/[Ss]/)&&(j=3)}switch(j){case 0:break;case 1:a.u>=.5&&(a.u=0,++a.S),a.S>=60&&(a.S=0,++a.M),a.M>=60&&(a.M=0,++a.H);break;case 2:a.u>=.5&&(a.u=0,++a.S),a.S>=60&&(a.S=0,++a.M);break}var ft="",at;for(p=0;p<F.length;++p)switch(F[p].t){case"t":case"T":case" ":case"D":break;case"X":F[p].v="",F[p].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":F[p].v=ht(F[p].t.charCodeAt(0),F[p].v,a,st),F[p].t="t";break;case"n":case"?":for(at=p+1;F[at]!=null&&((k=F[at].t)==="?"||k==="D"||(k===" "||k==="t")&&F[at+1]!=null&&(F[at+1].t==="?"||F[at+1].t==="t"&&F[at+1].v==="/")||F[p].t==="("&&(k===" "||k==="n"||k===")")||k==="t"&&(F[at].v==="/"||F[at].v===" "&&F[at+1]!=null&&F[at+1].t=="?"));)F[p].v+=F[at].v,F[at]={v:"",t:";"},++at;ft+=F[p].v,p=at-1;break;case"G":F[p].t="t",F[p].v=$(A,S);break}var K="",N,I;if(ft.length>0){ft.charCodeAt(0)==40?(N=A<0&&ft.charCodeAt(0)===45?-A:A,I=lt("n",ft,N)):(N=A<0&&et>1?-A:A,I=lt("n",ft,N),N<0&&F[0]&&F[0].t=="t"&&(I=I.substr(1),F[0].v="-"+F[0].v)),at=I.length-1;var rt=F.length;for(p=0;p<F.length;++p)if(F[p]!=null&&F[p].t!="t"&&F[p].v.indexOf(".")>-1){rt=p;break}var G=F.length;if(rt===F.length&&I.indexOf("E")===-1){for(p=F.length-1;p>=0;--p)F[p]==null||"n?".indexOf(F[p].t)===-1||(at>=F[p].v.length-1?(at-=F[p].v.length,F[p].v=I.substr(at+1,F[p].v.length)):at<0?F[p].v="":(F[p].v=I.substr(0,at+1),at=-1),F[p].t="t",G=p);at>=0&&G<F.length&&(F[G].v=I.substr(0,at+1)+F[G].v)}else if(rt!==F.length&&I.indexOf("E")===-1){for(at=I.indexOf(".")-1,p=rt;p>=0;--p)if(!(F[p]==null||"n?".indexOf(F[p].t)===-1)){for(v=F[p].v.indexOf(".")>-1&&p===rt?F[p].v.indexOf(".")-1:F[p].v.length-1,K=F[p].v.substr(v+1);v>=0;--v)at>=0&&(F[p].v.charAt(v)==="0"||F[p].v.charAt(v)==="#")&&(K=I.charAt(at--)+K);F[p].v=K,F[p].t="t",G=p}for(at>=0&&G<F.length&&(F[G].v=I.substr(0,at+1)+F[G].v),at=I.indexOf(".")+1,p=rt;p<F.length;++p)if(!(F[p]==null||"n?(".indexOf(F[p].t)===-1&&p!==rt)){for(v=F[p].v.indexOf(".")>-1&&p===rt?F[p].v.indexOf(".")+1:0,K=F[p].v.substr(0,v);v<F[p].v.length;++v)at<I.length&&(K+=I.charAt(at++));F[p].v=K,F[p].t="t",G=p}}}for(p=0;p<F.length;++p)F[p]!=null&&"n?".indexOf(F[p].t)>-1&&(N=et>1&&A<0&&p>0&&F[p-1].v==="-"?-A:A,F[p].v=lt(F[p].t,F[p].v,N),F[p].t="t");var q="";for(p=0;p!==F.length;++p)F[p]!=null&&(q+=F[p].v);return q}i._eval=z;var ot=/\[[=<>]/,it=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function J(y,A){if(A==null)return!1;var S=parseFloat(A[2]);switch(A[1]){case"=":if(y==S)return!0;break;case">":if(y>S)return!0;break;case"<":if(y<S)return!0;break;case"<>":if(y!=S)return!0;break;case">=":if(y>=S)return!0;break;case"<=":if(y<=S)return!0;break}return!1}function wt(y,A){var S=Y(y),et=S.length,F=S[et-1].indexOf("@");if(et<4&&F>-1&&--et,S.length>4)throw new Error("cannot find right format for |"+S.join("|")+"|");if(typeof A!="number")return[4,S.length===4||F>-1?S[S.length-1]:"@"];switch(S.length){case 1:S=F>-1?["General","General","General",S[0]]:[S[0],S[0],S[0],"@"];break;case 2:S=F>-1?[S[0],S[0],S[0],S[1]]:[S[0],S[1],S[0],"@"];break;case 3:S=F>-1?[S[0],S[1],S[0],S[2]]:[S[0],S[1],S[2],"@"];break;case 4:break}var t=A>0?S[0]:A<0?S[1]:S[2];if(S[0].indexOf("[")===-1&&S[1].indexOf("[")===-1)return[et,t];if(S[0].match(ot)!=null||S[1].match(ot)!=null){var p=S[0].match(it),k=S[1].match(it);return J(A,p)?[et,S[0]]:J(A,k)?[et,S[1]]:[et,S[p!=null&&k!=null?2:1]]}return[et,t]}function kt(y,A,S){S==null&&(S={});var et="";switch(typeof y){case"string":y=="m/d/yy"&&S.dateNF?et=S.dateNF:et=y;break;case"number":y==14&&S.dateNF?et=S.dateNF:et=(S.table!=null?S.table:c)[y],et==null&&(et=S.table&&S.table[g[y]]||c[g[y]]),et==null&&(et=T[y]||"General");break}if(u(et,0))return $(A,S);A instanceof Date&&(A=V(A,S.date1904));var F=wt(et,A);if(u(F[1]))return $(A,S);if(A===!0)A="TRUE";else if(A===!1)A="FALSE";else if(A===""||A==null)return"";return z(F[1],A,S,F[0])}function dt(y,A){if(typeof A!="number"){A=+A||-1;for(var S=0;S<392;++S){if(c[S]==null){A<0&&(A=S);continue}if(c[S]==y){A=S;break}}A<0&&(A=391)}return c[A]=y,A}i.load=dt,i._table=c,i.get_table=function(){return c},i.load_table=function(A){for(var S=0;S!=392;++S)A[S]!==void 0&&dt(A[S],S)},i.init_table=m,i.format=kt};pi(hr);typeof Ee<"u"&&typeof DO_NOT_EXPORT_SSF>"u"&&(Ee.exports=hr)});var _i={};_r(_i,{default:()=>mi});var Fe=se(Te(),1),Lt=class{constructor(i){this.zip=i}static async loadAsync(i){let s=await Fe.default.loadAsync(i);return new Lt(s)}async getXML(i){let s=this.zip.file(i);return s&&s.internalStream("string")}async close(){this.zip=null}};function Ne(e,i,s){e.on("data",r=>{s.stop?(e.pause(),i.close()):i.write(r)}),e.on("end",()=>{i.close()}),e.resume()}var ur=se(or(),1),Xt=se(lr(),1);function Ae(e,i){let s=Xt.default.get_table();function r(u,_){return new Promise((l,m)=>{if(!u)return l();let c=!0,g={stop:!1},b=()=>{g.stop=!0},T=()=>{c&&(c=!1,l())},R=new ur.SaxesParser;R.on("end",T),R.on("error",Z=>{if(g.stop)return T();m(Z)});let U=[],L;R.on("opentag",Z=>{let{name:P,attributes:V}=Z;U.unshift({name:P,attributes:V})}),R.on("text",Z=>{L=Z}),R.on("closetag",async Z=>{U.shift();let{name:P,attributes:V}=Z;Z=L===void 0?{name:P,attributes:V}:{name:P,attributes:V,text:L},L=void 0;try{await _(P,Z,[...U],b)}catch(nt){console.error(nt)}}),i(u,R,g)})}async function h(u){let _=[],l=0;return await r(u,(m,c,g)=>{m==="sheet"?_.push(c.attributes):m==="workbookView"&&c.attributes.activeTab&&(l=Number(c.attributes.activeTab))}),{sheets:_,activeTab:l}}async function o(u){let _={};return await r(u,(l,m,c)=>{if(l==="Relationship"){let{Id:g,Target:b}=m.attributes;_[g]=b}}),_}async function f(u){let _=[],l=[];return await r(u,(m,c,g)=>{m==="si"?(_.push(l.join("")),l=[]):m==="t"&&l.push(c.text)}),_}async function x(u){let _=[],l={};return await r(u,(m,c,g)=>{if(m==="numFmt"&&g[0].name==="numFmts"){let{numFmtId:b,formatCode:T}=c.attributes;l[b]=T}else if(m==="xf"&&g[0].name==="cellXfs"){let{numFmtId:b}=c.attributes;_.push(Number(b))}}),_=_.map(m=>l[m]||s[m]||m),_}function D(u){let{y:_,m:l,d:m,H:c,M:g,S:b}=Xt.default.parse_date_code(u),[T,R,U,L,Z,P]=[_,l,m,c,g,b].map(V=>String(V).padStart(2,"0"));return`${T}-${R}-${U} ${L}:${Z}:${P}`}function C(u){return u.replace(/[0-9]/g,"").split("").reduce((l,m)=>l*26+parseInt(m,36)-9,0)-1}async function E(u,_,l,m,c={}){let{max:g=1/0}=c,b=[],T=0,R=0;await r(u,(U,L,Z,P)=>{if(U==="row"||U==="x:row")b.length>0&&!b.every(V=>V===""||V===void 0)&&(R>g?P():(m(b),R++)),T=0,b=[];else if(U==="v"||U==="x:v"){let V=Z[0],nt=V.attributes.t,w=V.attributes.r,$=w?C(w):T,n=V.attributes.s,H=L.text||"";if(H=H.trim(),H.length>0){if(nt==="s")H=_[H];else if(nt==="b")H=H==="0"?"FALSE":"TRUE";else if(nt==="e")H="";else if(n){let ht=parseFloat(H);if(!isNaN(ht)){let X=l[n];typeof X=="string"?Xt.default.is_date(X)?H=/[yd]/.test(X)?D(ht):Xt.default.format(X,ht):H=ht:X?H=Xt.default.format(X,ht):H=ht}}}if(w===void 0&&H==="")return;b[$]=H,T++}else if(U==="t"||U==="x:t"){let V=Z[1],nt=V.attributes.t,w=V.attributes.r,$=w?C(w):T;nt==="inlineStr"&&(b[$]=L.text,T++)}})}return async function(_,l=console.log,m={}){let c=await e.loadAsync(_),g=await c.getXML("xl/workbook.xml"),{sheets:b,activeTab:T}=await h(g),R=await c.getXML("xl/sharedStrings.xml"),U=await f(R),L=await c.getXML("xl/styles.xml"),Z=await x(L),P=await c.getXML("xl/_rels/workbook.xml.rels"),V=await o(P),nt=b.length>T?`xl/${V[b[T]["r:id"]].replace(/^\/xl\//,"")}`:"xl/worksheets/sheet1.xml",w=await c.getXML(nt);await E(w,U,Z,l,m.sheet),await c.close()}}var mi=Ae(Lt,Ne);return gr(_i);})();
/*!

JSZip v3.10.0 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/
/**
 * Character class utilities for XML NS 1.0 edition 3.
 *
 * @author Louis-Dominique Dubeau
 * @license MIT
 * @copyright Louis-Dominique Dubeau
 */
/**
 * Character classes and associated utilities for the 2nd edition of XML 1.1.
 *
 * @author Louis-Dominique Dubeau
 * @license MIT
 * @copyright Louis-Dominique Dubeau
 */
/**
 * Character classes and associated utilities for the 5th edition of XML 1.0.
 *
 * @author Louis-Dominique Dubeau
 * @license MIT
 * @copyright Louis-Dominique Dubeau
 */
xlsx2csv=xlsx2csv.default
