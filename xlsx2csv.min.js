"use strict";function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(arr,i){var _i=arr==null?null:typeof Symbol!=="undefined"&&arr[Symbol.iterator]||arr["@@iterator"];if(_i==null)return;var _arr=[];var _n=true;var _d=false;var _s,_e;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _regeneratorRuntime(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */_regeneratorRuntime=function _regeneratorRuntime(){return exports};var exports={},Op=Object.prototype,hasOwn=Op.hasOwnProperty,$Symbol="function"==typeof Symbol?Symbol:{},iteratorSymbol=$Symbol.iterator||"@@iterator",asyncIteratorSymbol=$Symbol.asyncIterator||"@@asyncIterator",toStringTagSymbol=$Symbol.toStringTag||"@@toStringTag";function define(obj,key,value){return Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}),obj[key]}try{define({},"")}catch(err){define=function define(obj,key,value){return obj[key]=value}}function wrap(innerFn,outerFn,self,tryLocsList){var protoGenerator=outerFn&&outerFn.prototype instanceof Generator?outerFn:Generator,generator=Object.create(protoGenerator.prototype),context=new Context(tryLocsList||[]);return generator._invoke=function(innerFn,self,context){var state="suspendedStart";return function(method,arg){if("executing"===state)throw new Error("Generator is already running");if("completed"===state){if("throw"===method)throw arg;return doneResult()}for(context.method=method,context.arg=arg;;){var delegate=context.delegate;if(delegate){var delegateResult=maybeInvokeDelegate(delegate,context);if(delegateResult){if(delegateResult===ContinueSentinel)continue;return delegateResult}}if("next"===context.method)context.sent=context._sent=context.arg;else if("throw"===context.method){if("suspendedStart"===state)throw state="completed",context.arg;context.dispatchException(context.arg)}else"return"===context.method&&context.abrupt("return",context.arg);state="executing";var record=tryCatch(innerFn,self,context);if("normal"===record.type){if(state=context.done?"completed":"suspendedYield",record.arg===ContinueSentinel)continue;return{value:record.arg,done:context.done}}"throw"===record.type&&(state="completed",context.method="throw",context.arg=record.arg)}}}(innerFn,self,context),generator}function tryCatch(fn,obj,arg){try{return{type:"normal",arg:fn.call(obj,arg)}}catch(err){return{type:"throw",arg:err}}}exports.wrap=wrap;var ContinueSentinel={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var IteratorPrototype={};define(IteratorPrototype,iteratorSymbol,function(){return this});var getProto=Object.getPrototypeOf,NativeIteratorPrototype=getProto&&getProto(getProto(values([])));NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn.call(NativeIteratorPrototype,iteratorSymbol)&&(IteratorPrototype=NativeIteratorPrototype);var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(IteratorPrototype);function defineIteratorMethods(prototype){["next","throw","return"].forEach(function(method){define(prototype,method,function(arg){return this._invoke(method,arg)})})}function AsyncIterator(generator,PromiseImpl){function invoke(method,arg,resolve,reject){var record=tryCatch(generator[method],generator,arg);if("throw"!==record.type){var result=record.arg,value=result.value;return value&&"object"==_typeof(value)&&hasOwn.call(value,"__await")?PromiseImpl.resolve(value.__await).then(function(value){invoke("next",value,resolve,reject)},function(err){invoke("throw",err,resolve,reject)}):PromiseImpl.resolve(value).then(function(unwrapped){result.value=unwrapped,resolve(result)},function(error){return invoke("throw",error,resolve,reject)})}reject(record.arg)}var previousPromise;this._invoke=function(method,arg){function callInvokeWithMethodAndArg(){return new PromiseImpl(function(resolve,reject){invoke(method,arg,resolve,reject)})}return previousPromise=previousPromise?previousPromise.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}}function maybeInvokeDelegate(delegate,context){var method=delegate.iterator[context.method];if(undefined===method){if(context.delegate=null,"throw"===context.method){if(delegate.iterator["return"]&&(context.method="return",context.arg=undefined,maybeInvokeDelegate(delegate,context),"throw"===context.method))return ContinueSentinel;context.method="throw",context.arg=new TypeError("The iterator does not provide a 'throw' method")}return ContinueSentinel}var record=tryCatch(method,delegate.iterator,context.arg);if("throw"===record.type)return context.method="throw",context.arg=record.arg,context.delegate=null,ContinueSentinel;var info=record.arg;return info?info.done?(context[delegate.resultName]=info.value,context.next=delegate.nextLoc,"return"!==context.method&&(context.method="next",context.arg=undefined),context.delegate=null,ContinueSentinel):info:(context.method="throw",context.arg=new TypeError("iterator result is not an object"),context.delegate=null,ContinueSentinel)}function pushTryEntry(locs){var entry={tryLoc:locs[0]};1 in locs&&(entry.catchLoc=locs[1]),2 in locs&&(entry.finallyLoc=locs[2],entry.afterLoc=locs[3]),this.tryEntries.push(entry)}function resetTryEntry(entry){var record=entry.completion||{};record.type="normal",delete record.arg,entry.completion=record}function Context(tryLocsList){this.tryEntries=[{tryLoc:"root"}],tryLocsList.forEach(pushTryEntry,this),this.reset(!0)}function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod)return iteratorMethod.call(iterable);if("function"==typeof iterable.next)return iterable;if(!isNaN(iterable.length)){var i=-1,next=function next(){for(;++i<iterable.length;){if(hasOwn.call(iterable,i))return next.value=iterable[i],next.done=!1,next}return next.value=undefined,next.done=!0,next};return next.next=next}}return{next:doneResult}}function doneResult(){return{value:undefined,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,define(Gp,"constructor",GeneratorFunctionPrototype),define(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,toStringTagSymbol,"GeneratorFunction"),exports.isGeneratorFunction=function(genFun){var ctor="function"==typeof genFun&&genFun.constructor;return!!ctor&&(ctor===GeneratorFunction||"GeneratorFunction"===(ctor.displayName||ctor.name))},exports.mark=function(genFun){return Object.setPrototypeOf?Object.setPrototypeOf(genFun,GeneratorFunctionPrototype):(genFun.__proto__=GeneratorFunctionPrototype,define(genFun,toStringTagSymbol,"GeneratorFunction")),genFun.prototype=Object.create(Gp),genFun},exports.awrap=function(arg){return{__await:arg}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,asyncIteratorSymbol,function(){return this}),exports.AsyncIterator=AsyncIterator,exports.async=function(innerFn,outerFn,self,tryLocsList,PromiseImpl){void 0===PromiseImpl&&(PromiseImpl=Promise);var iter=new AsyncIterator(wrap(innerFn,outerFn,self,tryLocsList),PromiseImpl);return exports.isGeneratorFunction(outerFn)?iter:iter.next().then(function(result){return result.done?result.value:iter.next()})},defineIteratorMethods(Gp),define(Gp,toStringTagSymbol,"Generator"),define(Gp,iteratorSymbol,function(){return this}),define(Gp,"toString",function(){return"[object Generator]"}),exports.keys=function(object){var keys=[];for(var key in object){keys.push(key)}return keys.reverse(),function next(){for(;keys.length;){var key=keys.pop();if(key in object)return next.value=key,next.done=!1,next}return next.done=!0,next}},exports.values=values,Context.prototype={constructor:Context,reset:function reset(skipTempReset){if(this.prev=0,this.next=0,this.sent=this._sent=undefined,this.done=!1,this.delegate=null,this.method="next",this.arg=undefined,this.tryEntries.forEach(resetTryEntry),!skipTempReset)for(var name in this){"t"===name.charAt(0)&&hasOwn.call(this,name)&&!isNaN(+name.slice(1))&&(this[name]=undefined)}},stop:function stop(){this.done=!0;var rootRecord=this.tryEntries[0].completion;if("throw"===rootRecord.type)throw rootRecord.arg;return this.rval},dispatchException:function dispatchException(exception){if(this.done)throw exception;var context=this;function handle(loc,caught){return record.type="throw",record.arg=exception,context.next=loc,caught&&(context.method="next",context.arg=undefined),!!caught}for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i],record=entry.completion;if("root"===entry.tryLoc)return handle("end");if(entry.tryLoc<=this.prev){var hasCatch=hasOwn.call(entry,"catchLoc"),hasFinally=hasOwn.call(entry,"finallyLoc");if(hasCatch&&hasFinally){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0);if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}else if(hasCatch){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0)}else{if(!hasFinally)throw new Error("try statement without catch or finally");if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}}}},abrupt:function abrupt(type,arg){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc<=this.prev&&hasOwn.call(entry,"finallyLoc")&&this.prev<entry.finallyLoc){var finallyEntry=entry;break}}finallyEntry&&("break"===type||"continue"===type)&&finallyEntry.tryLoc<=arg&&arg<=finallyEntry.finallyLoc&&(finallyEntry=null);var record=finallyEntry?finallyEntry.completion:{};return record.type=type,record.arg=arg,finallyEntry?(this.method="next",this.next=finallyEntry.finallyLoc,ContinueSentinel):this.complete(record)},complete:function complete(record,afterLoc){if("throw"===record.type)throw record.arg;return"break"===record.type||"continue"===record.type?this.next=record.arg:"return"===record.type?(this.rval=this.arg=record.arg,this.method="return",this.next="end"):"normal"===record.type&&afterLoc&&(this.next=afterLoc),ContinueSentinel},finish:function finish(finallyLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.finallyLoc===finallyLoc)return this.complete(entry.completion,entry.afterLoc),resetTryEntry(entry),ContinueSentinel}},"catch":function _catch(tryLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc===tryLoc){var record=entry.completion;if("throw"===record.type){var thrown=record.arg;resetTryEntry(entry)}return thrown}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(iterable,resultName,nextLoc){return this.delegate={iterator:values(iterable),resultName:resultName,nextLoc:nextLoc},"next"===this.method&&(this.arg=undefined),ContinueSentinel}},exports}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)})}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);Object.defineProperty(Constructor,"prototype",{writable:false});return Constructor}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&iter[Symbol.iterator]!=null||iter["@@iterator"]!=null)return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}function _createForOfIteratorHelper(o,allowArrayLike){var it=typeof Symbol!=="undefined"&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();normalCompletion=step.done;return step},e:function e(_e3){didErr=true;err=_e3},f:function f(){try{if(!normalCompletion&&it["return"]!=null)it["return"]()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _typeof(obj){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}var xlsx2csv=function(){var __create=Object.create;var __defProp=Object.defineProperty;var __getOwnPropDesc=Object.getOwnPropertyDescriptor;var __getOwnPropNames=Object.getOwnPropertyNames;var __getProtoOf=Object.getPrototypeOf;var __hasOwnProp=Object.prototype.hasOwnProperty;var __commonJS=function __commonJS(cb,mod){return function __require(){return mod||(0,cb[__getOwnPropNames(cb)[0]])((mod={exports:{}}).exports,mod),mod.exports}};var __export=function __export(target,all){for(var name in all){__defProp(target,name,{get:all[name],enumerable:true})}};var __copyProps=function __copyProps(to,from,except,desc){if(from&&_typeof(from)==="object"||typeof from==="function"){var _iterator=_createForOfIteratorHelper(__getOwnPropNames(from)),_step;try{var _loop=function _loop(){var key=_step.value;if(!__hasOwnProp.call(to,key)&&key!==except)__defProp(to,key,{get:function get(){return from[key]},enumerable:!(desc=__getOwnPropDesc(from,key))||desc.enumerable})};for(_iterator.s();!(_step=_iterator.n()).done;){_loop()}}catch(err){_iterator.e(err)}finally{_iterator.f()}}return to};var __toESM=function __toESM(mod,isNodeMode,target){return target=mod!=null?__create(__getProtoOf(mod)):{},__copyProps(isNodeMode||!mod||!mod.__esModule?__defProp(target,"default",{value:mod,enumerable:true}):target,mod)};var __toCommonJS=function __toCommonJS(mod){return __copyProps(__defProp({},"__esModule",{value:true}),mod)};// node_modules/xmlchars/xml/1.0/ed5.js
var require_ed5=__commonJS({"node_modules/xmlchars/xml/1.0/ed5.js":function node_modulesXmlcharsXml10Ed5Js(exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CHAR="\t\n\r -\uD7FF\uE000-\uFFFD\uD800\uDC00-\uDBFF\uDFFF";exports.S=" \t\r\n";exports.NAME_START_CHAR=":A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\uD800\uDC00-\uDB7F\uDFFF";exports.NAME_CHAR="-"+exports.NAME_START_CHAR+".0-9\xB7\u0300-\u036F\u203F-\u2040";exports.CHAR_RE=new RegExp("^["+exports.CHAR+"]$","u");exports.S_RE=new RegExp("^["+exports.S+"]+$","u");exports.NAME_START_CHAR_RE=new RegExp("^["+exports.NAME_START_CHAR+"]$","u");exports.NAME_CHAR_RE=new RegExp("^["+exports.NAME_CHAR+"]$","u");exports.NAME_RE=new RegExp("^["+exports.NAME_START_CHAR+"]["+exports.NAME_CHAR+"]*$","u");exports.NMTOKEN_RE=new RegExp("^["+exports.NAME_CHAR+"]+$","u");var TAB=9;var NL=10;var CR=13;var SPACE=32;exports.S_LIST=[SPACE,NL,CR,TAB];function isChar(c){return c>=SPACE&&c<=55295||c===NL||c===CR||c===TAB||c>=57344&&c<=65533||c>=65536&&c<=1114111}exports.isChar=isChar;function isS(c){return c===SPACE||c===NL||c===CR||c===TAB}exports.isS=isS;function isNameStartChar(c){return c>=65&&c<=90||c>=97&&c<=122||c===58||c===95||c===8204||c===8205||c>=192&&c<=214||c>=216&&c<=246||c>=248&&c<=767||c>=880&&c<=893||c>=895&&c<=8191||c>=8304&&c<=8591||c>=11264&&c<=12271||c>=12289&&c<=55295||c>=63744&&c<=64975||c>=65008&&c<=65533||c>=65536&&c<=983039}exports.isNameStartChar=isNameStartChar;function isNameChar(c){return isNameStartChar(c)||c>=48&&c<=57||c===45||c===46||c===183||c>=768&&c<=879||c>=8255&&c<=8256}exports.isNameChar=isNameChar}});// node_modules/xmlchars/xml/1.1/ed2.js
var require_ed2=__commonJS({"node_modules/xmlchars/xml/1.1/ed2.js":function node_modulesXmlcharsXml11Ed2Js(exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CHAR="\x01-\uD7FF\uE000-\uFFFD\uD800\uDC00-\uDBFF\uDFFF";exports.RESTRICTED_CHAR="\x01-\b\x0B\f\x0E-\x1F\x7F-\x84\x86-\x9F";exports.S=" \t\r\n";exports.NAME_START_CHAR=":A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\uD800\uDC00-\uDB7F\uDFFF";exports.NAME_CHAR="-"+exports.NAME_START_CHAR+".0-9\xB7\u0300-\u036F\u203F-\u2040";exports.CHAR_RE=new RegExp("^["+exports.CHAR+"]$","u");exports.RESTRICTED_CHAR_RE=new RegExp("^["+exports.RESTRICTED_CHAR+"]$","u");exports.S_RE=new RegExp("^["+exports.S+"]+$","u");exports.NAME_START_CHAR_RE=new RegExp("^["+exports.NAME_START_CHAR+"]$","u");exports.NAME_CHAR_RE=new RegExp("^["+exports.NAME_CHAR+"]$","u");exports.NAME_RE=new RegExp("^["+exports.NAME_START_CHAR+"]["+exports.NAME_CHAR+"]*$","u");exports.NMTOKEN_RE=new RegExp("^["+exports.NAME_CHAR+"]+$","u");var TAB=9;var NL=10;var CR=13;var SPACE=32;exports.S_LIST=[SPACE,NL,CR,TAB];function isChar(c){return c>=1&&c<=55295||c>=57344&&c<=65533||c>=65536&&c<=1114111}exports.isChar=isChar;function isRestrictedChar(c){return c>=1&&c<=8||c===11||c===12||c>=14&&c<=31||c>=127&&c<=132||c>=134&&c<=159}exports.isRestrictedChar=isRestrictedChar;function isCharAndNotRestricted(c){return c===9||c===10||c===13||c>31&&c<127||c===133||c>159&&c<=55295||c>=57344&&c<=65533||c>=65536&&c<=1114111}exports.isCharAndNotRestricted=isCharAndNotRestricted;function isS(c){return c===SPACE||c===NL||c===CR||c===TAB}exports.isS=isS;function isNameStartChar(c){return c>=65&&c<=90||c>=97&&c<=122||c===58||c===95||c===8204||c===8205||c>=192&&c<=214||c>=216&&c<=246||c>=248&&c<=767||c>=880&&c<=893||c>=895&&c<=8191||c>=8304&&c<=8591||c>=11264&&c<=12271||c>=12289&&c<=55295||c>=63744&&c<=64975||c>=65008&&c<=65533||c>=65536&&c<=983039}exports.isNameStartChar=isNameStartChar;function isNameChar(c){return isNameStartChar(c)||c>=48&&c<=57||c===45||c===46||c===183||c>=768&&c<=879||c>=8255&&c<=8256}exports.isNameChar=isNameChar}});// node_modules/xmlchars/xmlns/1.0/ed3.js
var require_ed3=__commonJS({"node_modules/xmlchars/xmlns/1.0/ed3.js":function node_modulesXmlcharsXmlns10Ed3Js(exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.NC_NAME_START_CHAR="A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\uD800\uDC00-\uDB7F\uDFFF";exports.NC_NAME_CHAR="-"+exports.NC_NAME_START_CHAR+".0-9\xB7\u0300-\u036F\u203F-\u2040";exports.NC_NAME_START_CHAR_RE=new RegExp("^["+exports.NC_NAME_START_CHAR+"]$","u");exports.NC_NAME_CHAR_RE=new RegExp("^["+exports.NC_NAME_CHAR+"]$","u");exports.NC_NAME_RE=new RegExp("^["+exports.NC_NAME_START_CHAR+"]["+exports.NC_NAME_CHAR+"]*$","u");function isNCNameStartChar(c){return c>=65&&c<=90||c===95||c>=97&&c<=122||c>=192&&c<=214||c>=216&&c<=246||c>=248&&c<=767||c>=880&&c<=893||c>=895&&c<=8191||c>=8204&&c<=8205||c>=8304&&c<=8591||c>=11264&&c<=12271||c>=12289&&c<=55295||c>=63744&&c<=64975||c>=65008&&c<=65533||c>=65536&&c<=983039}exports.isNCNameStartChar=isNCNameStartChar;function isNCNameChar(c){return isNCNameStartChar(c)||c===45||c===46||c>=48&&c<=57||c===183||c>=768&&c<=879||c>=8255&&c<=8256}exports.isNCNameChar=isNCNameChar}});// node_modules/saxes/saxes.js
var require_saxes=__commonJS({"node_modules/saxes/saxes.js":function node_modulesSaxesSaxesJs(exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SaxesParser=exports.EVENTS=void 0;var ed5=require_ed5();var ed2=require_ed2();var NSed3=require_ed3();var isS=ed5.isS;var isChar10=ed5.isChar;var isNameStartChar=ed5.isNameStartChar;var isNameChar=ed5.isNameChar;var S_LIST=ed5.S_LIST;var NAME_RE=ed5.NAME_RE;var isChar11=ed2.isChar;var isNCNameStartChar=NSed3.isNCNameStartChar;var isNCNameChar=NSed3.isNCNameChar;var NC_NAME_RE=NSed3.NC_NAME_RE;var XML_NAMESPACE="http://www.w3.org/XML/1998/namespace";var XMLNS_NAMESPACE="http://www.w3.org/2000/xmlns/";var rootNS={__proto__:null,xml:XML_NAMESPACE,xmlns:XMLNS_NAMESPACE};var XML_ENTITIES={__proto__:null,amp:"&",gt:">",lt:"<",quot:"\"",apos:"'"};var EOC=-1;var NL_LIKE=-2;var S_BEGIN=0;var S_BEGIN_WHITESPACE=1;var S_DOCTYPE=2;var S_DOCTYPE_QUOTE=3;var S_DTD=4;var S_DTD_QUOTED=5;var S_DTD_OPEN_WAKA=6;var S_DTD_OPEN_WAKA_BANG=7;var S_DTD_COMMENT=8;var S_DTD_COMMENT_ENDING=9;var S_DTD_COMMENT_ENDED=10;var S_DTD_PI=11;var S_DTD_PI_ENDING=12;var S_TEXT=13;var S_ENTITY=14;var S_OPEN_WAKA=15;var S_OPEN_WAKA_BANG=16;var S_COMMENT=17;var S_COMMENT_ENDING=18;var S_COMMENT_ENDED=19;var S_CDATA=20;var S_CDATA_ENDING=21;var S_CDATA_ENDING_2=22;var S_PI_FIRST_CHAR=23;var S_PI_REST=24;var S_PI_BODY=25;var S_PI_ENDING=26;var S_XML_DECL_NAME_START=27;var S_XML_DECL_NAME=28;var S_XML_DECL_EQ=29;var S_XML_DECL_VALUE_START=30;var S_XML_DECL_VALUE=31;var S_XML_DECL_SEPARATOR=32;var S_XML_DECL_ENDING=33;var S_OPEN_TAG=34;var S_OPEN_TAG_SLASH=35;var S_ATTRIB=36;var S_ATTRIB_NAME=37;var S_ATTRIB_NAME_SAW_WHITE=38;var S_ATTRIB_VALUE=39;var S_ATTRIB_VALUE_QUOTED=40;var S_ATTRIB_VALUE_CLOSED=41;var S_ATTRIB_VALUE_UNQUOTED=42;var S_CLOSE_TAG=43;var S_CLOSE_TAG_SAW_WHITE=44;var TAB=9;var NL=10;var CR=13;var SPACE=32;var BANG=33;var DQUOTE=34;var AMP=38;var SQUOTE=39;var MINUS=45;var FORWARD_SLASH=47;var SEMICOLON=59;var LESS=60;var EQUAL=61;var GREATER=62;var QUESTION=63;var OPEN_BRACKET=91;var CLOSE_BRACKET=93;var NEL=133;var LS=8232;var isQuote=function isQuote(c){return c===DQUOTE||c===SQUOTE};var QUOTES=[DQUOTE,SQUOTE];var DOCTYPE_TERMINATOR=[].concat(QUOTES,[OPEN_BRACKET,GREATER]);var DTD_TERMINATOR=[].concat(QUOTES,[LESS,CLOSE_BRACKET]);var XML_DECL_NAME_TERMINATOR=[EQUAL,QUESTION].concat(_toConsumableArray(S_LIST));var ATTRIB_VALUE_UNQUOTED_TERMINATOR=[].concat(_toConsumableArray(S_LIST),[GREATER,AMP,LESS]);function nsPairCheck(parser,prefix,uri){switch(prefix){case"xml":if(uri!==XML_NAMESPACE){parser.fail("xml prefix must be bound to ".concat(XML_NAMESPACE,"."))}break;case"xmlns":if(uri!==XMLNS_NAMESPACE){parser.fail("xmlns prefix must be bound to ".concat(XMLNS_NAMESPACE,"."))}break;default:}switch(uri){case XMLNS_NAMESPACE:parser.fail(prefix===""?"the default namespace may not be set to ".concat(uri,"."):"may not assign a prefix (even \"xmlns\") to the URI ".concat(XMLNS_NAMESPACE,"."));break;case XML_NAMESPACE:switch(prefix){case"xml":break;case"":parser.fail("the default namespace may not be set to ".concat(uri,"."));break;default:parser.fail("may not assign the xml namespace to another prefix.");}break;default:}}function nsMappingCheck(parser,mapping){for(var _i=0,_Object$keys=Object.keys(mapping);_i<_Object$keys.length;_i++){var local=_Object$keys[_i];nsPairCheck(parser,local,mapping[local])}}var isNCName=function isNCName(name){return NC_NAME_RE.test(name)};var isName=function isName(name){return NAME_RE.test(name)};var FORBIDDEN_START=0;var FORBIDDEN_BRACKET=1;var FORBIDDEN_BRACKET_BRACKET=2;exports.EVENTS=["xmldecl","text","processinginstruction","doctype","comment","opentagstart","attribute","opentag","closetag","cdata","error","end","ready"];var EVENT_NAME_TO_HANDLER_NAME={xmldecl:"xmldeclHandler",text:"textHandler",processinginstruction:"piHandler",doctype:"doctypeHandler",comment:"commentHandler",opentagstart:"openTagStartHandler",attribute:"attributeHandler",opentag:"openTagHandler",closetag:"closeTagHandler",cdata:"cdataHandler",error:"errorHandler",end:"endHandler",ready:"readyHandler"};var SaxesParser2=/*#__PURE__*/function(){function SaxesParser2(opt){_classCallCheck(this,SaxesParser2);this.opt=opt!==null&&opt!==void 0?opt:{};this.fragmentOpt=!!this.opt.fragment;var xmlnsOpt=this.xmlnsOpt=!!this.opt.xmlns;this.trackPosition=this.opt.position!==false;this.fileName=this.opt.fileName;if(xmlnsOpt){this.nameStartCheck=isNCNameStartChar;this.nameCheck=isNCNameChar;this.isName=isNCName;this.processAttribs=this.processAttribsNS;this.pushAttrib=this.pushAttribNS;this.ns=Object.assign({__proto__:null},rootNS);var additional=this.opt.additionalNamespaces;if(additional!=null){nsMappingCheck(this,additional);Object.assign(this.ns,additional)}}else{this.nameStartCheck=isNameStartChar;this.nameCheck=isNameChar;this.isName=isName;this.processAttribs=this.processAttribsPlain;this.pushAttrib=this.pushAttribPlain}this.stateTable=[this.sBegin,this.sBeginWhitespace,this.sDoctype,this.sDoctypeQuote,this.sDTD,this.sDTDQuoted,this.sDTDOpenWaka,this.sDTDOpenWakaBang,this.sDTDComment,this.sDTDCommentEnding,this.sDTDCommentEnded,this.sDTDPI,this.sDTDPIEnding,this.sText,this.sEntity,this.sOpenWaka,this.sOpenWakaBang,this.sComment,this.sCommentEnding,this.sCommentEnded,this.sCData,this.sCDataEnding,this.sCDataEnding2,this.sPIFirstChar,this.sPIRest,this.sPIBody,this.sPIEnding,this.sXMLDeclNameStart,this.sXMLDeclName,this.sXMLDeclEq,this.sXMLDeclValueStart,this.sXMLDeclValue,this.sXMLDeclSeparator,this.sXMLDeclEnding,this.sOpenTag,this.sOpenTagSlash,this.sAttrib,this.sAttribName,this.sAttribNameSawWhite,this.sAttribValue,this.sAttribValueQuoted,this.sAttribValueClosed,this.sAttribValueUnquoted,this.sCloseTag,this.sCloseTagSawWhite];this._init()}_createClass(SaxesParser2,[{key:"closed",get:function get(){return this._closed}},{key:"_init",value:function _init(){var _a2;this.openWakaBang="";this.text="";this.name="";this.piTarget="";this.entity="";this.q=null;this.tags=[];this.tag=null;this.topNS=null;this.chunk="";this.chunkPosition=0;this.i=0;this.prevI=0;this.carriedFromPrevious=void 0;this.forbiddenState=FORBIDDEN_START;this.attribList=[];var fragmentOpt=this.fragmentOpt;this.state=fragmentOpt?S_TEXT:S_BEGIN;this.reportedTextBeforeRoot=this.reportedTextAfterRoot=this.closedRoot=this.sawRoot=fragmentOpt;this.xmlDeclPossible=!fragmentOpt;this.xmlDeclExpects=["version"];this.entityReturnState=void 0;var defaultXMLVersion=this.opt.defaultXMLVersion;if(defaultXMLVersion===void 0){if(this.opt.forceXMLVersion===true){throw new Error("forceXMLVersion set but defaultXMLVersion is not set")}defaultXMLVersion="1.0"}this.setXMLVersion(defaultXMLVersion);this.positionAtNewLine=0;this.doctype=false;this._closed=false;this.xmlDecl={version:void 0,encoding:void 0,standalone:void 0};this.line=1;this.column=0;this.ENTITIES=Object.create(XML_ENTITIES);(_a2=this.readyHandler)===null||_a2===void 0?void 0:_a2.call(this)}},{key:"position",get:function get(){return this.chunkPosition+this.i}},{key:"columnIndex",get:function get(){return this.position-this.positionAtNewLine}},{key:"on",value:function on(name,handler){this[EVENT_NAME_TO_HANDLER_NAME[name]]=handler}},{key:"off",value:function off(name){this[EVENT_NAME_TO_HANDLER_NAME[name]]=void 0}},{key:"makeError",value:function makeError(message){var _a2;var msg=(_a2=this.fileName)!==null&&_a2!==void 0?_a2:"";if(this.trackPosition){if(msg.length>0){msg+=":"}msg+="".concat(this.line,":").concat(this.column)}if(msg.length>0){msg+=": "}return new Error(msg+message)}},{key:"fail",value:function fail(message){var err2=this.makeError(message);var handler=this.errorHandler;if(handler===void 0){throw err2}else{handler(err2)}return this}},{key:"write",value:function write(chunk){if(this.closed){return this.fail("cannot write after close; assign an onready handler.")}var end=false;if(chunk===null){end=true;chunk=""}else if(_typeof(chunk)==="object"){chunk=chunk.toString()}if(this.carriedFromPrevious!==void 0){chunk="".concat(this.carriedFromPrevious).concat(chunk);this.carriedFromPrevious=void 0}var limit=chunk.length;var lastCode=chunk.charCodeAt(limit-1);if(!end&&(lastCode===CR||lastCode>=55296&&lastCode<=56319)){this.carriedFromPrevious=chunk[limit-1];limit--;chunk=chunk.slice(0,limit)}var stateTable=this.stateTable;this.chunk=chunk;this.i=0;while(this.i<limit){stateTable[this.state].call(this)}this.chunkPosition+=limit;return end?this.end():this}},{key:"close",value:function close(){return this.write(null)}},{key:"getCode10",value:function getCode10(){var chunk=this.chunk,i=this.i;this.prevI=i;this.i=i+1;if(i>=chunk.length){return EOC}var code=chunk.charCodeAt(i);this.column++;if(code<55296){if(code>=SPACE||code===TAB){return code}switch(code){case NL:this.line++;this.column=0;this.positionAtNewLine=this.position;return NL;case CR:if(chunk.charCodeAt(i+1)===NL){this.i=i+2}this.line++;this.column=0;this.positionAtNewLine=this.position;return NL_LIKE;default:this.fail("disallowed character.");return code;}}if(code>56319){if(!(code>=57344&&code<=65533)){this.fail("disallowed character.")}return code}var _final=65536+(code-55296)*1024+(chunk.charCodeAt(i+1)-56320);this.i=i+2;if(_final>1114111){this.fail("disallowed character.")}return _final}},{key:"getCode11",value:function getCode11(){var chunk=this.chunk,i=this.i;this.prevI=i;this.i=i+1;if(i>=chunk.length){return EOC}var code=chunk.charCodeAt(i);this.column++;if(code<55296){if(code>31&&code<127||code>159&&code!==LS||code===TAB){return code}switch(code){case NL:this.line++;this.column=0;this.positionAtNewLine=this.position;return NL;case CR:{var next=chunk.charCodeAt(i+1);if(next===NL||next===NEL){this.i=i+2}}case NEL:case LS:this.line++;this.column=0;this.positionAtNewLine=this.position;return NL_LIKE;default:this.fail("disallowed character.");return code;}}if(code>56319){if(!(code>=57344&&code<=65533)){this.fail("disallowed character.")}return code}var _final2=65536+(code-55296)*1024+(chunk.charCodeAt(i+1)-56320);this.i=i+2;if(_final2>1114111){this.fail("disallowed character.")}return _final2}},{key:"getCodeNorm",value:function getCodeNorm(){var c=this.getCode();return c===NL_LIKE?NL:c}},{key:"unget",value:function unget(){this.i=this.prevI;this.column--}},{key:"captureTo",value:function captureTo(chars){var start=this.i;var chunk=this.chunk;while(true){var c=this.getCode();var isNLLike=c===NL_LIKE;var _final3=isNLLike?NL:c;if(_final3===EOC||chars.includes(_final3)){this.text+=chunk.slice(start,this.prevI);return _final3}if(isNLLike){this.text+="".concat(chunk.slice(start,this.prevI),"\n");start=this.i}}}},{key:"captureToChar",value:function captureToChar(_char){var start=this.i;var chunk=this.chunk;while(true){var c=this.getCode();switch(c){case NL_LIKE:this.text+="".concat(chunk.slice(start,this.prevI),"\n");start=this.i;c=NL;break;case EOC:this.text+=chunk.slice(start);return false;default:}if(c===_char){this.text+=chunk.slice(start,this.prevI);return true}}}},{key:"captureNameChars",value:function captureNameChars(){var chunk=this.chunk,start=this.i;while(true){var c=this.getCode();if(c===EOC){this.name+=chunk.slice(start);return EOC}if(!isNameChar(c)){this.name+=chunk.slice(start,this.prevI);return c===NL_LIKE?NL:c}}}},{key:"skipSpaces",value:function skipSpaces(){while(true){var c=this.getCodeNorm();if(c===EOC||!isS(c)){return c}}}},{key:"setXMLVersion",value:function setXMLVersion(version){this.currentXMLVersion=version;if(version==="1.0"){this.isChar=isChar10;this.getCode=this.getCode10}else{this.isChar=isChar11;this.getCode=this.getCode11}}},{key:"sBegin",value:function sBegin(){if(this.chunk.charCodeAt(0)===65279){this.i++;this.column++}this.state=S_BEGIN_WHITESPACE}},{key:"sBeginWhitespace",value:function sBeginWhitespace(){var iBefore=this.i;var c=this.skipSpaces();if(this.prevI!==iBefore){this.xmlDeclPossible=false}switch(c){case LESS:this.state=S_OPEN_WAKA;if(this.text.length!==0){throw new Error("no-empty text at start")}break;case EOC:break;default:this.unget();this.state=S_TEXT;this.xmlDeclPossible=false;}}},{key:"sDoctype",value:function sDoctype(){var _a2;var c=this.captureTo(DOCTYPE_TERMINATOR);switch(c){case GREATER:{(_a2=this.doctypeHandler)===null||_a2===void 0?void 0:_a2.call(this,this.text);this.text="";this.state=S_TEXT;this.doctype=true;break}case EOC:break;default:this.text+=String.fromCodePoint(c);if(c===OPEN_BRACKET){this.state=S_DTD}else if(isQuote(c)){this.state=S_DOCTYPE_QUOTE;this.q=c}}}},{key:"sDoctypeQuote",value:function sDoctypeQuote(){var q=this.q;if(this.captureToChar(q)){this.text+=String.fromCodePoint(q);this.q=null;this.state=S_DOCTYPE}}},{key:"sDTD",value:function sDTD(){var c=this.captureTo(DTD_TERMINATOR);if(c===EOC){return}this.text+=String.fromCodePoint(c);if(c===CLOSE_BRACKET){this.state=S_DOCTYPE}else if(c===LESS){this.state=S_DTD_OPEN_WAKA}else if(isQuote(c)){this.state=S_DTD_QUOTED;this.q=c}}},{key:"sDTDQuoted",value:function sDTDQuoted(){var q=this.q;if(this.captureToChar(q)){this.text+=String.fromCodePoint(q);this.state=S_DTD;this.q=null}}},{key:"sDTDOpenWaka",value:function sDTDOpenWaka(){var c=this.getCodeNorm();this.text+=String.fromCodePoint(c);switch(c){case BANG:this.state=S_DTD_OPEN_WAKA_BANG;this.openWakaBang="";break;case QUESTION:this.state=S_DTD_PI;break;default:this.state=S_DTD;}}},{key:"sDTDOpenWakaBang",value:function sDTDOpenWakaBang(){var _char2=String.fromCodePoint(this.getCodeNorm());var owb=this.openWakaBang+=_char2;this.text+=_char2;if(owb!=="-"){this.state=owb==="--"?S_DTD_COMMENT:S_DTD;this.openWakaBang=""}}},{key:"sDTDComment",value:function sDTDComment(){if(this.captureToChar(MINUS)){this.text+="-";this.state=S_DTD_COMMENT_ENDING}}},{key:"sDTDCommentEnding",value:function sDTDCommentEnding(){var c=this.getCodeNorm();this.text+=String.fromCodePoint(c);this.state=c===MINUS?S_DTD_COMMENT_ENDED:S_DTD_COMMENT}},{key:"sDTDCommentEnded",value:function sDTDCommentEnded(){var c=this.getCodeNorm();this.text+=String.fromCodePoint(c);if(c===GREATER){this.state=S_DTD}else{this.fail("malformed comment.");this.state=S_DTD_COMMENT}}},{key:"sDTDPI",value:function sDTDPI(){if(this.captureToChar(QUESTION)){this.text+="?";this.state=S_DTD_PI_ENDING}}},{key:"sDTDPIEnding",value:function sDTDPIEnding(){var c=this.getCodeNorm();this.text+=String.fromCodePoint(c);if(c===GREATER){this.state=S_DTD}}},{key:"sText",value:function sText(){if(this.tags.length!==0){this.handleTextInRoot()}else{this.handleTextOutsideRoot()}}},{key:"sEntity",value:function sEntity(){var start=this.i;var chunk=this.chunk;loop:while(true){switch(this.getCode()){case NL_LIKE:this.entity+="".concat(chunk.slice(start,this.prevI),"\n");start=this.i;break;case SEMICOLON:{var entityReturnState=this.entityReturnState;var entity=this.entity+chunk.slice(start,this.prevI);this.state=entityReturnState;var parsed=void 0;if(entity===""){this.fail("empty entity name.");parsed="&;"}else{parsed=this.parseEntity(entity);this.entity=""}if(entityReturnState!==S_TEXT||this.textHandler!==void 0){this.text+=parsed}break loop}case EOC:this.entity+=chunk.slice(start);break loop;default:}}}},{key:"sOpenWaka",value:function sOpenWaka(){var c=this.getCode();if(isNameStartChar(c)){this.state=S_OPEN_TAG;this.unget();this.xmlDeclPossible=false}else{switch(c){case FORWARD_SLASH:this.state=S_CLOSE_TAG;this.xmlDeclPossible=false;break;case BANG:this.state=S_OPEN_WAKA_BANG;this.openWakaBang="";this.xmlDeclPossible=false;break;case QUESTION:this.state=S_PI_FIRST_CHAR;break;default:this.fail("disallowed character in tag name");this.state=S_TEXT;this.xmlDeclPossible=false;}}}},{key:"sOpenWakaBang",value:function sOpenWakaBang(){this.openWakaBang+=String.fromCodePoint(this.getCodeNorm());switch(this.openWakaBang){case"[CDATA[":if(!this.sawRoot&&!this.reportedTextBeforeRoot){this.fail("text data outside of root node.");this.reportedTextBeforeRoot=true}if(this.closedRoot&&!this.reportedTextAfterRoot){this.fail("text data outside of root node.");this.reportedTextAfterRoot=true}this.state=S_CDATA;this.openWakaBang="";break;case"--":this.state=S_COMMENT;this.openWakaBang="";break;case"DOCTYPE":this.state=S_DOCTYPE;if(this.doctype||this.sawRoot){this.fail("inappropriately located doctype declaration.")}this.openWakaBang="";break;default:if(this.openWakaBang.length>=7){this.fail("incorrect syntax.")}}}},{key:"sComment",value:function sComment(){if(this.captureToChar(MINUS)){this.state=S_COMMENT_ENDING}}},{key:"sCommentEnding",value:function sCommentEnding(){var _a2;var c=this.getCodeNorm();if(c===MINUS){this.state=S_COMMENT_ENDED;(_a2=this.commentHandler)===null||_a2===void 0?void 0:_a2.call(this,this.text);this.text=""}else{this.text+="-".concat(String.fromCodePoint(c));this.state=S_COMMENT}}},{key:"sCommentEnded",value:function sCommentEnded(){var c=this.getCodeNorm();if(c!==GREATER){this.fail("malformed comment.");this.text+="--".concat(String.fromCodePoint(c));this.state=S_COMMENT}else{this.state=S_TEXT}}},{key:"sCData",value:function sCData(){if(this.captureToChar(CLOSE_BRACKET)){this.state=S_CDATA_ENDING}}},{key:"sCDataEnding",value:function sCDataEnding(){var c=this.getCodeNorm();if(c===CLOSE_BRACKET){this.state=S_CDATA_ENDING_2}else{this.text+="]".concat(String.fromCodePoint(c));this.state=S_CDATA}}},{key:"sCDataEnding2",value:function sCDataEnding2(){var _a2;var c=this.getCodeNorm();switch(c){case GREATER:{(_a2=this.cdataHandler)===null||_a2===void 0?void 0:_a2.call(this,this.text);this.text="";this.state=S_TEXT;break}case CLOSE_BRACKET:this.text+="]";break;default:this.text+="]]".concat(String.fromCodePoint(c));this.state=S_CDATA;}}},{key:"sPIFirstChar",value:function sPIFirstChar(){var c=this.getCodeNorm();if(this.nameStartCheck(c)){this.piTarget+=String.fromCodePoint(c);this.state=S_PI_REST}else if(c===QUESTION||isS(c)){this.fail("processing instruction without a target.");this.state=c===QUESTION?S_PI_ENDING:S_PI_BODY}else{this.fail("disallowed character in processing instruction name.");this.piTarget+=String.fromCodePoint(c);this.state=S_PI_REST}}},{key:"sPIRest",value:function sPIRest(){var chunk=this.chunk,start=this.i;while(true){var c=this.getCodeNorm();if(c===EOC){this.piTarget+=chunk.slice(start);return}if(!this.nameCheck(c)){this.piTarget+=chunk.slice(start,this.prevI);var isQuestion=c===QUESTION;if(isQuestion||isS(c)){if(this.piTarget==="xml"){if(!this.xmlDeclPossible){this.fail("an XML declaration must be at the start of the document.")}this.state=isQuestion?S_XML_DECL_ENDING:S_XML_DECL_NAME_START}else{this.state=isQuestion?S_PI_ENDING:S_PI_BODY}}else{this.fail("disallowed character in processing instruction name.");this.piTarget+=String.fromCodePoint(c)}break}}}},{key:"sPIBody",value:function sPIBody(){if(this.text.length===0){var c=this.getCodeNorm();if(c===QUESTION){this.state=S_PI_ENDING}else if(!isS(c)){this.text=String.fromCodePoint(c)}}else if(this.captureToChar(QUESTION)){this.state=S_PI_ENDING}}},{key:"sPIEnding",value:function sPIEnding(){var _a2;var c=this.getCodeNorm();if(c===GREATER){var piTarget=this.piTarget;if(piTarget.toLowerCase()==="xml"){this.fail("the XML declaration must appear at the start of the document.")}(_a2=this.piHandler)===null||_a2===void 0?void 0:_a2.call(this,{target:piTarget,body:this.text});this.piTarget=this.text="";this.state=S_TEXT}else if(c===QUESTION){this.text+="?"}else{this.text+="?".concat(String.fromCodePoint(c));this.state=S_PI_BODY}this.xmlDeclPossible=false}},{key:"sXMLDeclNameStart",value:function sXMLDeclNameStart(){var c=this.skipSpaces();if(c===QUESTION){this.state=S_XML_DECL_ENDING;return}if(c!==EOC){this.state=S_XML_DECL_NAME;this.name=String.fromCodePoint(c)}}},{key:"sXMLDeclName",value:function sXMLDeclName(){var c=this.captureTo(XML_DECL_NAME_TERMINATOR);if(c===QUESTION){this.state=S_XML_DECL_ENDING;this.name+=this.text;this.text="";this.fail("XML declaration is incomplete.");return}if(!(isS(c)||c===EQUAL)){return}this.name+=this.text;this.text="";if(!this.xmlDeclExpects.includes(this.name)){switch(this.name.length){case 0:this.fail("did not expect any more name/value pairs.");break;case 1:this.fail("expected the name ".concat(this.xmlDeclExpects[0],"."));break;default:this.fail("expected one of ".concat(this.xmlDeclExpects.join(", ")));}}this.state=c===EQUAL?S_XML_DECL_VALUE_START:S_XML_DECL_EQ}},{key:"sXMLDeclEq",value:function sXMLDeclEq(){var c=this.getCodeNorm();if(c===QUESTION){this.state=S_XML_DECL_ENDING;this.fail("XML declaration is incomplete.");return}if(isS(c)){return}if(c!==EQUAL){this.fail("value required.")}this.state=S_XML_DECL_VALUE_START}},{key:"sXMLDeclValueStart",value:function sXMLDeclValueStart(){var c=this.getCodeNorm();if(c===QUESTION){this.state=S_XML_DECL_ENDING;this.fail("XML declaration is incomplete.");return}if(isS(c)){return}if(!isQuote(c)){this.fail("value must be quoted.");this.q=SPACE}else{this.q=c}this.state=S_XML_DECL_VALUE}},{key:"sXMLDeclValue",value:function sXMLDeclValue(){var c=this.captureTo([this.q,QUESTION]);if(c===QUESTION){this.state=S_XML_DECL_ENDING;this.text="";this.fail("XML declaration is incomplete.");return}if(c===EOC){return}var value=this.text;this.text="";switch(this.name){case"version":{this.xmlDeclExpects=["encoding","standalone"];var version=value;this.xmlDecl.version=version;if(!/^1\.[0-9]+$/.test(version)){this.fail("version number must match /^1\\.[0-9]+$/.")}else if(!this.opt.forceXMLVersion){this.setXMLVersion(version)}break}case"encoding":if(!/^[A-Za-z][A-Za-z0-9._-]*$/.test(value)){this.fail("encoding value must match /^[A-Za-z0-9][A-Za-z0-9._-]*$/.")}this.xmlDeclExpects=["standalone"];this.xmlDecl.encoding=value;break;case"standalone":if(value!=="yes"&&value!=="no"){this.fail("standalone value must match \"yes\" or \"no\".")}this.xmlDeclExpects=[];this.xmlDecl.standalone=value;break;default:}this.name="";this.state=S_XML_DECL_SEPARATOR}},{key:"sXMLDeclSeparator",value:function sXMLDeclSeparator(){var c=this.getCodeNorm();if(c===QUESTION){this.state=S_XML_DECL_ENDING;return}if(!isS(c)){this.fail("whitespace required.");this.unget()}this.state=S_XML_DECL_NAME_START}},{key:"sXMLDeclEnding",value:function sXMLDeclEnding(){var _a2;var c=this.getCodeNorm();if(c===GREATER){if(this.piTarget!=="xml"){this.fail("processing instructions are not allowed before root.")}else if(this.name!=="version"&&this.xmlDeclExpects.includes("version")){this.fail("XML declaration must contain a version.")}(_a2=this.xmldeclHandler)===null||_a2===void 0?void 0:_a2.call(this,this.xmlDecl);this.name="";this.piTarget=this.text="";this.state=S_TEXT}else{this.fail("The character ? is disallowed anywhere in XML declarations.")}this.xmlDeclPossible=false}},{key:"sOpenTag",value:function sOpenTag(){var _a2;var c=this.captureNameChars();if(c===EOC){return}var tag=this.tag={name:this.name,attributes:/* @__PURE__ */Object.create(null)};this.name="";if(this.xmlnsOpt){this.topNS=tag.ns=/* @__PURE__ */Object.create(null)}(_a2=this.openTagStartHandler)===null||_a2===void 0?void 0:_a2.call(this,tag);this.sawRoot=true;if(!this.fragmentOpt&&this.closedRoot){this.fail("documents may contain only one root.")}switch(c){case GREATER:this.openTag();break;case FORWARD_SLASH:this.state=S_OPEN_TAG_SLASH;break;default:if(!isS(c)){this.fail("disallowed character in tag name.")}this.state=S_ATTRIB;}}},{key:"sOpenTagSlash",value:function sOpenTagSlash(){if(this.getCode()===GREATER){this.openSelfClosingTag()}else{this.fail("forward-slash in opening tag not followed by >.");this.state=S_ATTRIB}}},{key:"sAttrib",value:function sAttrib(){var c=this.skipSpaces();if(c===EOC){return}if(isNameStartChar(c)){this.unget();this.state=S_ATTRIB_NAME}else if(c===GREATER){this.openTag()}else if(c===FORWARD_SLASH){this.state=S_OPEN_TAG_SLASH}else{this.fail("disallowed character in attribute name.")}}},{key:"sAttribName",value:function sAttribName(){var c=this.captureNameChars();if(c===EQUAL){this.state=S_ATTRIB_VALUE}else if(isS(c)){this.state=S_ATTRIB_NAME_SAW_WHITE}else if(c===GREATER){this.fail("attribute without value.");this.pushAttrib(this.name,this.name);this.name=this.text="";this.openTag()}else if(c!==EOC){this.fail("disallowed character in attribute name.")}}},{key:"sAttribNameSawWhite",value:function sAttribNameSawWhite(){var c=this.skipSpaces();switch(c){case EOC:return;case EQUAL:this.state=S_ATTRIB_VALUE;break;default:this.fail("attribute without value.");this.text="";this.name="";if(c===GREATER){this.openTag()}else if(isNameStartChar(c)){this.unget();this.state=S_ATTRIB_NAME}else{this.fail("disallowed character in attribute name.");this.state=S_ATTRIB}}}},{key:"sAttribValue",value:function sAttribValue(){var c=this.getCodeNorm();if(isQuote(c)){this.q=c;this.state=S_ATTRIB_VALUE_QUOTED}else if(!isS(c)){this.fail("unquoted attribute value.");this.state=S_ATTRIB_VALUE_UNQUOTED;this.unget()}}},{key:"sAttribValueQuoted",value:function sAttribValueQuoted(){var q=this.q,chunk=this.chunk;var start=this.i;while(true){switch(this.getCode()){case q:this.pushAttrib(this.name,this.text+chunk.slice(start,this.prevI));this.name=this.text="";this.q=null;this.state=S_ATTRIB_VALUE_CLOSED;return;case AMP:this.text+=chunk.slice(start,this.prevI);this.state=S_ENTITY;this.entityReturnState=S_ATTRIB_VALUE_QUOTED;return;case NL:case NL_LIKE:case TAB:this.text+="".concat(chunk.slice(start,this.prevI)," ");start=this.i;break;case LESS:this.text+=chunk.slice(start,this.prevI);this.fail("disallowed character.");return;case EOC:this.text+=chunk.slice(start);return;default:}}}},{key:"sAttribValueClosed",value:function sAttribValueClosed(){var c=this.getCodeNorm();if(isS(c)){this.state=S_ATTRIB}else if(c===GREATER){this.openTag()}else if(c===FORWARD_SLASH){this.state=S_OPEN_TAG_SLASH}else if(isNameStartChar(c)){this.fail("no whitespace between attributes.");this.unget();this.state=S_ATTRIB_NAME}else{this.fail("disallowed character in attribute name.")}}},{key:"sAttribValueUnquoted",value:function sAttribValueUnquoted(){var c=this.captureTo(ATTRIB_VALUE_UNQUOTED_TERMINATOR);switch(c){case AMP:this.state=S_ENTITY;this.entityReturnState=S_ATTRIB_VALUE_UNQUOTED;break;case LESS:this.fail("disallowed character.");break;case EOC:break;default:if(this.text.includes("]]>")){this.fail("the string \"]]>\" is disallowed in char data.")}this.pushAttrib(this.name,this.text);this.name=this.text="";if(c===GREATER){this.openTag()}else{this.state=S_ATTRIB}}}},{key:"sCloseTag",value:function sCloseTag(){var c=this.captureNameChars();if(c===GREATER){this.closeTag()}else if(isS(c)){this.state=S_CLOSE_TAG_SAW_WHITE}else if(c!==EOC){this.fail("disallowed character in closing tag.")}}},{key:"sCloseTagSawWhite",value:function sCloseTagSawWhite(){switch(this.skipSpaces()){case GREATER:this.closeTag();break;case EOC:break;default:this.fail("disallowed character in closing tag.");}}},{key:"handleTextInRoot",value:function handleTextInRoot(){var start=this.i,forbiddenState=this.forbiddenState;var chunk=this.chunk,handler=this.textHandler;scanLoop:while(true){switch(this.getCode()){case LESS:{this.state=S_OPEN_WAKA;if(handler!==void 0){var text=this.text;var slice=chunk.slice(start,this.prevI);if(text.length!==0){handler(text+slice);this.text=""}else if(slice.length!==0){handler(slice)}}forbiddenState=FORBIDDEN_START;break scanLoop}case AMP:this.state=S_ENTITY;this.entityReturnState=S_TEXT;if(handler!==void 0){this.text+=chunk.slice(start,this.prevI)}forbiddenState=FORBIDDEN_START;break scanLoop;case CLOSE_BRACKET:switch(forbiddenState){case FORBIDDEN_START:forbiddenState=FORBIDDEN_BRACKET;break;case FORBIDDEN_BRACKET:forbiddenState=FORBIDDEN_BRACKET_BRACKET;break;case FORBIDDEN_BRACKET_BRACKET:break;default:throw new Error("impossible state");}break;case GREATER:if(forbiddenState===FORBIDDEN_BRACKET_BRACKET){this.fail("the string \"]]>\" is disallowed in char data.")}forbiddenState=FORBIDDEN_START;break;case NL_LIKE:if(handler!==void 0){this.text+="".concat(chunk.slice(start,this.prevI),"\n")}start=this.i;forbiddenState=FORBIDDEN_START;break;case EOC:if(handler!==void 0){this.text+=chunk.slice(start)}break scanLoop;default:forbiddenState=FORBIDDEN_START;}}this.forbiddenState=forbiddenState}},{key:"handleTextOutsideRoot",value:function handleTextOutsideRoot(){var start=this.i;var chunk=this.chunk,handler=this.textHandler;var nonSpace=false;outRootLoop:while(true){var code=this.getCode();switch(code){case LESS:{this.state=S_OPEN_WAKA;if(handler!==void 0){var text=this.text;var slice=chunk.slice(start,this.prevI);if(text.length!==0){handler(text+slice);this.text=""}else if(slice.length!==0){handler(slice)}}break outRootLoop}case AMP:this.state=S_ENTITY;this.entityReturnState=S_TEXT;if(handler!==void 0){this.text+=chunk.slice(start,this.prevI)}nonSpace=true;break outRootLoop;case NL_LIKE:if(handler!==void 0){this.text+="".concat(chunk.slice(start,this.prevI),"\n")}start=this.i;break;case EOC:if(handler!==void 0){this.text+=chunk.slice(start)}break outRootLoop;default:if(!isS(code)){nonSpace=true}}}if(!nonSpace){return}if(!this.sawRoot&&!this.reportedTextBeforeRoot){this.fail("text data outside of root node.");this.reportedTextBeforeRoot=true}if(this.closedRoot&&!this.reportedTextAfterRoot){this.fail("text data outside of root node.");this.reportedTextAfterRoot=true}}},{key:"pushAttribNS",value:function pushAttribNS(name,value){var _a2;var _this$qname=this.qname(name),prefix=_this$qname.prefix,local=_this$qname.local;var attr={name:name,prefix:prefix,local:local,value:value};this.attribList.push(attr);(_a2=this.attributeHandler)===null||_a2===void 0?void 0:_a2.call(this,attr);if(prefix==="xmlns"){var trimmed=value.trim();if(this.currentXMLVersion==="1.0"&&trimmed===""){this.fail("invalid attempt to undefine prefix in XML 1.0")}this.topNS[local]=trimmed;nsPairCheck(this,local,trimmed)}else if(name==="xmlns"){var _trimmed=value.trim();this.topNS[""]=_trimmed;nsPairCheck(this,"",_trimmed)}}},{key:"pushAttribPlain",value:function pushAttribPlain(name,value){var _a2;var attr={name:name,value:value};this.attribList.push(attr);(_a2=this.attributeHandler)===null||_a2===void 0?void 0:_a2.call(this,attr)}},{key:"end",value:function end(){var _a2,_b2;if(!this.sawRoot){this.fail("document must contain a root element.")}var tags=this.tags;while(tags.length>0){var tag=tags.pop();this.fail("unclosed tag: ".concat(tag.name))}if(this.state!==S_BEGIN&&this.state!==S_TEXT){this.fail("unexpected end.")}var text=this.text;if(text.length!==0){(_a2=this.textHandler)===null||_a2===void 0?void 0:_a2.call(this,text);this.text=""}this._closed=true;(_b2=this.endHandler)===null||_b2===void 0?void 0:_b2.call(this);this._init();return this}},{key:"resolve",value:function resolve(prefix){var _a2,_b2;var uri=this.topNS[prefix];if(uri!==void 0){return uri}var tags=this.tags;for(var index=tags.length-1;index>=0;index--){uri=tags[index].ns[prefix];if(uri!==void 0){return uri}}uri=this.ns[prefix];if(uri!==void 0){return uri}return(_b2=(_a2=this.opt).resolvePrefix)===null||_b2===void 0?void 0:_b2.call(_a2,prefix)}},{key:"qname",value:function qname(name){var colon=name.indexOf(":");if(colon===-1){return{prefix:"",local:name}}var local=name.slice(colon+1);var prefix=name.slice(0,colon);if(prefix===""||local===""||local.includes(":")){this.fail("malformed name: ".concat(name,"."))}return{prefix:prefix,local:local}}},{key:"processAttribsNS",value:function processAttribsNS(){var _a2;var attribList=this.attribList;var tag=this.tag;{var _this$qname2=this.qname(tag.name),prefix=_this$qname2.prefix,local=_this$qname2.local;tag.prefix=prefix;tag.local=local;var uri=tag.uri=(_a2=this.resolve(prefix))!==null&&_a2!==void 0?_a2:"";if(prefix!==""){if(prefix==="xmlns"){this.fail("tags may not have \"xmlns\" as prefix.")}if(uri===""){this.fail("unbound namespace prefix: ".concat(JSON.stringify(prefix),"."));tag.uri=prefix}}}if(attribList.length===0){return}var attributes=tag.attributes;var seen=/* @__PURE__ */new Set;var _iterator2=_createForOfIteratorHelper(attribList),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var attr=_step2.value;var name=attr.name,_prefix=attr.prefix,_local=attr.local;var uri=void 0;var eqname=void 0;if(_prefix===""){uri=name==="xmlns"?XMLNS_NAMESPACE:"";eqname=name}else{uri=this.resolve(_prefix);if(uri===void 0){this.fail("unbound namespace prefix: ".concat(JSON.stringify(_prefix),"."));uri=_prefix}eqname="{".concat(uri,"}").concat(_local)}if(seen.has(eqname)){this.fail("duplicate attribute: ".concat(eqname,"."))}seen.add(eqname);attr.uri=uri;attributes[name]=attr}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}this.attribList=[]}},{key:"processAttribsPlain",value:function processAttribsPlain(){var attribList=this.attribList;var attributes=this.tag.attributes;var _iterator3=_createForOfIteratorHelper(attribList),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var _step3$value=_step3.value,name=_step3$value.name,value=_step3$value.value;if(attributes[name]!==void 0){this.fail("duplicate attribute: ".concat(name,"."))}attributes[name]=value}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}this.attribList=[]}},{key:"openTag",value:function openTag(){var _a2;this.processAttribs();var tags=this.tags;var tag=this.tag;tag.isSelfClosing=false;(_a2=this.openTagHandler)===null||_a2===void 0?void 0:_a2.call(this,tag);tags.push(tag);this.state=S_TEXT;this.name=""}},{key:"openSelfClosingTag",value:function openSelfClosingTag(){var _a2,_b2,_c;this.processAttribs();var tags=this.tags;var tag=this.tag;tag.isSelfClosing=true;(_a2=this.openTagHandler)===null||_a2===void 0?void 0:_a2.call(this,tag);(_b2=this.closeTagHandler)===null||_b2===void 0?void 0:_b2.call(this,tag);var top=this.tag=(_c=tags[tags.length-1])!==null&&_c!==void 0?_c:null;if(top===null){this.closedRoot=true}this.state=S_TEXT;this.name=""}},{key:"closeTag",value:function closeTag(){var tags=this.tags,name=this.name;this.state=S_TEXT;this.name="";if(name===""){this.fail("weird empty close tag.");this.text+="</>";return}var handler=this.closeTagHandler;var l=tags.length;while(l-->0){var tag=this.tag=tags.pop();this.topNS=tag.ns;handler===null||handler===void 0?void 0:handler(tag);if(tag.name===name){break}this.fail("unexpected close tag.")}if(l===0){this.closedRoot=true}else if(l<0){this.fail("unmatched closing tag: ".concat(name,"."));this.text+="</".concat(name,">")}}},{key:"parseEntity",value:function parseEntity(entity){if(entity[0]!=="#"){var defined=this.ENTITIES[entity];if(defined!==void 0){return defined}this.fail(this.isName(entity)?"undefined entity.":"disallowed character in entity name.");return"&".concat(entity,";")}var num=NaN;if(entity[1]==="x"&&/^#x[0-9a-f]+$/i.test(entity)){num=parseInt(entity.slice(2),16)}else if(/^#[0-9]+$/.test(entity)){num=parseInt(entity.slice(1),10)}if(!this.isChar(num)){this.fail("malformed character entity.");return"&".concat(entity,";")}return String.fromCodePoint(num)}}]);return SaxesParser2}();exports.SaxesParser=SaxesParser2}});// node_modules/ssf/ssf.js
var require_ssf=__commonJS({"node_modules/ssf/ssf.js":function node_modulesSsfSsfJs(exports,module){var SSF={};var make_ssf=function make_ssf2(SSF2){SSF2.version="0.11.2";function _strrev(x){var o="",i=x.length-1;while(i>=0){o+=x.charAt(i--)}return o}function fill(c,l){var o="";while(o.length<l){o+=c}return o}function pad0(v,d){var t=""+v;return t.length>=d?t:fill("0",d-t.length)+t}function pad_(v,d){var t=""+v;return t.length>=d?t:fill(" ",d-t.length)+t}function rpad_(v,d){var t=""+v;return t.length>=d?t:t+fill(" ",d-t.length)}function pad0r1(v,d){var t=""+Math.round(v);return t.length>=d?t:fill("0",d-t.length)+t}function pad0r2(v,d){var t=""+v;return t.length>=d?t:fill("0",d-t.length)+t}var p2_32=Math.pow(2,32);function pad0r(v,d){if(v>p2_32||v<-p2_32)return pad0r1(v,d);var i=Math.round(v);return pad0r2(i,d)}function isgeneral(s,i){i=i||0;return s.length>=7+i&&(s.charCodeAt(i)|32)===103&&(s.charCodeAt(i+1)|32)===101&&(s.charCodeAt(i+2)|32)===110&&(s.charCodeAt(i+3)|32)===101&&(s.charCodeAt(i+4)|32)===114&&(s.charCodeAt(i+5)|32)===97&&(s.charCodeAt(i+6)|32)===108}var days=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]];var months=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function init_table(t){t[0]="General";t[1]="0";t[2]="0.00";t[3]="#,##0";t[4]="#,##0.00";t[9]="0%";t[10]="0.00%";t[11]="0.00E+00";t[12]="# ?/?";t[13]="# ??/??";t[14]="m/d/yy";t[15]="d-mmm-yy";t[16]="d-mmm";t[17]="mmm-yy";t[18]="h:mm AM/PM";t[19]="h:mm:ss AM/PM";t[20]="h:mm";t[21]="h:mm:ss";t[22]="m/d/yy h:mm";t[37]="#,##0 ;(#,##0)";t[38]="#,##0 ;[Red](#,##0)";t[39]="#,##0.00;(#,##0.00)";t[40]="#,##0.00;[Red](#,##0.00)";t[45]="mm:ss";t[46]="[h]:mm:ss";t[47]="mmss.0";t[48]="##0.0E+0";t[49]="@";t[56]="\"\u4E0A\u5348/\u4E0B\u5348 \"hh\"\u6642\"mm\"\u5206\"ss\"\u79D2 \""}var table_fmt={};init_table(table_fmt);var default_map=[];var defi=0;for(defi=5;defi<=8;++defi){default_map[defi]=32+defi}for(defi=23;defi<=26;++defi){default_map[defi]=0}for(defi=27;defi<=31;++defi){default_map[defi]=14}for(defi=50;defi<=58;++defi){default_map[defi]=14}for(defi=59;defi<=62;++defi){default_map[defi]=defi-58}for(defi=67;defi<=68;++defi){default_map[defi]=defi-58}for(defi=72;defi<=75;++defi){default_map[defi]=defi-58}for(defi=67;defi<=68;++defi){default_map[defi]=defi-57}for(defi=76;defi<=78;++defi){default_map[defi]=defi-56}for(defi=79;defi<=81;++defi){default_map[defi]=defi-34}var default_str=[];default_str[5]=default_str[63]="\"$\"#,##0_);\\(\"$\"#,##0\\)";default_str[6]=default_str[64]="\"$\"#,##0_);[Red]\\(\"$\"#,##0\\)";default_str[7]=default_str[65]="\"$\"#,##0.00_);\\(\"$\"#,##0.00\\)";default_str[8]=default_str[66]="\"$\"#,##0.00_);[Red]\\(\"$\"#,##0.00\\)";default_str[41]="_(* #,##0_);_(* \\(#,##0\\);_(* \"-\"_);_(@_)";default_str[42]="_(\"$\"* #,##0_);_(\"$\"* \\(#,##0\\);_(\"$\"* \"-\"_);_(@_)";default_str[43]="_(* #,##0.00_);_(* \\(#,##0.00\\);_(* \"-\"??_);_(@_)";default_str[44]="_(\"$\"* #,##0.00_);_(\"$\"* \\(#,##0.00\\);_(\"$\"* \"-\"??_);_(@_)";function frac(x,D,mixed){var sgn=x<0?-1:1;var B=x*sgn;var P_2=0,P_1=1,P=0;var Q_2=1,Q_1=0,Q=0;var A=Math.floor(B);while(Q_1<D){A=Math.floor(B);P=A*P_1+P_2;Q=A*Q_1+Q_2;if(B-A<5e-8)break;B=1/(B-A);P_2=P_1;P_1=P;Q_2=Q_1;Q_1=Q}if(Q>D){if(Q_1>D){Q=Q_2;P=P_2}else{Q=Q_1;P=P_1}}if(!mixed)return[0,sgn*P,Q];var q=Math.floor(sgn*P/Q);return[q,sgn*P-q*Q,Q]}function parse_date_code(v,opts,b22){if(v>2958465||v<0)return null;var date=v|0,time=Math.floor(86400*(v-date)),dow=0;var dout=[];var out={D:date,T:time,u:86400*(v-date)-time,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(out.u)<1e-6)out.u=0;if(opts&&opts.date1904)date+=1462;if(out.u>0.9999){out.u=0;if(++time==86400){out.T=time=0;++date;++out.D}}if(date===60){dout=b22?[1317,10,29]:[1900,2,29];dow=3}else if(date===0){dout=b22?[1317,8,29]:[1900,1,0];dow=6}else{if(date>60)--date;var d=new Date(1900,0,1);d.setDate(d.getDate()+date-1);dout=[d.getFullYear(),d.getMonth()+1,d.getDate()];dow=d.getDay();if(date<60)dow=(dow+6)%7;if(b22)dow=fix_hijri(d,dout)}out.y=dout[0];out.m=dout[1];out.d=dout[2];out.S=time%60;time=Math.floor(time/60);out.M=time%60;time=Math.floor(time/60);out.H=time;out.q=dow;return out}SSF2.parse_date_code=parse_date_code;var basedate=new Date(1899,11,31,0,0,0);var dnthresh=basedate.getTime();var base1904=new Date(1900,2,1,0,0,0);function datenum_local(v,date1904){var epoch=v.getTime();if(date1904)epoch-=1461*24*60*60*1e3;else if(v>=base1904)epoch+=24*60*60*1e3;return(epoch-(dnthresh+(v.getTimezoneOffset()-basedate.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function general_fmt_int(v){return v.toString(10)}SSF2._general_int=general_fmt_int;var general_fmt_num=function make_general_fmt_num(){var trailing_zeroes_and_decimal=/(?:\.0*|(\.\d*[1-9])0+)$/;function strip_decimal(o){return o.indexOf(".")==-1?o:o.replace(trailing_zeroes_and_decimal,"$1")}var mantissa_zeroes_and_decimal=/(?:\.0*|(\.\d*[1-9])0+)[Ee]/;var exp_with_single_digit=/(E[+-])(\d)$/;function normalize_exp(o){if(o.indexOf("E")==-1)return o;return o.replace(mantissa_zeroes_and_decimal,"$1E").replace(exp_with_single_digit,"$10$2")}function small_exp(v){var w=v<0?12:11;var o=strip_decimal(v.toFixed(12));if(o.length<=w)return o;o=v.toPrecision(10);if(o.length<=w)return o;return v.toExponential(5)}function large_exp(v){var o=strip_decimal(v.toFixed(11));return o.length>(v<0?12:11)||o==="0"||o==="-0"?v.toPrecision(6):o}function general_fmt_num_base(v){var V=Math.floor(Math.log(Math.abs(v))*Math.LOG10E),o;if(V>=-4&&V<=-1)o=v.toPrecision(10+V);else if(Math.abs(V)<=9)o=small_exp(v);else if(V===10)o=v.toFixed(10).substr(0,12);else o=large_exp(v);return strip_decimal(normalize_exp(o.toUpperCase()))}return general_fmt_num_base}();SSF2._general_num=general_fmt_num;function general_fmt(v,opts){switch(_typeof(v)){case"string":return v;case"boolean":return v?"TRUE":"FALSE";case"number":return(v|0)===v?v.toString(10):general_fmt_num(v);case"undefined":return"";case"object":if(v==null)return"";if(v instanceof Date)return format(14,datenum_local(v,opts&&opts.date1904),opts);}throw new Error("unsupported value in General format: "+v)}SSF2._general=general_fmt;function fix_hijri(date,o){o[0]-=581;var dow=date.getDay();if(date<60)dow=(dow+6)%7;return dow}var THAI_DIGITS="\u0E50\u0E51\u0E52\u0E53\u0E54\u0E55\u0E56\u0E57\u0E58\u0E59".split("");function write_date(type,fmt,val,ss0){var o="",ss=0,tt=0,y=val.y,out,outl=0;switch(type){case 98:y=val.y+543;case 121:switch(fmt.length){case 1:case 2:out=y%100;outl=2;break;default:out=y%1e4;outl=4;break;}break;case 109:switch(fmt.length){case 1:case 2:out=val.m;outl=fmt.length;break;case 3:return months[val.m-1][1];case 5:return months[val.m-1][0];default:return months[val.m-1][2];}break;case 100:switch(fmt.length){case 1:case 2:out=val.d;outl=fmt.length;break;case 3:return days[val.q][0];default:return days[val.q][1];}break;case 104:switch(fmt.length){case 1:case 2:out=1+(val.H+11)%12;outl=fmt.length;break;default:throw"bad hour format: "+fmt;}break;case 72:switch(fmt.length){case 1:case 2:out=val.H;outl=fmt.length;break;default:throw"bad hour format: "+fmt;}break;case 77:switch(fmt.length){case 1:case 2:out=val.M;outl=fmt.length;break;default:throw"bad minute format: "+fmt;}break;case 115:if(fmt!="s"&&fmt!="ss"&&fmt!=".0"&&fmt!=".00"&&fmt!=".000")throw"bad second format: "+fmt;if(val.u===0&&(fmt=="s"||fmt=="ss"))return pad0(val.S,fmt.length);if(ss0>=2)tt=ss0===3?1e3:100;else tt=ss0===1?10:1;ss=Math.round(tt*(val.S+val.u));if(ss>=60*tt)ss=0;if(fmt==="s")return ss===0?"0":""+ss/tt;o=pad0(ss,2+ss0);if(fmt==="ss")return o.substr(0,2);return"."+o.substr(2,fmt.length-1);case 90:switch(fmt){case"[h]":case"[hh]":out=val.D*24+val.H;break;case"[m]":case"[mm]":out=(val.D*24+val.H)*60+val.M;break;case"[s]":case"[ss]":out=((val.D*24+val.H)*60+val.M)*60+Math.round(val.S+val.u);break;default:throw"bad abstime format: "+fmt;}outl=fmt.length===3?1:2;break;case 101:out=y;outl=1;break;}var outstr=outl>0?pad0(out,outl):"";return outstr}function commaify(s){var w=3;if(s.length<=w)return s;var j=s.length%w,o=s.substr(0,j);for(;j!=s.length;j+=w){o+=(o.length>0?",":"")+s.substr(j,w)}return o}var write_num=function make_write_num(){var pct1=/%/g;function write_num_pct(type,fmt,val){var sfmt=fmt.replace(pct1,""),mul=fmt.length-sfmt.length;return write_num(type,sfmt,val*Math.pow(10,2*mul))+fill("%",mul)}function write_num_cm(type,fmt,val){var idx=fmt.length-1;while(fmt.charCodeAt(idx-1)===44){--idx}return write_num(type,fmt.substr(0,idx),val/Math.pow(10,3*(fmt.length-idx)))}function write_num_exp(fmt,val){var o;var idx=fmt.indexOf("E")-fmt.indexOf(".")-1;if(fmt.match(/^#+0.0E\+0$/)){if(val==0)return"0.0E+0";else if(val<0)return"-"+write_num_exp(fmt,-val);var period=fmt.indexOf(".");if(period===-1)period=fmt.indexOf("E");var ee=Math.floor(Math.log(val)*Math.LOG10E)%period;if(ee<0)ee+=period;o=(val/Math.pow(10,ee)).toPrecision(idx+1+(period+ee)%period);if(o.indexOf("e")===-1){var fakee=Math.floor(Math.log(val)*Math.LOG10E);if(o.indexOf(".")===-1)o=o.charAt(0)+"."+o.substr(1)+"E+"+(fakee-o.length+ee);else o+="E+"+(fakee-ee);while(o.substr(0,2)==="0."){o=o.charAt(0)+o.substr(2,period)+"."+o.substr(2+period);o=o.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.")}o=o.replace(/\+-/,"-")}o=o.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function($$,$1,$2,$3){return $1+$2+$3.substr(0,(period+ee)%period)+"."+$3.substr(ee)+"E"})}else o=val.toExponential(idx);if(fmt.match(/E\+00$/)&&o.match(/e[+-]\d$/))o=o.substr(0,o.length-1)+"0"+o.charAt(o.length-1);if(fmt.match(/E\-/)&&o.match(/e\+/))o=o.replace(/e\+/,"e");return o.replace("e","E")}var frac1=/# (\?+)( ?)\/( ?)(\d+)/;function write_num_f1(r,aval,sign){var den=parseInt(r[4],10),rr=Math.round(aval*den),base=Math.floor(rr/den);var myn=rr-base*den,myd=den;return sign+(base===0?"":""+base)+" "+(myn===0?fill(" ",r[1].length+1+r[4].length):pad_(myn,r[1].length)+r[2]+"/"+r[3]+pad0(myd,r[4].length))}function write_num_f2(r,aval,sign){return sign+(aval===0?"":""+aval)+fill(" ",r[1].length+2+r[4].length)}var dec1=/^#*0*\.([0#]+)/;var closeparen=/\).*[0#]/;var phone=/\(###\) ###\\?-####/;function hashq(str){var o="",cc;for(var i=0;i!=str.length;++i){switch(cc=str.charCodeAt(i)){case 35:break;case 63:o+=" ";break;case 48:o+="0";break;default:o+=String.fromCharCode(cc);}}return o}function rnd(val,d){var dd=Math.pow(10,d);return""+Math.round(val*dd)/dd}function dec(val,d){var _frac=val-Math.floor(val),dd=Math.pow(10,d);if(d<(""+Math.round(_frac*dd)).length)return 0;return Math.round(_frac*dd)}function carry(val,d){if(d<(""+Math.round((val-Math.floor(val))*Math.pow(10,d))).length){return 1}return 0}function flr(val){if(val<2147483647&&val>-2147483648)return""+(val>=0?val|0:val-1|0);return""+Math.floor(val)}function write_num_flt(type,fmt,val){if(type.charCodeAt(0)===40&&!fmt.match(closeparen)){var ffmt=fmt.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");if(val>=0)return write_num_flt("n",ffmt,val);return"("+write_num_flt("n",ffmt,-val)+")"}if(fmt.charCodeAt(fmt.length-1)===44)return write_num_cm(type,fmt,val);if(fmt.indexOf("%")!==-1)return write_num_pct(type,fmt,val);if(fmt.indexOf("E")!==-1)return write_num_exp(fmt,val);if(fmt.charCodeAt(0)===36)return"$"+write_num_flt(type,fmt.substr(fmt.charAt(1)==" "?2:1),val);var o;var r,ri,ff,aval=Math.abs(val),sign=val<0?"-":"";if(fmt.match(/^00+$/))return sign+pad0r(aval,fmt.length);if(fmt.match(/^[#?]+$/)){o=pad0r(val,0);if(o==="0")o="";return o.length>fmt.length?o:hashq(fmt.substr(0,fmt.length-o.length))+o}if(r=fmt.match(frac1))return write_num_f1(r,aval,sign);if(fmt.match(/^#+0+$/))return sign+pad0r(aval,fmt.length-fmt.indexOf("0"));if(r=fmt.match(dec1)){o=rnd(val,r[1].length).replace(/^([^\.]+)$/,"$1."+hashq(r[1])).replace(/\.$/,"."+hashq(r[1])).replace(/\.(\d*)$/,function($$,$1){return"."+$1+fill("0",hashq(r[1]).length-$1.length)});return fmt.indexOf("0.")!==-1?o:o.replace(/^0\./,".")}fmt=fmt.replace(/^#+([0.])/,"$1");if(r=fmt.match(/^(0*)\.(#*)$/)){return sign+rnd(aval,r[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,r[1].length?"0.":".")}if(r=fmt.match(/^#{1,3},##0(\.?)$/))return sign+commaify(pad0r(aval,0));if(r=fmt.match(/^#,##0\.([#0]*0)$/)){return val<0?"-"+write_num_flt(type,fmt,-val):commaify(""+(Math.floor(val)+carry(val,r[1].length)))+"."+pad0(dec(val,r[1].length),r[1].length)}if(r=fmt.match(/^#,#*,#0/))return write_num_flt(type,fmt.replace(/^#,#*,/,""),val);if(r=fmt.match(/^([0#]+)(\\?-([0#]+))+$/)){o=_strrev(write_num_flt(type,fmt.replace(/[\\-]/g,""),val));ri=0;return _strrev(_strrev(fmt.replace(/\\/g,"")).replace(/[0#]/g,function(x2){return ri<o.length?o.charAt(ri++):x2==="0"?"0":""}))}if(fmt.match(phone)){o=write_num_flt(type,"##########",val);return"("+o.substr(0,3)+") "+o.substr(3,3)+"-"+o.substr(6)}var oa="";if(r=fmt.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/)){ri=Math.min(r[4].length,7);ff=frac(aval,Math.pow(10,ri)-1,false);o=""+sign;oa=write_num("n",r[1],ff[1]);if(oa.charAt(oa.length-1)==" ")oa=oa.substr(0,oa.length-1)+"0";o+=oa+r[2]+"/"+r[3];oa=rpad_(ff[2],ri);if(oa.length<r[4].length)oa=hashq(r[4].substr(r[4].length-oa.length))+oa;o+=oa;return o}if(r=fmt.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/)){ri=Math.min(Math.max(r[1].length,r[4].length),7);ff=frac(aval,Math.pow(10,ri)-1,true);return sign+(ff[0]||(ff[1]?"":"0"))+" "+(ff[1]?pad_(ff[1],ri)+r[2]+"/"+r[3]+rpad_(ff[2],ri):fill(" ",2*ri+1+r[2].length+r[3].length))}if(r=fmt.match(/^[#0?]+$/)){o=pad0r(val,0);if(fmt.length<=o.length)return o;return hashq(fmt.substr(0,fmt.length-o.length))+o}if(r=fmt.match(/^([#0?]+)\.([#0]+)$/)){o=""+val.toFixed(Math.min(r[2].length,10)).replace(/([^0])0+$/,"$1");ri=o.indexOf(".");var lres=fmt.indexOf(".")-ri,rres=fmt.length-o.length-lres;return hashq(fmt.substr(0,lres)+o+fmt.substr(fmt.length-rres))}if(r=fmt.match(/^00,000\.([#0]*0)$/)){ri=dec(val,r[1].length);return val<0?"-"+write_num_flt(type,fmt,-val):commaify(flr(val)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function($$){return"00,"+($$.length<3?pad0(0,3-$$.length):"")+$$})+"."+pad0(ri,r[1].length)}switch(fmt){case"###,##0.00":return write_num_flt(type,"#,##0.00",val);case"###,###":case"##,###":case"#,###":var x=commaify(pad0r(aval,0));return x!=="0"?sign+x:"";case"###,###.00":return write_num_flt(type,"###,##0.00",val).replace(/^0\./,".");case"#,###.00":return write_num_flt(type,"#,##0.00",val).replace(/^0\./,".");default:}throw new Error("unsupported format |"+fmt+"|")}function write_num_cm2(type,fmt,val){var idx=fmt.length-1;while(fmt.charCodeAt(idx-1)===44){--idx}return write_num(type,fmt.substr(0,idx),val/Math.pow(10,3*(fmt.length-idx)))}function write_num_pct2(type,fmt,val){var sfmt=fmt.replace(pct1,""),mul=fmt.length-sfmt.length;return write_num(type,sfmt,val*Math.pow(10,2*mul))+fill("%",mul)}function write_num_exp2(fmt,val){var o;var idx=fmt.indexOf("E")-fmt.indexOf(".")-1;if(fmt.match(/^#+0.0E\+0$/)){if(val==0)return"0.0E+0";else if(val<0)return"-"+write_num_exp2(fmt,-val);var period=fmt.indexOf(".");if(period===-1)period=fmt.indexOf("E");var ee=Math.floor(Math.log(val)*Math.LOG10E)%period;if(ee<0)ee+=period;o=(val/Math.pow(10,ee)).toPrecision(idx+1+(period+ee)%period);if(!o.match(/[Ee]/)){var fakee=Math.floor(Math.log(val)*Math.LOG10E);if(o.indexOf(".")===-1)o=o.charAt(0)+"."+o.substr(1)+"E+"+(fakee-o.length+ee);else o+="E+"+(fakee-ee);o=o.replace(/\+-/,"-")}o=o.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function($$,$1,$2,$3){return $1+$2+$3.substr(0,(period+ee)%period)+"."+$3.substr(ee)+"E"})}else o=val.toExponential(idx);if(fmt.match(/E\+00$/)&&o.match(/e[+-]\d$/))o=o.substr(0,o.length-1)+"0"+o.charAt(o.length-1);if(fmt.match(/E\-/)&&o.match(/e\+/))o=o.replace(/e\+/,"e");return o.replace("e","E")}function write_num_int(type,fmt,val){if(type.charCodeAt(0)===40&&!fmt.match(closeparen)){var ffmt=fmt.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");if(val>=0)return write_num_int("n",ffmt,val);return"("+write_num_int("n",ffmt,-val)+")"}if(fmt.charCodeAt(fmt.length-1)===44)return write_num_cm2(type,fmt,val);if(fmt.indexOf("%")!==-1)return write_num_pct2(type,fmt,val);if(fmt.indexOf("E")!==-1)return write_num_exp2(fmt,val);if(fmt.charCodeAt(0)===36)return"$"+write_num_int(type,fmt.substr(fmt.charAt(1)==" "?2:1),val);var o;var r,ri,ff,aval=Math.abs(val),sign=val<0?"-":"";if(fmt.match(/^00+$/))return sign+pad0(aval,fmt.length);if(fmt.match(/^[#?]+$/)){o=""+val;if(val===0)o="";return o.length>fmt.length?o:hashq(fmt.substr(0,fmt.length-o.length))+o}if(r=fmt.match(frac1))return write_num_f2(r,aval,sign);if(fmt.match(/^#+0+$/))return sign+pad0(aval,fmt.length-fmt.indexOf("0"));if(r=fmt.match(dec1)){o=(""+val).replace(/^([^\.]+)$/,"$1."+hashq(r[1])).replace(/\.$/,"."+hashq(r[1]));o=o.replace(/\.(\d*)$/,function($$,$1){return"."+$1+fill("0",hashq(r[1]).length-$1.length)});return fmt.indexOf("0.")!==-1?o:o.replace(/^0\./,".")}fmt=fmt.replace(/^#+([0.])/,"$1");if(r=fmt.match(/^(0*)\.(#*)$/)){return sign+(""+aval).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,r[1].length?"0.":".")}if(r=fmt.match(/^#{1,3},##0(\.?)$/))return sign+commaify(""+aval);if(r=fmt.match(/^#,##0\.([#0]*0)$/)){return val<0?"-"+write_num_int(type,fmt,-val):commaify(""+val)+"."+fill("0",r[1].length)}if(r=fmt.match(/^#,#*,#0/))return write_num_int(type,fmt.replace(/^#,#*,/,""),val);if(r=fmt.match(/^([0#]+)(\\?-([0#]+))+$/)){o=_strrev(write_num_int(type,fmt.replace(/[\\-]/g,""),val));ri=0;return _strrev(_strrev(fmt.replace(/\\/g,"")).replace(/[0#]/g,function(x2){return ri<o.length?o.charAt(ri++):x2==="0"?"0":""}))}if(fmt.match(phone)){o=write_num_int(type,"##########",val);return"("+o.substr(0,3)+") "+o.substr(3,3)+"-"+o.substr(6)}var oa="";if(r=fmt.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/)){ri=Math.min(r[4].length,7);ff=frac(aval,Math.pow(10,ri)-1,false);o=""+sign;oa=write_num("n",r[1],ff[1]);if(oa.charAt(oa.length-1)==" ")oa=oa.substr(0,oa.length-1)+"0";o+=oa+r[2]+"/"+r[3];oa=rpad_(ff[2],ri);if(oa.length<r[4].length)oa=hashq(r[4].substr(r[4].length-oa.length))+oa;o+=oa;return o}if(r=fmt.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/)){ri=Math.min(Math.max(r[1].length,r[4].length),7);ff=frac(aval,Math.pow(10,ri)-1,true);return sign+(ff[0]||(ff[1]?"":"0"))+" "+(ff[1]?pad_(ff[1],ri)+r[2]+"/"+r[3]+rpad_(ff[2],ri):fill(" ",2*ri+1+r[2].length+r[3].length))}if(r=fmt.match(/^[#0?]+$/)){o=""+val;if(fmt.length<=o.length)return o;return hashq(fmt.substr(0,fmt.length-o.length))+o}if(r=fmt.match(/^([#0]+)\.([#0]+)$/)){o=""+val.toFixed(Math.min(r[2].length,10)).replace(/([^0])0+$/,"$1");ri=o.indexOf(".");var lres=fmt.indexOf(".")-ri,rres=fmt.length-o.length-lres;return hashq(fmt.substr(0,lres)+o+fmt.substr(fmt.length-rres))}if(r=fmt.match(/^00,000\.([#0]*0)$/)){return val<0?"-"+write_num_int(type,fmt,-val):commaify(""+val).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function($$){return"00,"+($$.length<3?pad0(0,3-$$.length):"")+$$})+"."+pad0(0,r[1].length)}switch(fmt){case"###,###":case"##,###":case"#,###":var x=commaify(""+aval);return x!=="0"?sign+x:"";default:if(fmt.match(/\.[0#?]*$/))return write_num_int(type,fmt.slice(0,fmt.lastIndexOf(".")),val)+hashq(fmt.slice(fmt.lastIndexOf(".")));}throw new Error("unsupported format |"+fmt+"|")}return function write_num2(type,fmt,val){return(val|0)===val?write_num_int(type,fmt,val):write_num_flt(type,fmt,val)}}();function split_fmt(fmt){var out=[];var in_str=false;for(var i=0,j=0;i<fmt.length;++i){switch(fmt.charCodeAt(i)){case 34:in_str=!in_str;break;case 95:case 42:case 92:++i;break;case 59:out[out.length]=fmt.substr(j,i-j);j=i+1;}}out[out.length]=fmt.substr(j);if(in_str===true)throw new Error("Format |"+fmt+"| unterminated string ");return out}SSF2._split=split_fmt;var abstime=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function fmt_is_date(fmt){var i=0,c="",o="";while(i<fmt.length){switch(c=fmt.charAt(i)){case"G":if(isgeneral(fmt,i))i+=6;i++;break;case"\"":for(;fmt.charCodeAt(++i)!==34&&i<fmt.length;){}++i;break;case"\\":i+=2;break;case"_":i+=2;break;case"@":++i;break;case"B":case"b":if(fmt.charAt(i+1)==="1"||fmt.charAt(i+1)==="2")return true;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return true;case"A":case"a":case"\u4E0A":if(fmt.substr(i,3).toUpperCase()==="A/P")return true;if(fmt.substr(i,5).toUpperCase()==="AM/PM")return true;if(fmt.substr(i,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return true;++i;break;case"[":o=c;while(fmt.charAt(i++)!=="]"&&i<fmt.length){o+=fmt.charAt(i)}if(o.match(abstime))return true;break;case".":case"0":case"#":while(i<fmt.length&&("0#?.,E+-%".indexOf(c=fmt.charAt(++i))>-1||c=="\\"&&fmt.charAt(i+1)=="-"&&"0#".indexOf(fmt.charAt(i+2))>-1)){}break;case"?":while(fmt.charAt(++i)===c){}break;case"*":++i;if(fmt.charAt(i)==" "||fmt.charAt(i)=="*")++i;break;case"(":case")":++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":while(i<fmt.length&&"0123456789".indexOf(fmt.charAt(++i))>-1){}break;case" ":++i;break;default:++i;break;}}return false}SSF2.is_date=fmt_is_date;function eval_fmt(fmt,v,opts,flen){var out=[],o="",i=0,c="",lst="t",dt,j,cc;var hr="H";while(i<fmt.length){switch(c=fmt.charAt(i)){case"G":if(!isgeneral(fmt,i))throw new Error("unrecognized character "+c+" in "+fmt);out[out.length]={t:"G",v:"General"};i+=7;break;case"\"":for(o="";(cc=fmt.charCodeAt(++i))!==34&&i<fmt.length;){o+=String.fromCharCode(cc)}out[out.length]={t:"t",v:o};++i;break;case"\\":var w=fmt.charAt(++i),t=w==="("||w===")"?w:"t";out[out.length]={t:t,v:w};++i;break;case"_":out[out.length]={t:"t",v:" "};i+=2;break;case"@":out[out.length]={t:"T",v:v};++i;break;case"B":case"b":if(fmt.charAt(i+1)==="1"||fmt.charAt(i+1)==="2"){if(dt==null){dt=parse_date_code(v,opts,fmt.charAt(i+1)==="2");if(dt==null)return""}out[out.length]={t:"X",v:fmt.substr(i,2)};lst=c;i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(v<0)return"";if(dt==null){dt=parse_date_code(v,opts);if(dt==null)return""}o=c;while(++i<fmt.length&&fmt.charAt(i).toLowerCase()===c){o+=c}if(c==="m"&&lst.toLowerCase()==="h")c="M";if(c==="h")c=hr;out[out.length]={t:c,v:o};lst=c;break;case"A":case"a":case"\u4E0A":var q={t:c,v:c};if(dt==null)dt=parse_date_code(v,opts);if(fmt.substr(i,3).toUpperCase()==="A/P"){if(dt!=null)q.v=dt.H>=12?"P":"A";q.t="T";hr="h";i+=3}else if(fmt.substr(i,5).toUpperCase()==="AM/PM"){if(dt!=null)q.v=dt.H>=12?"PM":"AM";q.t="T";i+=5;hr="h"}else if(fmt.substr(i,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"){if(dt!=null)q.v=dt.H>=12?"\u4E0B\u5348":"\u4E0A\u5348";q.t="T";i+=5;hr="h"}else{q.t="t";++i}if(dt==null&&q.t==="T")return"";out[out.length]=q;lst=c;break;case"[":o=c;while(fmt.charAt(i++)!=="]"&&i<fmt.length){o+=fmt.charAt(i)}if(o.slice(-1)!=="]")throw"unterminated \"[\" block: |"+o+"|";if(o.match(abstime)){if(dt==null){dt=parse_date_code(v,opts);if(dt==null)return""}out[out.length]={t:"Z",v:o.toLowerCase()};lst=o.charAt(1)}else if(o.indexOf("$")>-1){o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$";if(!fmt_is_date(fmt))out[out.length]={t:"t",v:o}}break;case".":if(dt!=null){o=c;while(++i<fmt.length&&(c=fmt.charAt(i))==="0"){o+=c}out[out.length]={t:"s",v:o};break}case"0":case"#":o=c;while(++i<fmt.length&&"0#?.,E+-%".indexOf(c=fmt.charAt(i))>-1){o+=c}out[out.length]={t:"n",v:o};break;case"?":o=c;while(fmt.charAt(++i)===c){o+=c}out[out.length]={t:c,v:o};lst=c;break;case"*":++i;if(fmt.charAt(i)==" "||fmt.charAt(i)=="*")++i;break;case"(":case")":out[out.length]={t:flen===1?"t":c,v:c};++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":o=c;while(i<fmt.length&&"0123456789".indexOf(fmt.charAt(++i))>-1){o+=fmt.charAt(i)}out[out.length]={t:"D",v:o};break;case" ":out[out.length]={t:c,v:c};++i;break;case"$":out[out.length]={t:"t",v:"$"};++i;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+fmt);out[out.length]={t:"t",v:c};++i;break;}}var bt=0,ss0=0,ssm;for(i=out.length-1,lst="t";i>=0;--i){switch(out[i].t){case"h":case"H":out[i].t=hr;lst="h";if(bt<1)bt=1;break;case"s":if(ssm=out[i].v.match(/\.0+$/))ss0=Math.max(ss0,ssm[0].length-1);if(bt<3)bt=3;case"d":case"y":case"M":case"e":lst=out[i].t;break;case"m":if(lst==="s"){out[i].t="M";if(bt<2)bt=2}break;case"X":break;case"Z":if(bt<1&&out[i].v.match(/[Hh]/))bt=1;if(bt<2&&out[i].v.match(/[Mm]/))bt=2;if(bt<3&&out[i].v.match(/[Ss]/))bt=3;}}switch(bt){case 0:break;case 1:if(dt.u>=0.5){dt.u=0;++dt.S}if(dt.S>=60){dt.S=0;++dt.M}if(dt.M>=60){dt.M=0;++dt.H}break;case 2:if(dt.u>=0.5){dt.u=0;++dt.S}if(dt.S>=60){dt.S=0;++dt.M}break;}var nstr="",jj;for(i=0;i<out.length;++i){switch(out[i].t){case"t":case"T":case" ":case"D":break;case"X":out[i].v="";out[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":out[i].v=write_date(out[i].t.charCodeAt(0),out[i].v,dt,ss0);out[i].t="t";break;case"n":case"?":jj=i+1;while(out[jj]!=null&&((c=out[jj].t)==="?"||c==="D"||(c===" "||c==="t")&&out[jj+1]!=null&&(out[jj+1].t==="?"||out[jj+1].t==="t"&&out[jj+1].v==="/")||out[i].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(out[jj].v==="/"||out[jj].v===" "&&out[jj+1]!=null&&out[jj+1].t=="?"))){out[i].v+=out[jj].v;out[jj]={v:"",t:";"};++jj}nstr+=out[i].v;i=jj-1;break;case"G":out[i].t="t";out[i].v=general_fmt(v,opts);break;}}var vv="",myv,ostr;if(nstr.length>0){if(nstr.charCodeAt(0)==40){myv=v<0&&nstr.charCodeAt(0)===45?-v:v;ostr=write_num("n",nstr,myv)}else{myv=v<0&&flen>1?-v:v;ostr=write_num("n",nstr,myv);if(myv<0&&out[0]&&out[0].t=="t"){ostr=ostr.substr(1);out[0].v="-"+out[0].v}}jj=ostr.length-1;var decpt=out.length;for(i=0;i<out.length;++i){if(out[i]!=null&&out[i].t!="t"&&out[i].v.indexOf(".")>-1){decpt=i;break}}var lasti=out.length;if(decpt===out.length&&ostr.indexOf("E")===-1){for(i=out.length-1;i>=0;--i){if(out[i]==null||"n?".indexOf(out[i].t)===-1)continue;if(jj>=out[i].v.length-1){jj-=out[i].v.length;out[i].v=ostr.substr(jj+1,out[i].v.length)}else if(jj<0)out[i].v="";else{out[i].v=ostr.substr(0,jj+1);jj=-1}out[i].t="t";lasti=i}if(jj>=0&&lasti<out.length)out[lasti].v=ostr.substr(0,jj+1)+out[lasti].v}else if(decpt!==out.length&&ostr.indexOf("E")===-1){jj=ostr.indexOf(".")-1;for(i=decpt;i>=0;--i){if(out[i]==null||"n?".indexOf(out[i].t)===-1)continue;j=out[i].v.indexOf(".")>-1&&i===decpt?out[i].v.indexOf(".")-1:out[i].v.length-1;vv=out[i].v.substr(j+1);for(;j>=0;--j){if(jj>=0&&(out[i].v.charAt(j)==="0"||out[i].v.charAt(j)==="#"))vv=ostr.charAt(jj--)+vv}out[i].v=vv;out[i].t="t";lasti=i}if(jj>=0&&lasti<out.length)out[lasti].v=ostr.substr(0,jj+1)+out[lasti].v;jj=ostr.indexOf(".")+1;for(i=decpt;i<out.length;++i){if(out[i]==null||"n?(".indexOf(out[i].t)===-1&&i!==decpt)continue;j=out[i].v.indexOf(".")>-1&&i===decpt?out[i].v.indexOf(".")+1:0;vv=out[i].v.substr(0,j);for(;j<out[i].v.length;++j){if(jj<ostr.length)vv+=ostr.charAt(jj++)}out[i].v=vv;out[i].t="t";lasti=i}}}for(i=0;i<out.length;++i){if(out[i]!=null&&"n?".indexOf(out[i].t)>-1){myv=flen>1&&v<0&&i>0&&out[i-1].v==="-"?-v:v;out[i].v=write_num(out[i].t,out[i].v,myv);out[i].t="t"}}var retval="";for(i=0;i!==out.length;++i){if(out[i]!=null)retval+=out[i].v}return retval}SSF2._eval=eval_fmt;var cfregex=/\[[=<>]/;var cfregex2=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function chkcond(v,rr){if(rr==null)return false;var thresh=parseFloat(rr[2]);switch(rr[1]){case"=":if(v==thresh)return true;break;case">":if(v>thresh)return true;break;case"<":if(v<thresh)return true;break;case"<>":if(v!=thresh)return true;break;case">=":if(v>=thresh)return true;break;case"<=":if(v<=thresh)return true;break;}return false}function choose_fmt(f,v){var fmt=split_fmt(f);var l=fmt.length,lat=fmt[l-1].indexOf("@");if(l<4&&lat>-1)--l;if(fmt.length>4)throw new Error("cannot find right format for |"+fmt.join("|")+"|");if(typeof v!=="number")return[4,fmt.length===4||lat>-1?fmt[fmt.length-1]:"@"];switch(fmt.length){case 1:fmt=lat>-1?["General","General","General",fmt[0]]:[fmt[0],fmt[0],fmt[0],"@"];break;case 2:fmt=lat>-1?[fmt[0],fmt[0],fmt[0],fmt[1]]:[fmt[0],fmt[1],fmt[0],"@"];break;case 3:fmt=lat>-1?[fmt[0],fmt[1],fmt[0],fmt[2]]:[fmt[0],fmt[1],fmt[2],"@"];break;case 4:break;}var ff=v>0?fmt[0]:v<0?fmt[1]:fmt[2];if(fmt[0].indexOf("[")===-1&&fmt[1].indexOf("[")===-1)return[l,ff];if(fmt[0].match(cfregex)!=null||fmt[1].match(cfregex)!=null){var m1=fmt[0].match(cfregex2);var m2=fmt[1].match(cfregex2);return chkcond(v,m1)?[l,fmt[0]]:chkcond(v,m2)?[l,fmt[1]]:[l,fmt[m1!=null&&m2!=null?2:1]]}return[l,ff]}function format(fmt,v,o){if(o==null)o={};var sfmt="";switch(_typeof(fmt)){case"string":if(fmt=="m/d/yy"&&o.dateNF)sfmt=o.dateNF;else sfmt=fmt;break;case"number":if(fmt==14&&o.dateNF)sfmt=o.dateNF;else sfmt=(o.table!=null?o.table:table_fmt)[fmt];if(sfmt==null)sfmt=o.table&&o.table[default_map[fmt]]||table_fmt[default_map[fmt]];if(sfmt==null)sfmt=default_str[fmt]||"General";break;}if(isgeneral(sfmt,0))return general_fmt(v,o);if(v instanceof Date)v=datenum_local(v,o.date1904);var f=choose_fmt(sfmt,v);if(isgeneral(f[1]))return general_fmt(v,o);if(v===true)v="TRUE";else if(v===false)v="FALSE";else if(v===""||v==null)return"";return eval_fmt(f[1],v,o,f[0])}function load_entry(fmt,idx){if(typeof idx!="number"){idx=+idx||-1;for(var i=0;i<392;++i){if(table_fmt[i]==void 0){if(idx<0)idx=i;continue}if(table_fmt[i]==fmt){idx=i;break}}if(idx<0)idx=391}table_fmt[idx]=fmt;return idx}SSF2.load=load_entry;SSF2._table=table_fmt;SSF2.get_table=function get_table(){return table_fmt};SSF2.load_table=function load_table(tbl){for(var i=0;i!=392;++i){if(tbl[i]!==void 0)load_entry(tbl[i],i)}};SSF2.init_table=init_table;SSF2.format=format};make_ssf(SSF);if(typeof module!=="undefined"&&typeof DO_NOT_EXPORT_SSF==="undefined")module.exports=SSF}});// index.browser.js
var index_browser_exports={};__export(index_browser_exports,{"default":function _default(){return index_browser_default}});// node_modules/fflate/esm/browser.js
var ch2={};var wk=function wk(c,id,msg,transfer,cb){var w=new Worker(ch2[id]||(ch2[id]=URL.createObjectURL(new Blob([c+";addEventListener(\"error\",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})"],{type:"text/javascript"}))));w.onmessage=function(e){var d=e.data,ed=d.$e$;if(ed){var err2=new Error(ed[0]);err2["code"]=ed[1];err2.stack=ed[2];cb(err2,null)}else cb(null,d)};w.postMessage(msg,transfer);return w};var u8=Uint8Array;var u16=Uint16Array;var u32=Uint32Array;var fleb=new u8([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]);var fdeb=new u8([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]);var clim=new u8([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);var freb=function freb(eb,start){var b=new u16(31);for(var i=0;i<31;++i){b[i]=start+=1<<eb[i-1]}var r=new u32(b[30]);for(var i=1;i<30;++i){for(var j=b[i];j<b[i+1];++j){r[j]=j-b[i]<<5|i}}return[b,r]};var _a=freb(fleb,2);var fl=_a[0];var revfl=_a[1];fl[28]=258,revfl[258]=28;var _b=freb(fdeb,0);var fd=_b[0];var revfd=_b[1];var rev=new u16(32768);for(i=0;i<32768;++i){x=(i&43690)>>>1|(i&21845)<<1;x=(x&52428)>>>2|(x&13107)<<2;x=(x&61680)>>>4|(x&3855)<<4;rev[i]=((x&65280)>>>8|(x&255)<<8)>>>1}var x;var i;var hMap=function hMap(cd,mb,r){var s=cd.length;var i=0;var l=new u16(mb);for(;i<s;++i){if(cd[i])++l[cd[i]-1]}var le=new u16(mb);for(i=0;i<mb;++i){le[i]=le[i-1]+l[i-1]<<1}var co;if(r){co=new u16(1<<mb);var rvb=15-mb;for(i=0;i<s;++i){if(cd[i]){var sv=i<<4|cd[i];var r_1=mb-cd[i];var v=le[cd[i]-1]++<<r_1;for(var m=v|(1<<r_1)-1;v<=m;++v){co[rev[v]>>>rvb]=sv}}}}else{co=new u16(s);for(i=0;i<s;++i){if(cd[i]){co[i]=rev[le[cd[i]-1]++]>>>15-cd[i]}}}return co};var flt=new u8(288);for(i=0;i<144;++i){flt[i]=8}var i;for(i=144;i<256;++i){flt[i]=9}var i;for(i=256;i<280;++i){flt[i]=7}var i;for(i=280;i<288;++i){flt[i]=8}var i;var fdt=new u8(32);for(i=0;i<32;++i){fdt[i]=5}var i;var flrm=/* @__PURE__ */hMap(flt,9,1);var fdrm=/* @__PURE__ */hMap(fdt,5,1);var max=function max(a){var m=a[0];for(var i=1;i<a.length;++i){if(a[i]>m)m=a[i]}return m};var bits=function bits(d,p,m){var o=p/8|0;return(d[o]|d[o+1]<<8)>>(p&7)&m};var bits16=function bits16(d,p){var o=p/8|0;return(d[o]|d[o+1]<<8|d[o+2]<<16)>>(p&7)};var shft=function shft(p){return(p+7)/8|0};var slc=function slc(v,s,e){if(s==null||s<0)s=0;if(e==null||e>v.length)e=v.length;var n=new(v.BYTES_PER_ELEMENT==2?u16:v.BYTES_PER_ELEMENT==4?u32:u8)(e-s);n.set(v.subarray(s,e));return n};var ec=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"];var err=function err(ind,msg,nt){var e=new Error(msg||ec[ind]);e.code=ind;if(Error.captureStackTrace)Error.captureStackTrace(e,err);if(!nt)throw e;return e};var inflt=function inflt(dat,buf,st){var sl=dat.length;if(!sl||st&&st.f&&!st.l)return buf||new u8(0);var noBuf=!buf||st;var noSt=!st||st.i;if(!st)st={};if(!buf)buf=new u8(sl*3);var cbuf=function cbuf(l2){var bl=buf.length;if(l2>bl){var nbuf=new u8(Math.max(bl*2,l2));nbuf.set(buf);buf=nbuf}};var _final4=st.f||0,pos=st.p||0,bt=st.b||0,lm=st.l,dm=st.d,lbt=st.m,dbt=st.n;var tbts=sl*8;do{if(!lm){_final4=bits(dat,pos,1);var type=bits(dat,pos+1,3);pos+=3;if(!type){var s=shft(pos)+4,l=dat[s-4]|dat[s-3]<<8,t=s+l;if(t>sl){if(noSt)err(0);break}if(noBuf)cbuf(bt+l);buf.set(dat.subarray(s,t),bt);st.b=bt+=l,st.p=pos=t*8,st.f=_final4;continue}else if(type==1)lm=flrm,dm=fdrm,lbt=9,dbt=5;else if(type==2){var hLit=bits(dat,pos,31)+257,hcLen=bits(dat,pos+10,15)+4;var tl=hLit+bits(dat,pos+5,31)+1;pos+=14;var ldt=new u8(tl);var clt=new u8(19);for(var i=0;i<hcLen;++i){clt[clim[i]]=bits(dat,pos+i*3,7)}pos+=hcLen*3;var clb=max(clt),clbmsk=(1<<clb)-1;var clm=hMap(clt,clb,1);for(var i=0;i<tl;){var r=clm[bits(dat,pos,clbmsk)];pos+=r&15;var s=r>>>4;if(s<16){ldt[i++]=s}else{var c=0,n=0;if(s==16)n=3+bits(dat,pos,3),pos+=2,c=ldt[i-1];else if(s==17)n=3+bits(dat,pos,7),pos+=3;else if(s==18)n=11+bits(dat,pos,127),pos+=7;while(n--){ldt[i++]=c}}}var lt=ldt.subarray(0,hLit),dt=ldt.subarray(hLit);lbt=max(lt);dbt=max(dt);lm=hMap(lt,lbt,1);dm=hMap(dt,dbt,1)}else err(1);if(pos>tbts){if(noSt)err(0);break}}if(noBuf)cbuf(bt+131072);var lms=(1<<lbt)-1,dms=(1<<dbt)-1;var lpos=pos;for(;;lpos=pos){var c=lm[bits16(dat,pos)&lms],sym=c>>>4;pos+=c&15;if(pos>tbts){if(noSt)err(0);break}if(!c)err(2);if(sym<256)buf[bt++]=sym;else if(sym==256){lpos=pos,lm=null;break}else{var add=sym-254;if(sym>264){var i=sym-257,b=fleb[i];add=bits(dat,pos,(1<<b)-1)+fl[i];pos+=b}var d=dm[bits16(dat,pos)&dms],dsym=d>>>4;if(!d)err(3);pos+=d&15;var dt=fd[dsym];if(dsym>3){var b=fdeb[dsym];dt+=bits16(dat,pos)&(1<<b)-1,pos+=b}if(pos>tbts){if(noSt)err(0);break}if(noBuf)cbuf(bt+131072);var end=bt+add;for(;bt<end;bt+=4){buf[bt]=buf[bt-dt];buf[bt+1]=buf[bt+1-dt];buf[bt+2]=buf[bt+2-dt];buf[bt+3]=buf[bt+3-dt]}bt=end}}st.l=lm,st.p=lpos,st.b=bt,st.f=_final4;if(lm)_final4=1,st.m=lbt,st.d=dm,st.n=dbt}while(!_final4);return bt==buf.length?buf:slc(buf,0,bt)};var et=/* @__PURE__ */new u8(0);var mrg=function mrg(a,b){var o={};for(var k in a){o[k]=a[k]}for(var k in b){o[k]=b[k]}return o};var wcln=function wcln(fn,fnStr,td2){var dt=fn();var st=fn.toString();var ks=st.slice(st.indexOf("[")+1,st.lastIndexOf("]")).replace(/\s+/g,"").split(",");for(var i=0;i<dt.length;++i){var v=dt[i],k=ks[i];if(typeof v=="function"){fnStr+=";"+k+"=";var st_1=v.toString();if(v.prototype){if(st_1.indexOf("[native code]")!=-1){var spInd=st_1.indexOf(" ",8)+1;fnStr+=st_1.slice(spInd,st_1.indexOf("(",spInd))}else{fnStr+=st_1;for(var t in v.prototype){fnStr+=";"+k+".prototype."+t+"="+v.prototype[t].toString()}}}else fnStr+=st_1}else td2[k]=v}return[fnStr,td2]};var ch=[];var cbfs=function cbfs(v){var tl=[];for(var k in v){if(v[k].buffer){tl.push((v[k]=new v[k].constructor(v[k])).buffer)}}return tl};var wrkr=function wrkr(fns,init,id,cb){var _a2;if(!ch[id]){var fnStr="",td_1={},m=fns.length-1;for(var i=0;i<m;++i){_a2=wcln(fns[i],fnStr,td_1),fnStr=_a2[0],td_1=_a2[1]}ch[id]=wcln(fns[m],fnStr,td_1)}var td2=mrg({},ch[id][1]);return wk(ch[id][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+init.toString()+"}",id,td2,cbfs(td2),cb)};var bInflt=function bInflt(){return[u8,u16,u32,fleb,fdeb,clim,fl,fd,flrm,fdrm,rev,ec,hMap,max,bits,bits16,shft,slc,err,inflt,inflateSync,pbf,gu8]};var pbf=function pbf(msg){return postMessage(msg,[msg.buffer])};var gu8=function gu8(o){return o&&o.size&&new u8(o.size)};var cbify=function cbify(dat,opts,fns,init,id,cb){var w=wrkr(fns,init,id,function(err2,dat2){w.terminate();cb(err2,dat2)});w.postMessage([dat,opts],opts.consume?[dat.buffer]:[]);return function(){w.terminate()}};var b2=function b2(d,b){return d[b]|d[b+1]<<8};var b4=function b4(d,b){return(d[b]|d[b+1]<<8|d[b+2]<<16|d[b+3]<<24)>>>0};var b8=function b8(d,b){return b4(d,b)+b4(d,b+4)*4294967296};function inflate(data,opts,cb){if(!cb)cb=opts,opts={};if(typeof cb!="function")err(7);return cbify(data,opts,[bInflt],function(ev){return pbf(inflateSync(ev.data[0],gu8(ev.data[1])))},1,cb)}function inflateSync(data,out){return inflt(data,out)}var td=typeof TextDecoder!="undefined"&&/* @__PURE__ */new TextDecoder;var tds=0;try{td.decode(et,{stream:true});tds=1}catch(e){}var dutf8=function dutf8(d){for(var r="",i=0;;){var c=d[i++];var eb=(c>127)+(c>223)+(c>239);if(i+eb>d.length)return[r,slc(d,i-1)];if(!eb)r+=String.fromCharCode(c);else if(eb==3){c=((c&15)<<18|(d[i++]&63)<<12|(d[i++]&63)<<6|d[i++]&63)-65536,r+=String.fromCharCode(55296|c>>10,56320|c&1023)}else if(eb&1)r+=String.fromCharCode((c&31)<<6|d[i++]&63);else r+=String.fromCharCode((c&15)<<12|(d[i++]&63)<<6|d[i++]&63)}};function strFromU8(dat,latin1){if(latin1){var r="";for(var i=0;i<dat.length;i+=16384){r+=String.fromCharCode.apply(null,dat.subarray(i,i+16384))}return r}else if(td)return td.decode(dat);else{var _a2=dutf8(dat),out=_a2[0],ext=_a2[1];if(ext.length)err(8);return out}}var slzh=function slzh(d,b){return b+30+b2(d,b+26)+b2(d,b+28)};var zh=function zh(d,b,z){var fnl=b2(d,b+28),fn=strFromU8(d.subarray(b+46,b+46+fnl),!(b2(d,b+8)&2048)),es=b+46+fnl,bs=b4(d,b+20);var _a2=z&&bs==4294967295?z64e(d,es):[bs,b4(d,b+24),b4(d,b+42)],sc=_a2[0],su=_a2[1],off=_a2[2];return[b2(d,b+10),sc,su,fn,es+b2(d,b+30)+b2(d,b+32),off]};var z64e=function z64e(d,b){for(;b2(d,b)!=1;b+=4+b2(d,b+2)){;}return[b8(d,b+12),b8(d,b+4),b8(d,b+20)]};var mt=typeof queueMicrotask=="function"?queueMicrotask:typeof setTimeout=="function"?setTimeout:function(fn){fn()};function unzip(data,opts,cb){if(!cb)cb=opts,opts={};if(typeof cb!="function")err(7);var term=[];var tAll=function tAll(){for(var i2=0;i2<term.length;++i2){term[i2]()}};var files={};var cbd=function cbd(a,b){mt(function(){cb(a,b)})};mt(function(){cbd=cb});var e=data.length-22;for(;b4(data,e)!=101010256;--e){if(!e||data.length-e>65558){cbd(err(13,0,1),null);return tAll}};var lft=b2(data,e+8);if(lft){var c=lft;var o=b4(data,e+16);var z=o==4294967295;if(z){e=b4(data,e-12);if(b4(data,e)!=101075792){cbd(err(13,0,1),null);return tAll}c=lft=b4(data,e+32);o=b4(data,e+48)}var fltr=opts&&opts.filter;var _loop_3=function _loop_3(i2){var _a2=zh(data,o,z),c_1=_a2[0],sc=_a2[1],su=_a2[2],fn=_a2[3],no=_a2[4],off=_a2[5],b=slzh(data,off);o=no;var cbl=function cbl(e2,d){if(e2){tAll();cbd(e2,null)}else{if(d)files[fn]=d;if(! --lft)cbd(null,files)}};if(!fltr||fltr({name:fn,size:sc,originalSize:su,compression:c_1})){if(!c_1)cbl(null,slc(data,b,b+sc));else if(c_1==8){var infl=data.subarray(b,b+sc);if(sc<32e4){try{cbl(null,inflateSync(infl,new u8(su)))}catch(e2){cbl(e2,null)}}else term.push(inflate(infl,{size:su},cbl))}else cbl(err(14,"unknown compression type "+c_1,1),null)}else cbl(null,null)};for(var i=0;i<c;++i){_loop_3(i)}}else cbd(null,{});return tAll}// zip.browser.js
var Zip=/*#__PURE__*/function(){function Zip(zip){_classCallCheck(this,Zip);this.zip=zip}_createClass(Zip,[{key:"getXML",value:function(){var _getXML=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(path){var handle;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:handle=this.zip[path];return _context.abrupt("return",handle&&strFromU8(handle));case 2:case"end":return _context.stop();}}},_callee,this)}));function getXML(_x){return _getXML.apply(this,arguments)}return getXML}()},{key:"close",value:function(){var _close=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:this.zip=null;case 1:case"end":return _context2.stop();}}},_callee2,this)}));function close(){return _close.apply(this,arguments)}return close}()}],[{key:"loadAsync",value:function(){var _loadAsync=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(xlsx){var zip;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return new Promise(function(resolve,reject){unzip(new Uint8Array(xlsx),function(err2,unzipped){err2?reject(err2):resolve(unzipped)})});case 2:zip=_context3.sent;return _context3.abrupt("return",new Zip(zip));case 4:case"end":return _context3.stop();}}},_callee3)}));function loadAsync(_x2){return _loadAsync.apply(this,arguments)}return loadAsync}()}]);return Zip}();function connect(xml,parser,status){var step=1e3;var i=0;while(i<xml.length){if(status.stop){break}var part=xml.slice(i,i+step);parser.write(part);i+=step}parser.close()}// xlsx2csv-builder.js
var import_saxes=__toESM(require_saxes(),1);var import_ssf=__toESM(require_ssf(),1);function xlsx2csvBuilder(Zip2,connect2){var ssf_table=import_ssf["default"].get_table();function parse_xml(xml,callback){return new Promise(function(resolve,reject){if(!xml)return resolve();var unresolved=true;var status={stop:false};var stop=function stop(){status.stop=true};var resolveonce=function resolveonce(){if(unresolved){unresolved=false;resolve()}};var parser=new import_saxes.SaxesParser;parser.on("end",resolveonce);parser.on("error",function(e){if(status.stop){return resolveonce()}reject(e)});var path=[];var text=void 0;parser.on("opentag",function(data){var name=data.name,attributes=data.attributes;path.unshift({name:name,attributes:attributes})});parser.on("text",function(data){text=data});parser.on("closetag",/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(data){var _data,name,attributes;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:path.shift();_data=data,name=_data.name,attributes=_data.attributes;data=text===void 0?{name:name,attributes:attributes}:{name:name,attributes:attributes,text:text};text=void 0;_context4.prev=4;_context4.next=7;return callback(name,data,[].concat(path),stop);case 7:_context4.next=12;break;case 9:_context4.prev=9;_context4.t0=_context4["catch"](4);console.error(_context4.t0);case 12:case"end":return _context4.stop();}}},_callee4,null,[[4,9]])}));return function(_x3){return _ref.apply(this,arguments)}}());connect2(xml,parser,status)})}function parse_workbook(_x4){return _parse_workbook.apply(this,arguments)}function _parse_workbook(){_parse_workbook=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6(xml){var sheets,activeTab;return _regeneratorRuntime().wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:sheets=[];activeTab=0;_context6.next=4;return parse_xml(xml,function(name,data,path){if(name==="sheet"){sheets.push(data.attributes)}else if(name==="workbookView"){if(data.attributes.activeTab){activeTab=Number(data.attributes.activeTab)}}});case 4:return _context6.abrupt("return",{sheets:sheets,activeTab:activeTab});case 5:case"end":return _context6.stop();}}},_callee6)}));return _parse_workbook.apply(this,arguments)}function parse_workbook_rels(_x5){return _parse_workbook_rels.apply(this,arguments)}function _parse_workbook_rels(){_parse_workbook_rels=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee7(xml){var rels;return _regeneratorRuntime().wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:rels={};_context7.next=3;return parse_xml(xml,function(name,data,path){if(name==="Relationship"){var _data$attributes=data.attributes,Id=_data$attributes.Id,Target=_data$attributes.Target;rels[Id]=Target}});case 3:return _context7.abrupt("return",rels);case 4:case"end":return _context7.stop();}}},_callee7)}));return _parse_workbook_rels.apply(this,arguments)}function parse_sharedStrings(_x6){return _parse_sharedStrings.apply(this,arguments)}function _parse_sharedStrings(){_parse_sharedStrings=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee8(xml){var texts,items;return _regeneratorRuntime().wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:texts=[];items=[];_context8.next=4;return parse_xml(xml,function(name,data,path){if(name==="si"){texts.push(items.join(""));items=[]}else if(name==="t"){items.push(data.text)}});case 4:return _context8.abrupt("return",texts);case 5:case"end":return _context8.stop();}}},_callee8)}));return _parse_sharedStrings.apply(this,arguments)}function parse_styles(_x7){return _parse_styles.apply(this,arguments)}function _parse_styles(){_parse_styles=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee9(xml){var formats,numberFormats;return _regeneratorRuntime().wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:formats=[];numberFormats={};_context9.next=4;return parse_xml(xml,function(name,data,path){if(name==="numFmt"&&path[0].name==="numFmts"){var _data$attributes2=data.attributes,numFmtId=_data$attributes2.numFmtId,formatCode=_data$attributes2.formatCode;numberFormats[numFmtId]=formatCode}else if(name==="xf"&&path[0].name==="cellXfs"){var _numFmtId=data.attributes.numFmtId;formats.push(Number(_numFmtId))}});case 4:formats=formats.map(function(numFmtId){return numberFormats[numFmtId]||ssf_table[numFmtId]||numFmtId});return _context9.abrupt("return",formats);case 6:case"end":return _context9.stop();}}},_callee9)}));return _parse_styles.apply(this,arguments)}function formatDate(value){var _import_ssf$default$p=import_ssf["default"].parse_date_code(value),y=_import_ssf$default$p.y,m=_import_ssf$default$p.m,d=_import_ssf$default$p.d,H=_import_ssf$default$p.H,M=_import_ssf$default$p.M,S=_import_ssf$default$p.S;var _map=[y,m,d,H,M,S].map(function(num){return String(num).padStart(2,"0")}),_map2=_slicedToArray(_map,6),YYYY=_map2[0],MM=_map2[1],DD=_map2[2],hh=_map2[3],mm=_map2[4],ss=_map2[5];return"".concat(YYYY,"-").concat(MM,"-").concat(DD," ").concat(hh,":").concat(mm,":").concat(ss)}function r2ci(r){var letters=r.replace(/[0-9]/g,"");return letters.split("").reduce(function(r2,a){return r2*26+parseInt(a,36)-9},0)-1}function parse_sheet(_x8,_x9,_x10,_x11){return _parse_sheet.apply(this,arguments)}function _parse_sheet(){_parse_sheet=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee10(xml,texts,formats,callback){var options,_options$max,max2,cells,i,count,_args10=arguments;return _regeneratorRuntime().wrap(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:options=_args10.length>4&&_args10[4]!==undefined?_args10[4]:{};_options$max=options.max,max2=_options$max===void 0?Infinity:_options$max;cells=[];i=0;count=0;_context10.next=7;return parse_xml(xml,function(name,data,path,stop){if(name==="row"||name==="x:row"){if(cells.length>0&&!cells.every(function(cell){return cell===""||cell===void 0})){if(count>max2){stop()}else{callback(cells);count++}}i=0;cells=[]}else if(name==="v"||name==="x:v"){var c=path[0];var t=c.attributes.t;var r=c.attributes.r;var ci=r?r2ci(r):i;var formatId=c.attributes.s;var text=data.text||"";text=text.trim();if(text.length>0){if(t==="s"){text=texts[text]}else if(t==="b"){text=text==="0"?"FALSE":"TRUE"}else if(t==="e"){text=""}else if(formatId){var value=parseFloat(text);if(!isNaN(value)){var numFormat=formats[formatId];if(typeof numFormat==="string"){var isDate=import_ssf["default"].is_date(numFormat);if(isDate){text=/[yd]/.test(numFormat)?formatDate(value):import_ssf["default"].format(numFormat,value)}else{text=value}}else if(numFormat){text=import_ssf["default"].format(numFormat,value)}else{text=value}}}}if(r===void 0&&text==="")return;cells[ci]=text;i++}else if(name==="t"||name==="x:t"){var _c2=path[1];var _t=_c2.attributes.t;var _r=_c2.attributes.r;var _ci=_r?r2ci(_r):i;if(_t==="inlineStr"){cells[_ci]=data.text;i++}}});case 7:case"end":return _context10.stop();}}},_callee10)}));return _parse_sheet.apply(this,arguments)}return/*#__PURE__*/function(){var _xlsx2csv=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(xlsx){var callback,options,zip,workbook_xml,_yield$parse_workbook,sheets,activeTab,sharedStrings_xml,texts,styles_xml,styles,rels_xml,rels,sheet1_path,sheet1_xml,_args5=arguments;return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:callback=_args5.length>1&&_args5[1]!==undefined?_args5[1]:console.log;options=_args5.length>2&&_args5[2]!==undefined?_args5[2]:{};_context5.next=4;return Zip2.loadAsync(xlsx);case 4:zip=_context5.sent;_context5.next=7;return zip.getXML("xl/workbook.xml");case 7:workbook_xml=_context5.sent;_context5.next=10;return parse_workbook(workbook_xml);case 10:_yield$parse_workbook=_context5.sent;sheets=_yield$parse_workbook.sheets;activeTab=_yield$parse_workbook.activeTab;_context5.next=15;return zip.getXML("xl/sharedStrings.xml");case 15:sharedStrings_xml=_context5.sent;_context5.next=18;return parse_sharedStrings(sharedStrings_xml);case 18:texts=_context5.sent;_context5.next=21;return zip.getXML("xl/styles.xml");case 21:styles_xml=_context5.sent;_context5.next=24;return parse_styles(styles_xml);case 24:styles=_context5.sent;_context5.next=27;return zip.getXML("xl/_rels/workbook.xml.rels");case 27:rels_xml=_context5.sent;_context5.next=30;return parse_workbook_rels(rels_xml);case 30:rels=_context5.sent;sheet1_path=sheets.length>activeTab?"xl/".concat(rels[sheets[activeTab]["r:id"]].replace(/^\/xl\//,"")):"xl/worksheets/sheet1.xml";_context5.next=34;return zip.getXML(sheet1_path);case 34:sheet1_xml=_context5.sent;_context5.next=37;return parse_sheet(sheet1_xml,texts,styles,callback,options.sheet);case 37:_context5.next=39;return zip.close();case 39:case"end":return _context5.stop();}}},_callee5)}));function xlsx2csv(_x12){return _xlsx2csv.apply(this,arguments)}return xlsx2csv}()}// index.browser.js
var index_browser_default=xlsx2csvBuilder(Zip,connect);return __toCommonJS(index_browser_exports)}();/**
 * Character class utilities for XML NS 1.0 edition 3.
 *
 * @author Louis-Dominique Dubeau
 * @license MIT
 * @copyright Louis-Dominique Dubeau
 */ /**
 * Character classes and associated utilities for the 2nd edition of XML 1.1.
 *
 * @author Louis-Dominique Dubeau
 * @license MIT
 * @copyright Louis-Dominique Dubeau
 */ /**
 * Character classes and associated utilities for the 5th edition of XML 1.0.
 *
 * @author Louis-Dominique Dubeau
 * @license MIT
 * @copyright Louis-Dominique Dubeau
 */xlsx2csv=xlsx2csv["default"];
